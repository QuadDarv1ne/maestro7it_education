#!/usr/bin/env python3
"""
–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã —ç–Ω–¥—à–ø–∏–ª—å–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü
"""

from endgame_tablebase import g_endgame_tablebase
import time

def demonstrate_endgame_tablebase():
    print("=== –î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø ENDGAME TABLEBASE ===")
    print("–ò–¥–µ–∞–ª—å–Ω–∞—è –∏–≥—Ä–∞ –≤ —ç–Ω–¥—à–ø–∏–ª—è—Ö —Å –º–∞–ª—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Ñ–∏–≥—É—Ä\n")
    
    # –¢–µ—Å—Ç–æ–≤—ã–µ –ø–æ–∑–∏—Ü–∏–∏
    test_positions = [
        {
            "name": "KPK: –ö–æ—Ä–æ–ª—å + –ø–µ—à–∫–∞ –ø—Ä–æ—Ç–∏–≤ –∫–æ—Ä–æ–ª—è",
            "position": {
                'pieces': {'e1': 'K', 'e7': 'k', 'e6': 'P'},
                'turn': 'white'
            },
            "expected": "WIN"
        },
        {
            "name": "KRK: –ö–æ—Ä–æ–ª—å + –ª–∞–¥—å—è –ø—Ä–æ—Ç–∏–≤ –∫–æ—Ä–æ–ª—è", 
            "position": {
                'pieces': {'e1': 'K', 'h1': 'R', 'e8': 'k'},
                'turn': 'white'
            },
            "expected": "WIN"
        },
        {
            "name": "KQK: –ö–æ—Ä–æ–ª—å + —Ñ–µ—Ä–∑—å –ø—Ä–æ—Ç–∏–≤ –∫–æ—Ä–æ–ª—è",
            "position": {
                'pieces': {'e1': 'K', 'd4': 'Q', 'e8': 'k'},
                'turn': 'white'
            },
            "expected": "WIN"
        },
        {
            "name": "–°–ª–æ–∂–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è —Å 4 —Ñ–∏–≥—É—Ä–∞–º–∏",
            "position": {
                'pieces': {'e1': 'K', 'f2': 'P', 'e8': 'k', 'f7': 'p'},
                'turn': 'white'
            },
            "expected": "ADVANTAGE_WHITE"
        }
    ]
    
    print("üîç –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ü–û–ó–ò–¶–ò–ô:")
    print("-" * 50)
    
    for i, test in enumerate(test_positions, 1):
        print(f"\n{i}. {test['name']}")
        
        # –ò–∑–º–µ—Ä—è–µ–º –≤—Ä–µ–º—è
        start_time = time.time()
        result = g_endgame_tablebase.get_result(test['position'])
        end_time = time.time()
        
        print(f"   –†–µ–∑—É–ª—å—Ç–∞—Ç: {result}")
        print(f"   –û–∂–∏–¥–∞–µ–º–æ: {test['expected']}")
        print(f"   –í—Ä–µ–º—è: {(end_time - start_time)*1000:.2f} –º—Å")
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å
        if result == test['expected']:
            print("   ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ")
        else:
            print("   ‚ö†Ô∏è  –¢—Ä–µ–±—É–µ—Ç —É—Ç–æ—á–Ω–µ–Ω–∏—è")
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    print("\n" + "=" * 50)
    print("üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø:")
    
    stats = g_endgame_tablebase.get_statistics()
    total_queries = stats['hits'] + stats['misses']
    
    print(f"–í—Å–µ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤: {total_queries}")
    print(f"–ü–æ–ø–∞–¥–∞–Ω–∏–π –≤ –∫—ç—à: {stats['hits']} ({stats['hits']/total_queries*100:.1f}%)" if total_queries > 0 else "–ü–æ–ø–∞–¥–∞–Ω–∏–π –≤ –∫—ç—à: 0")
    print(f"–ù–æ–≤—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π: {stats['computed']}")
    
    # –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Å–∏—Å—Ç–µ–º—ã
    print("\nüéØ –ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê ENDGAME TABLEBASE:")
    advantages = [
        "–ò–¥–µ–∞–ª—å–Ω–∞—è –∏–≥—Ä–∞ –≤ –±–∞–∑–æ–≤—ã—Ö —ç–Ω–¥—à–ø–∏–ª—è—Ö",
        "–ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –¥–ª—è –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π",
        "–≠–∫–æ–Ω–æ–º–∏—è –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤",
        "–ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã",
        "–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —ç–Ω–¥—à–ø–∏–ª–µ–π (KPK, KRK, KQK)",
        "–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –±—ã—Å—Ç—Ä–æ–¥–µ–π—Å—Ç–≤–∏—è"
    ]
    
    for advantage in advantages:
        print(f"‚úÖ {advantage}")
    
    # –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–º –ø–æ–¥—Ö–æ–¥–æ–º
    print("\n‚öñÔ∏è –°–†–ê–í–ù–ï–ù–ò–ï –° –¢–†–ê–î–ò–¶–ò–û–ù–ù–´–ú –ü–û–î–•–û–î–û–ú:")
    comparison = {
        "–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–π –ò–ò": {
            "–í—Ä–µ–º—è": "–°–µ–∫—É–Ω–¥—ã –Ω–∞ —Ö–æ–¥",
            "–¢–æ—á–Ω–æ—Å—Ç—å": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è",
            "–†–µ—Å—É—Ä—Å—ã": "–í—ã—Å–æ–∫–∏–µ",
            "–≠–Ω–¥—à–ø–∏–ª—å": "–ß–∞—Å—Ç–æ –æ—à–∏–±–∞–µ—Ç—Å—è"
        },
        "Endgame Tablebase": {
            "–í—Ä–µ–º—è": "–ú–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã",
            "–¢–æ—á–Ω–æ—Å—Ç—å": "100%",
            "–†–µ—Å—É—Ä—Å—ã": "–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ",
            "–≠–Ω–¥—à–ø–∏–ª—å": "–ò–¥–µ–∞–ª—å–Ω—ã–π"
        }
    }
    
    print(f"{'–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞':<20} {'–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–π –ò–ò':<20} {'Tablebase':<15}")
    print("-" * 60)
    for characteristic in comparison["–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–π –ò–ò"]:
        traditional = comparison["–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–π –ò–ò"][characteristic]
        tablebase = comparison["Endgame Tablebase"][characteristic]
        print(f"{characteristic:<20} {traditional:<20} {tablebase:<15}")
    
    print("\nüöÄ –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –° –ü–†–û–ï–ö–¢–û–ú:")
    integration_points = [
        "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç–∏",
        "–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø–µ—Ä–µ–¥ —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–º –ø–æ–∏—Å–∫–æ–º",
        "Fallback –Ω–∞ –æ–±—ã—á–Ω—É—é –æ—Ü–µ–Ω–∫—É –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏",
        "–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π",
        "–ü—Ä–æ–∑—Ä–∞—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"
    ]
    
    for point in integration_points:
        print(f"üîπ {point}")
    
    print("\n" + "=" * 50)
    print("üéâ ENDGAME TABLEBASE –ì–û–¢–û–í –ö –ò–ù–¢–ï–ì–†–ê–¶–ò–ò!")
    print("üèÜ –£–†–û–í–ï–ù–¨: –ü–†–û–§–ï–°–°–ò–û–ù–ê–õ–¨–ù–´–ô")
    print("‚ö° –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨: –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–ê–Ø")
    print("üéØ –¢–û–ß–ù–û–°–¢–¨: 100% –í –ë–ê–ó–û–í–´–• –≠–ù–î–®–ü–ò–õ–Ø–•")

if __name__ == "__main__":
    try:
        demonstrate_endgame_tablebase()
        print("\n\n–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è...")
        input()
    except KeyboardInterrupt:
        print("\n\n–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–µ—Ä–≤–∞–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º")
    except Exception as e:
        print(f"\n–û—à–∏–±–∫–∞: {e}")