# 1️⃣0️⃣ Обработка исключений и работа с ошибками

**Обработка исключений** — это механизм, позволяющий управлять ошибками и исключительными ситуациями в программе, обеспечивая её стабильность и предотвращая сбои.

В C++ исключения обрабатываются с помощью конструкций `try`, `catch`, и `throw`.

### 1. Исключения в C++

**Исключение** — это объект, представляющий ошибочную или необычную ситуацию, возникающую во время выполнения программы.

**Основные конструкции**

- `try`: блок кода, в котором могут возникнуть исключения.
- `catch`: блок кода, который перехватывает и обрабатывает исключения, выброшенные из блока `try`.
- `throw`: оператор для генерации исключения.

```
#include <iostream>

void divide(int a, int b) {
    if (b == 0) {
        throw std::runtime_error("Деление на ноль!");
    }
    std::cout << "Результат: " << a / b << std::endl;
}

int main() {
    try {
        divide(10, 2); // Нормальная работа
        divide(10, 0); // Генерация исключения
    } catch (const std::exception &e) {
        std::cout << "Ошибка: " << e.what() << std::endl;
    }

    return 0;
}
```

### 2. Создание и выбрасывание исключений

Исключения могут быть объектами любых типов, но обычно это объекты классов, наследующих `std::exception`.

**Пример пользовательского исключения**

**Определение пользовательского исключения:**
```
#include <iostream>
#include <exception>

class MyException : public std::exception {
public:
    const char* what() const noexcept override {
        return "Моё исключение";
    }
};

void mightGoWrong() {
    throw MyException();
}

int main() {
    try {
        mightGoWrong();
    } catch (const MyException &e) {
        std::cout << "Поймано: " << e.what() << std::endl;
    }

    return 0;
}
```

### 3. Множественные блоки catch

Один блок `try` может иметь несколько блоков `catch`, каждый из которых перехватывает разные типы исключений.

```
#include <iostream>

void test() {
    throw 20;
}

int main() {
    try {
        test();
    } catch (int e) {
        std::cout << "Поймано целое число: " << e << std::endl;
    } catch (const std::exception &e) {
        std::cout << "Поймано стандартное исключение: " << e.what() << std::endl;
    }

    return 0;
}
```

### 4. Спецификаторы исключений

Функции могут объявлять, какие исключения они могут выбрасывать, используя спецификаторы исключений.

**Использование спецификаторов исключений**

```
#include <iostream>

void mayThrow() noexcept {
    // Эта функция не выбрасывает исключений
}

void mayThrowBad() {
    throw std::runtime_error("Ошибка");
}

int main() {
    try {
        mayThrowBad();
    } catch (const std::runtime_error &e) {
        std::cout << "Поймано исключение: " << e.what() << std::endl;
    }

    return 0;
}
```

### 5. Синтаксические особенности

- `noexcept`: спецификатор, указывающий, что функция не выбрасывает исключений.
- `std::exception`: базовый класс для всех стандартных исключений, предоставляющий метод `what()` для получения сообщения об ошибке.

```
#include <iostream>
#include <exception>

void foo() noexcept {
    // Эта функция не выбрасывает исключений
}

void bar() {
    throw std::runtime_error("Произошла ошибка");
}

int main() {
    try {
        foo(); // Нормальная работа
        bar(); // Генерация исключения
    } catch (const std::exception &e) {
        std::cout << "Ошибка: " << e.what() << std::endl;
    }

    return 0;
}
```

### 6. Чистота и безопасность исключений

**Важно помнить о следующих моментах при работе с исключениями:**

- Используйте спецификаторы noexcept только если вы уверены, что функция действительно не выбрасывает исключений.
- Обрабатывайте исключения так, чтобы программа могла продолжить выполнение или корректно завершиться.
- Понимание семантики исключений помогает избежать утечек ресурсов и улучшить стабильность программы.

### Заключение

Обработка исключений в C++ позволяет эффективно управлять ошибками и необычными ситуациями, сохраняя корректность и стабильность программы.

Используйте блоки try, catch, и throw для генерации и обработки исключений, и помните о принципах создания безопасного кода с обработкой исключений.



**Автор:** Дуплей Максим Игоревич

**Дата:** 07.09.2024

**Версия 1.0**