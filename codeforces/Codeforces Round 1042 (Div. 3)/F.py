'''
https://codeforces.com/contest/2131/problem/F
'''

import sys
import bisect

input = sys.stdin.readline

"""
–ó–∞–¥–∞—á–∞ F. –ù–µ—Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–∞—è –±–∏–Ω–∞—Ä–Ω–∞—è –∂–∏–∑–Ω—å

–í–∞–º –¥–∞–Ω—ã –¥–≤–µ –±–∏–Ω–∞—Ä–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ a –∏ b –¥–ª–∏–Ω—ã n. –û–Ω–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç —Å–µ—Ç–∫—É —Ä–∞–∑–º–µ—Ä–æ–º n √ó n. –ü—É—Å—Ç—å (i, j) ‚Äî —ç—Ç–æ —è—á–µ–π–∫–∞ –≤ i-–π —Å—Ç—Ä–æ–∫–µ –∏ j-–º —Å—Ç–æ–ª–±—Ü–µ. –ù–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —è—á–µ–π–∫–∏ (i, j) —Ä–∞–≤–Ω–æ a_i ‚äï b_j, –≥–¥–µ ‚äï ‚Äî —ç—Ç–æ –ø–æ–±–∏—Ç–æ–≤–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è XOR.

–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –Æ—Ä–∏—è –≤—Å–µ–≥–¥–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å —è—á–µ–π–∫–∏ (1, 1). –ò–∑ —è—á–µ–π–∫–∏ (i, j) –æ–Ω–∞ –º–æ–∂–µ—Ç –¥–≤–∏–≥–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –≤–Ω–∏–∑ –≤ (i + 1, j) –∏–ª–∏ –≤–ø—Ä–∞–≤–æ –≤ (i, j + 1). –ï—ë –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ, –µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –¥–æ–ø—É—Å—Ç–∏–º—ã–π –ø—É—Ç—å, —Ç–∞–∫–æ–π —á—Ç–æ –≤—Å–µ —è—á–µ–π–∫–∏ –Ω–∞ –ø—É—Ç–∏, –≤–∫–ª—é—á–∞—è (1, 1), –∏–º–µ—é—Ç –∑–Ω–∞—á–µ–Ω–∏–µ 0.

–î–æ –Ω–∞—á–∞–ª–∞ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –æ–Ω–∞ –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª—é–±–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–∑:

    –í—ã–±—Ä–∞—Ç—å –∏–Ω–¥–µ–∫—Å 1 ‚â§ i ‚â§ n –∏ –∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –ª–∏–±–æ a_i, –ª–∏–±–æ b_i (0 —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è 1, –∞ 1 —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è 0). –°–µ—Ç–∫–∞ —Ç–∞–∫–∂–µ –∏–∑–º–µ–Ω–∏—Ç—Å—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ.

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å—É–º–º—É –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–µ–±—É—é—Ç—Å—è –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –Æ—Ä–∏–π –º–æ–≥–ª–∞ –¥–æ–±—Ä–∞—Ç—å—Å—è –¥–æ –∫–∞–∂–¥–æ–π —è—á–µ–π–∫–∏ (x, y) –¥–ª—è –≤—Å–µ—Ö 1 ‚â§ x, y ‚â§ n.

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- t ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ—Å—Ç–æ–≤.
–î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Å—Ç–∞:
- n ‚Äî –¥–ª–∏–Ω–∞ —Å—Ç—Ä–æ–∫.
- a, b ‚Äî –±–∏–Ω–∞—Ä–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –¥–ª–∏–Ω—ã n.

–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
–î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Å—Ç–∞ –≤—ã–≤–µ–¥–∏—Ç–µ –æ–¥–Ω–æ —á–∏—Å–ª–æ ‚Äî –∏—Å–∫–æ–º—É—é —Å—É–º–º—É.

–ü—Ä–∏–º–µ—Ä:

–í—Ö–æ–¥:
3
2
11
00
2
01
01
4
1010
1101

–í—ã—Ö–æ–¥:
5
4
24
"""

t = int(input())

for _ in range(t):
    n = int(input())
    a = input().strip()
    b = input().strip()

    prefix_a_ones = [0] * (n + 1)
    prefix_b_ones = [0] * (n + 1)

    for i in range(1, n + 1):
        prefix_a_ones[i] = prefix_a_ones[i - 1] + (a[i - 1] == '1')
        prefix_b_ones[i] = prefix_b_ones[i - 1] + (b[i - 1] == '1')

    f = [0] * n
    for i in range(n):
        f[i] = 2 * prefix_b_ones[i + 1] - (i + 1)
    g = [-x for x in f]
    g.sort()

    prefix_g = [0]
    for x in g:
        prefix_g.append(prefix_g[-1] + x)

    S = 0
    for y in range(1, n + 1):
        S += y - prefix_b_ones[y]

    res = 0
    for x in range(1, n + 1):
        A0_x = x - prefix_a_ones[x]
        D_x = 2 * prefix_a_ones[x] - x
        pos = bisect.bisect_right(g, D_x)
        k = n - pos
        sum_g = prefix_g[-1] - prefix_g[pos]
        sum_min = -(sum_g - D_x * k)
        res += n * A0_x + S + sum_min

    print(res)

''' –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏: '''
# 1. üí†Telegramüí†‚ùÉ –•–∏–∂–∏–Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–∞ √Ü: https://t.me/hut_programmer_07
# 2. üí†Telegram ‚Ññ1üí† @quadd4rv1n7
# 3. üí†Telegram ‚Ññ2üí† @dupley_maxim_1999
# 4. Rutube –∫–∞–Ω–∞–ª: https://rutube.ru/channel/4218729/
# 5. Plvideo –∫–∞–Ω–∞–ª: https://plvideo.ru/channel/AUPv_p1r5AQJ
# 6. YouTube –∫–∞–Ω–∞–ª: https://www.youtube.com/@it-coders
# 7. –í–ö –≥—Ä—É–ø–ø–∞: https://vk.com/science_geeks