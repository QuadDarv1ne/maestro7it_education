'''
https://leetcode.com/problems/text-justification/description/?envType=study-plan-v2&envId=top-interview-150
'''

class Solution:
    def fullJustify(self, words, maxWidth):
        """
        –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤ –≤ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤—ã—Ä–æ–≤–Ω–µ–Ω–Ω—ã–π –ø–æ —à–∏—Ä–∏–Ω–µ —Ç–µ–∫—Å—Ç.

        –ó–∞–¥–∞—á–∞:
        - –°–æ—Å—Ç–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫–∏ –¥–ª–∏–Ω–æ–π —Ä–æ–≤–Ω–æ maxWidth —Å–∏–º–≤–æ–ª–æ–≤.
        - –†–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–æ–±–µ–ª—ã –º–µ–∂–¥—É —Å–ª–æ–≤–∞–º–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ.
        - –ï—Å–ª–∏ –ø—Ä–æ–±–µ–ª—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –Ω–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ, –±–æ–ª–µ–µ "—à–∏—Ä–æ–∫–∏–µ" –ø—Ä–æ–±–µ–ª—ã
          –¥–æ–ª–∂–Ω—ã –∏–¥—Ç–∏ –≤ –Ω–∞—á–∞–ª–µ —Å—Ç—Ä–æ–∫–∏.
        - –ü–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç—Ä–æ–∫–∞ –≤—Å–µ–≥–¥–∞ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç—Å—è –ø–æ –ª–µ–≤–æ–º—É –∫—Ä–∞—é (—Å–ª–æ–≤–∞ —á–µ—Ä–µ–∑ –æ–¥–∏–Ω –ø—Ä–æ–±–µ–ª, –æ—Å—Ç–∞—Ç–æ–∫ –ø—Ä–æ–±–µ–ª–∞–º–∏ —Å–ø—Ä–∞–≤–∞).

        –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
        ----------
        words : List[str]
            –°–ø–∏—Å–æ–∫ —Å–ª–æ–≤ (–¥–ª–∏–Ω–∞ –∫–∞–∂–¥–æ–≥–æ > 0 –∏ ‚â§ maxWidth).
        maxWidth : int
            –ñ–µ–ª–∞–µ–º–∞—è –¥–ª–∏–Ω–∞ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏.

        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
        -----------
        List[str]
            –°–ø–∏—Å–æ–∫ —Å—Ç—Ä–æ–∫, –∫–∞–∂–¥–∞—è —Ä–æ–≤–Ω–æ maxWidth —Å–∏–º–≤–æ–ª–æ–≤, —Å –ø–æ–ª–Ω—ã–º –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ–º.

        –ê–ª–≥–æ—Ä–∏—Ç–º:
        1. –° –ø–æ–º–æ—â—å—é –∂–∞–¥–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ –Ω–∞–±–∏—Ä–∞–µ–º —Å–ª–æ–≤–∞ –≤ —Ç–µ–∫—É—â—É—é —Å—Ç—Ä–æ–∫—É,
           –ø–æ–∫–∞ –æ–Ω–∏ –ø–æ–º–µ—â–∞—é—Ç—Å—è –ø–æ –¥–ª–∏–Ω–µ (—É—á–∏—Ç—ã–≤–∞—è –ø—Ä–æ–±–µ–ª—ã –º–µ–∂–¥—É –Ω–∏–º–∏).
        2. –ö–æ–≥–¥–∞ —Å—Ç—Ä–æ–∫–∞ "–∑–∞–ø–æ–ª–Ω–µ–Ω–∞", —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ–º –ø—Ä–æ–±–µ–ª—ã:
            - –µ—Å–ª–∏ —Å—Ç—Ä–æ–∫–∞ –ø–æ—Å–ª–µ–¥–Ω—è—è –∏–ª–∏ –≤ –Ω–µ–π –æ–¥–Ω–æ —Å–ª–æ–≤–æ ‚Äî –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –≤–ª–µ–≤–æ;
            - –∏–Ω–∞—á–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ–º –ø—Ä–æ–±–µ–ª—ã —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ, –æ—Å—Ç–∞—Ç–æ–∫ –≤ –Ω–∞—á–∞–ª–µ.
        3. –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º, –ø–æ–∫–∞ –Ω–µ –æ–±—Ä–∞–±–æ—Ç–∞–µ–º –≤—Å–µ —Å–ª–æ–≤–∞.

        –°–ª–æ–∂–Ω–æ—Å—Ç—å:
        ----------
        O(N) –ø–æ –≤—Ä–µ–º–µ–Ω–∏, –≥–¥–µ N ‚Äî –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º–≤–æ–ª–æ–≤ –≤–æ –≤—Ö–æ–¥–Ω—ã—Ö —Å–ª–æ–≤–∞—Ö.
        O(1) –ø–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏ (–Ω–µ —Å—á–∏—Ç–∞—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞).
        """
        res = []
        i = 0
        n = len(words)

        while i < n:
            length = len(words[i])
            j = i + 1
            # –ü–æ–¥–±–∏—Ä–∞–µ–º —Å–ª–æ–≤–∞, –∫–æ—Ç–æ—Ä—ã–µ –≤–æ–π–¥—É—Ç –≤ —Å—Ç—Ä–æ–∫—É
            while j < n and length + 1 + len(words[j]) <= maxWidth:
                length += 1 + len(words[j])
                j += 1

            line = ""
            numWords = j - i

            # –ü–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç—Ä–æ–∫–∞ –∏–ª–∏ –æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ ‚Äî –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –≤–ª–µ–≤–æ
            if j == n or numWords == 1:
                line = " ".join(words[i:j])
                line += " " * (maxWidth - len(line))
            else:
                totalSpaces = maxWidth - sum(len(word) for word in words[i:j])
                spaceBetween = totalSpaces // (numWords - 1)
                extraSpaces = totalSpaces % (numWords - 1)

                for k in range(numWords - 1):
                    line += words[i + k]
                    line += " " * (spaceBetween + (1 if k < extraSpaces else 0))
                line += words[j - 1]

            res.append(line)
            i = j

        return res

''' –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏: '''
# 1. üí†Telegramüí†‚ùÉ –•–∏–∂–∏–Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–∞ √Ü: https://t.me/hut_programmer_07
# 2. üí†Telegram ‚Ññ1üí† @quadd4rv1n7
# 3. üí†Telegram ‚Ññ2üí† @dupley_maxim_1999
# 4. Rutube –∫–∞–Ω–∞–ª: https://rutube.ru/channel/4218729/
# 5. Plvideo –∫–∞–Ω–∞–ª: https://plvideo.ru/channel/AUPv_p1r5AQJ
# 6. YouTube –∫–∞–Ω–∞–ª: https://www.youtube.com/@it-coders
# 7. –í–ö –≥—Ä—É–ø–ø–∞: https://vk.com/science_geeks