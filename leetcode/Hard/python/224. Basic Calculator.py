"""
Автор: Дуплей Максим Игоревич - AGLA
ORCID: https://orcid.org/0009-0007-7605-539X
GitHub: https://github.com/QuadDarv1ne/

Полезные ссылки:
1. Telegram ❃ Хижина программиста Æ: https://t.me/hut_programmer_07
2. Telegram №1 @quadd4rv1n7
3. Telegram №2 @dupley_maxim_1999
4. Rutube канал: https://rutube.ru/channel/4218729/
5. Plvideo канал: https://plvideo.ru/channel/AUPv_p1r5AQJ
6. YouTube канал: https://www.youtube.com/@it-coders
7. ВК группа: https://vk.com/science_geeks
"""

class Solution:
    def calculate(self, s):
        """
        Вычисляет значение арифметического выражения.
        
        Алгоритм:
        - Используем стек для хранения знаков операций при вложенных скобках.
        - Проходим по строке, обрабатывая символы:
            * Цифры: собираем полное число и добавляем к результату с текущим знаком.
            * '+': обновляем текущий знак на знак из вершины стека.
            * '-': обновляем текущий знак на противоположный знаку из вершины стека.
            * '(': сохраняем текущий знак в стек.
            * ')': извлекаем знак из стека.
            * Пробелы: пропускаем.
        
        Сложность:
        Время: O(n), где n - длина строки
        Пространство: O(n) для стека в худшем случае
        
        Параметры:
        ----------
        s : str
            Строка с арифметическим выражением
            
        Возвращает:
        -----------
        int
            Результат вычисления выражения
            
        Примеры:
        --------
        calculate("1 + 1") → 2
        calculate(" 2-1 + 2 ") → 3
        calculate("(1+(4+5+2)-3)+(6+8)") → 23
        """
        stack = [1]  # Инициализируем стек со знаком '+'
        sign = 1  # Текущий знак
        result = 0
        i = 0
        n = len(s)
        
        while i < n:
            ch = s[i]
            if ch.isdigit():
                # Считываем все цифры числа
                num = 0
                while i < n and s[i].isdigit():
                    num = num * 10 + int(s[i])
                    i += 1
                # Добавляем число с текущим знаком
                result += sign * num
                continue  # Уже увеличили i, пропускаем инкремент в конце
            elif ch == '+':
                sign = stack[-1]
            elif ch == '-':
                sign = -stack[-1]
            elif ch == '(':
                # Сохраняем текущий знак в стек
                stack.append(sign)
            elif ch == ')':
                # Извлекаем знак из стека
                stack.pop()
            # Пробелы пропускаем
            i += 1
        
        return result