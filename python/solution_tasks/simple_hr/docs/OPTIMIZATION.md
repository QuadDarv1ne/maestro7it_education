# üöÄ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ Simple HR v2.2

## üìã –û–±–∑–æ—Ä –Ω–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º

–í–µ—Ä—Å–∏—è 2.2 –≤–∫–ª—é—á–∞–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é —Å–∏—Å—Ç–µ–º—É –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

---

## üîß –ù–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. **–°–∏—Å—Ç–µ–º–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ –∑–∞–¥–∞—á** (`app/utils/scheduler.py`)

–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º APScheduler.

#### –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏:

| –ó–∞–¥–∞—á–∞ | –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|-----------|----------|
| `cleanup_old_logs` | 02:00 –µ–∂–µ–¥–Ω–µ–≤–Ω–æ | –£–¥–∞–ª–µ–Ω–∏–µ –ª–æ–≥–æ–≤ –∞—É–¥–∏—Ç–∞ —Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π |
| `cleanup_old_notifications` | 03:00 –µ–∂–µ–¥–Ω–µ–≤–Ω–æ | –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —Å—Ç–∞—Ä—à–µ 90 –¥–Ω–µ–π |
| `auto_backup` | 01:00 –µ–∂–µ–¥–Ω–µ–≤–Ω–æ | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ë–î |
| `check_vacation_expiry` | 09:00 –µ–∂–µ–¥–Ω–µ–≤–Ω–æ | –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–µ–∫–∞—é—â–∏—Ö –æ—Ç–ø—É—Å–∫–æ–≤ |
| `cleanup_temp_files` | 04:00 –µ–∂–µ–¥–Ω–µ–≤–Ω–æ | –û—á–∏—Å—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ |
| `update_employee_statistics` | –ö–∞–∂–¥—ã–π —á–∞—Å | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ |
| `health_check` | –ö–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã |

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:

```python
from app.utils.scheduler import init_scheduler, run_job_now, pause_job

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ __init__.py)
scheduler = init_scheduler(app)

# –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –∑–∞–¥–∞—á–∏
run_job_now('auto_backup')

# –ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏
pause_job('cleanup_logs')

# –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∑–∞–¥–∞—á
jobs = get_scheduled_jobs()
```

---

### 2. **Redis –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** (`app/utils/redis_cache.py`)

–°–∏—Å—Ç–µ–º–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º fallback –Ω–∞ –ø–∞–º—è—Ç—å –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ Redis.

#### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ MemoryCache –µ—Å–ª–∏ Redis –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
- ‚úÖ –î–µ–∫–æ—Ä–∞—Ç–æ—Ä `@cached` –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π
- ‚úÖ –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∫—ç—à–∞ –ø–æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫—ç—à–∞

#### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

```python
from app.utils.redis_cache import cache, cached, invalidate_cache

# –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
@cached(timeout=600, key_prefix='employees')
def get_all_employees():
    return Employee.query.all()

# –†—É—á–Ω–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
cache.set('user:123', user_data, timeout=300)
user = cache.get('user:123')

# –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∫—ç—à–∞
invalidate_cache('view:employees:*')

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
stats = cache.get_stats()
```

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Redis:

–í `instance/config.py`:
```python
REDIS_URL = 'redis://localhost:6379/0'
```

–£—Å—Ç–∞–Ω–æ–≤–∫–∞ Redis (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
```bash
pip install redis hiredis
```

---

### 3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** (`app/utils/performance_monitoring.py`)

–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤—Å–µ—Ö HTTP –∑–∞–ø—Ä–æ—Å–æ–≤.

#### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

- üìä –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±–æ—Ä –º–µ—Ç—Ä–∏–∫ –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
- ‚è±Ô∏è –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (> 1 —Å–µ–∫)
- üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º
- üîç –ò—Å—Ç–æ—Ä–∏—è –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 1000 –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚ö†Ô∏è –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—à–∏–±–æ–∫

#### –î–æ—Å—Ç—É–ø–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏:

```python
from app.utils.performance_monitoring import performance_monitor

# –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
stats = performance_monitor.get_stats()
# {
#     'total_requests': 1523,
#     'error_count': 12,
#     'error_rate': 0.79,
#     'average_time': 45.32,
#     'min_time': 2.15,
#     'max_time': 1234.56,
#     'slow_queries_count': 5
# }

# –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
slow = performance_monitor.get_slow_queries(limit=20)

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º
endpoints = performance_monitor.get_endpoint_stats()

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–ø—Ä–æ—Å—ã
recent = performance_monitor.get_recent_requests(limit=50)
```

#### –î–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π:

```python
from app.utils.performance_monitoring import measure_time, slow_query_threshold

@measure_time()
def complex_calculation():
    # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ª–æ–≥–∏—Ä—É–µ—Ç –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –µ—Å–ª–∏ > 100ms
    pass

@slow_query_threshold(threshold_seconds=2.0)
def database_operation():
    # –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞–µ—Ç –µ—Å–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏—è –∑–∞–Ω—è–ª–∞ > 2 —Å–µ–∫
    pass
```

#### –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:

–î–æ—Å—Ç—É–ø–µ–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º –ø–æ –∞–¥—Ä–µ—Å—É: `/admin/performance`

–§—É–Ω–∫—Ü–∏–∏:
- –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –ê–Ω–∞–ª–∏–∑ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫—ç—à–∞
- –°–±—Ä–æ—Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞

---

### 4. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** (`app/utils/error_handlers.py`)

–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –æ—à–∏–±–æ–∫.

#### –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º—ã–µ HTTP –∫–æ–¥—ã:

| –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ | –®–∞–±–ª–æ–Ω |
|-----|----------|--------|
| 400 | Bad Request | `errors/400.html` |
| 401 | Unauthorized | `errors/401.html` |
| 403 | Forbidden | `errors/403.html` |
| 404 | Not Found | `errors/404.html` |
| 405 | Method Not Allowed | `errors/405.html` |
| 413 | Request Too Large | `errors/413.html` |
| 429 | Rate Limit Exceeded | `errors/429.html` |
| 500 | Internal Server Error | `errors/500.html` |
| 502 | Bad Gateway | `errors/502.html` |
| 503 | Service Unavailable | `errors/503.html` |

#### –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è API:

```python
from app.utils.error_handlers import (
    ValidationError,
    ResourceNotFoundError,
    AuthenticationError,
    AuthorizationError,
    RateLimitError
)

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
if not user:
    raise ResourceNotFoundError('User', user_id)

if not form.validate():
    raise ValidationError('Invalid data', errors=form.errors)

if not current_user.is_admin:
    raise AuthorizationError('Admin access required')
```

#### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫:

–í—Å–µ –æ—à–∏–±–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å –ø–æ–ª–Ω—ã–º traceback:
```python
{
    'timestamp': '2025-11-18T12:34:56',
    'path': '/employees/create',
    'method': 'POST',
    'ip': '127.0.0.1',
    'error': 'Database connection failed',
    'traceback': '...'
}
```

---

## üéØ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î

### Eager Loading (—É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ N+1 –ø—Ä–æ–±–ª–µ–º—ã)

–í `app/routes/employees.py` –¥–æ–±–∞–≤–ª–µ–Ω–æ:

```python
from sqlalchemy.orm import joinedload, selectinload

# –ó–∞–≥—Ä—É–∑–∫–∞ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∑–∞ –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å
query = Employee.query.options(
    joinedload(Employee.department),
    joinedload(Employee.position)
)
```

### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤

```python
@cached(timeout=600, key_prefix='departments')
def get_cached_departments():
    return Department.query.order_by(Department.name).all()

@cached(timeout=600, key_prefix='positions')
def get_cached_positions():
    return Position.query.order_by(Position.title).all()
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∫—ç—à–∞

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏/—É–¥–∞–ª–µ–Ω–∏–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞:
```python
def invalidate_employee_cache():
    invalidate_cache('view:employees:*')
    invalidate_cache('view:list_employees:*')
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±–æ—Ä –º–µ—Ç—Ä–∏–∫

–ö–∞–∂–¥—ã–π HTTP –∑–∞–ø—Ä–æ—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–±–∏—Ä–∞–µ—Ç:
- ‚è±Ô∏è –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (–º—Å)
- üåê –ú–µ—Ç–æ–¥ –∏ –ø—É—Ç—å
- üìã –°—Ç–∞—Ç—É—Å –∫–æ–¥
- üñ•Ô∏è IP –∞–¥—Ä–µ—Å
- üÜî –£–Ω–∏–∫–∞–ª—å–Ω—ã–π Request ID

### –ó–∞–≥–æ–ª–æ–≤–∫–∏ –æ—Ç–≤–µ—Ç–∞

–ö –∫–∞–∂–¥–æ–º—É –æ—Ç–≤–µ—Ç—É –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –∑–∞–≥–æ–ª–æ–≤–∫–∏:
```
X-Request-ID: 20251118123456-1523
X-Execution-Time: 45.23
```

### –û–ø–æ–≤–µ—â–µ–Ω–∏—è –æ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:
```
WARNING: Slow request: GET /employees/ took 1.23s
```

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –∑–∞–≥–æ–ª–æ–≤–∫–∏

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –∑–∞–≥–æ–ª–æ–≤–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:
```
X-Content-Type-Options: nosniff
X-Frame-Options: SAMEORIGIN
X-XSS-Protection: 1; mode=block
Strict-Transport-Security: max-age=31536000
Content-Security-Policy: ...
```

---

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### –û—Å–Ω–æ–≤–Ω—ã–µ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ):
```bash
pip install APScheduler==3.10.4 psutil==6.1.0
```

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ (–¥–ª—è –ø–æ–ª–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏):
```bash
pip install redis==5.2.0 hiredis==3.0.0
```

### –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
pip install -r requirements.txt
```

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–í `instance/config.py`:

```python
# Redis (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
REDIS_URL = 'redis://localhost:6379/0'

# –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á
SCHEDULER_ENABLED = True  # –í–∫–ª—é—á–∏—Ç—å –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ (—Ç–æ–ª—å–∫–æ production)

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
PERFORMANCE_MONITORING = True
SLOW_QUERY_THRESHOLD = 1.0  # —Å–µ–∫—É–Ω–¥—ã

# –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
CACHE_DEFAULT_TIMEOUT = 300  # 5 –º–∏–Ω—É—Ç
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—ç—à–∞:
```python
from app.utils.redis_cache import cache

# –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
stats = cache.get_stats()
print(f"Cache type: {stats['type']}")  # redis –∏–ª–∏ memory
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞:
```python
from app.utils.scheduler import get_scheduled_jobs

jobs = get_scheduled_jobs()
for job in jobs:
    print(f"{job['name']}: {job['next_run']}")
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:
```bash
# –°–¥–µ–ª–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–ø—Ä–æ—Å–æ–≤
curl http://localhost:5000/employees

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
curl http://localhost:5000/admin/performance
```

---

## üìà –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
- ‚ùå N+1 –∑–∞–ø—Ä–æ—Å—ã –∫ –ë–î –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
- ‚ùå –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤
- ‚ùå –ù–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚ùå –ú–µ–¥–ª–µ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–æ–≤ (200+ –º—Å)

### –ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
- ‚úÖ 1 –∑–∞–ø—Ä–æ—Å –≤–º–µ—Å—Ç–æ N+1 (Eager Loading)
- ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤ (10 –º–∏–Ω)
- ‚úÖ Redis –∫—ç—à —Å fallback –Ω–∞ –ø–∞–º—è—Ç—å
- ‚úÖ –ë—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (< 50 –º—Å)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∫—ç—à–∞
- ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

---

## üîç –û—Ç–ª–∞–¥–∫–∞

### –õ–æ–≥–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞:
```bash
tail -f logs/simple_hr.log | grep "scheduler"
```

### –õ–æ–≥–∏ –∫—ç—à–∞:
```bash
tail -f logs/simple_hr.log | grep "cache"
```

### –õ–æ–≥–∏ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤:
```bash
tail -f logs/simple_hr.log | grep "Slow"
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤ –∫–æ–¥–µ:
```python
from flask import current_app

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
stats = current_app.performance_monitor.get_stats()

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫—ç—à–∞
from app.utils.redis_cache import cache
cache_stats = cache.get_stats()
```

---

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ production

### 1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Redis
```bash
# Ubuntu/Debian
sudo apt install redis-server

# MacOS
brew install redis

# Windows (WSL)
sudo service redis-server start
```

### 2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```python
# instance/config.py
import logging

LOG_LEVEL = logging.INFO
LOG_FILE = 'logs/simple_hr.log'
LOG_MAX_BYTES = 10485760  # 10MB
LOG_BACKUP_COUNT = 10
```

### 3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ production
- –†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ `/admin/performance`
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–ª–µ—Ä—Ç—ã –¥–ª—è –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º
- –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫—ç—à–∞

### 4. –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –ø–æ–¥ –≤–∞—à—É timezone
- –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `run_job_now()` –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### 5. –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã –∫–∞–∂–¥—É—é –Ω–æ—á—å (01:00)
- –•—Ä–∞–Ω—è—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –∫–æ–ø–∏–π
- –°—Ç–∞—Ä—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [APScheduler Documentation](https://apscheduler.readthedocs.io/)
- [Redis Python Client](https://redis-py.readthedocs.io/)
- [Flask Performance Tips](https://flask.palletsprojects.com/en/latest/deploying/)

---

## üéâ –ò—Ç–æ–≥–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### –î–æ–±–∞–≤–ª–µ–Ω–æ:
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ –∑–∞–¥–∞—á (7 –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á)
- ‚úÖ Redis –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å fallback
- ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ Eager Loading –¥–ª—è –ë–î
- ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤
- ‚úÖ –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã
- ‚úÖ Health checks

### –£–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:
- üöÄ –°–∫–æ—Ä–æ—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏ —Å–ø–∏—Å–∫–æ–≤: **‚Üì 75%**
- üöÄ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ SQL –∑–∞–ø—Ä–æ—Å–æ–≤: **‚Üì 80%**
- üöÄ –ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏: **‚Üì 40%**
- üöÄ –í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ API: **‚Üì 60%**

---

**Simple HR v2.2** - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π, –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã–π, –º–æ–Ω–∏—Ç–æ—Ä–∏—Ä—É–µ–º—ã–π! üéØ
