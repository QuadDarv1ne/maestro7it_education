<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PacmanLearn - –û–±—É—á–∞—é—â–∞—è –∏–≥—Ä–∞</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: #121212;
            color: #e0e0e0;
            height: 100vh;
            overflow: hidden;
            transition: background-color 0.3s;
        }

        body.light-theme {
            background: #f5f5f5;
            color: #333;
        }

        .container {
            display: flex;
            height: 100vh;
            max-width: 1200px;
            margin: 0 auto;
            padding: 10px;
            gap: 15px;
        }

        .game-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
        }

        body.light-theme .header {
            background: rgba(200, 200, 200, 0.5);
        }

        .header h1 {
            font-size: 1.5rem;
            color: #FFD700;
        }

        .header-controls {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 8px 15px;
            background: #2c3e50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s;
        }

        body.light-theme .btn {
            background: #3498db;
        }

        .btn:hover {
            background: #3498db;
            transform: translateY(-2px);
        }

        body.light-theme .btn:hover {
            background: #2980b9;
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn.secondary {
            background: #7f8c8d;
        }

        body.light-theme .btn.secondary {
            background: #95a5a6;
        }

        .game-area {
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #game-canvas {
            background: #000;
            border-radius: 4px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .mini-map-container {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 4px;
            padding: 5px;
        }

        body.light-theme .mini-map-container {
            background: rgba(255, 255, 255, 0.7);
        }

        .status-bar {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            font-size: 1.1rem;
        }

        body.light-theme .status-bar {
            background: rgba(200, 200, 200, 0.5);
        }

        .score-info, .level-info {
            display: flex;
            gap: 15px;
        }

        .info-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .info-value {
            font-weight: bold;
            color: #FFD700;
            font-size: 1.2rem;
        }

        /* –ü–∞–Ω–µ–ª—å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π */
        .achievements-panel {
            position: fixed;
            top: 0;
            right: -320px;
            width: 300px;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            z-index: 90;
            transition: right 0.3s;
            padding: 20px;
            box-sizing: border-box;
            overflow-y: auto;
        }

        body.light-theme .achievements-panel {
            background: rgba(255, 255, 255, 0.95);
        }

        .achievements-panel.open {
            right: 0;
        }

        .achievements-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .achievements-title {
            font-size: 1.5rem;
            color: #FFD700;
        }

        body.light-theme .achievements-title {
            color: #D35400;
        }

        .achievements-close {
            background: #c0392b;
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            font-weight: bold;
            cursor: pointer;
        }

        .achievement {
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            transition: all 0.2s;
        }

        body.light-theme .achievement {
            background: rgba(240, 240, 240, 0.7);
            border: 1px solid #ddd;
        }

        .achievement:hover {
            transform: translateY(-2px);
            background: rgba(255, 255, 255, 0.15);
        }

        body.light-theme .achievement:hover {
            background: rgba(230, 230, 230, 0.7);
        }

        .achievement-title {
            font-weight: bold;
            margin-bottom: 5px;
            color: #FFD700;
        }

        body.light-theme .achievement-title {
            color: #D35400;
        }

        .achievement-description {
            font-size: 0.9rem;
            color: #bdc3c7;
        }

        body.light-theme .achievement-description {
            color: #7f8c8d;
        }

        .achievement-status {
            display: inline-block;
            margin-top: 5px;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            background: #2ecc71;
            color: white;
        }

        body.light-theme .achievement-status {
            background: #27ae60;
        }

        /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 15px 25px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border-radius: 8px;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s;
            z-index: 100;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        body.light-theme .notification {
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        .notification.show {
            transform: translateY(0);
            opacity: 1;
        }

        .notification.achievement {
            background: #2ecc71;
        }

        body.light-theme .notification.achievement {
            background: #27ae60;
        }

        .notification.error {
            background: #e74c3c;
        }

        body.light-theme .notification.error {
            background: #c0372a;
        }

        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background: #1a1a1a;
            width: 80%;
            max-width: 500px;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        body.light-theme .modal-content {
            background: white;
            color: #333;
        }

        .modal h2 {
            margin-bottom: 20px;
            color: #FFD700;
            text-align: center;
        }

        body.light-theme .modal h2 {
            color: #D35400;
        }

        .modal-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }

        /* –£—Ä–æ–∫–∏ */
        .lesson-panel {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 100;
            display: none;
            flex-direction: column;
        }

        body.light-theme .lesson-panel {
            background: rgba(255, 255, 255, 0.95);
        }

        .lesson-header {
            padding: 15px;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        body.light-theme .lesson-header {
            background: rgba(200, 200, 200, 0.7);
        }

        .lesson-title {
            font-size: 1.5rem;
            color: #FFD700;
        }

        body.light-theme .lesson-title {
            color: #D35400;
        }

        .lesson-close {
            background: #c0392b;
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            font-weight: bold;
            cursor: pointer;
        }

        .lesson-content {
            flex: 1;
            overflow-y: auto;
            padding-right: 10px;
        }

        .lesson-step {
            margin-bottom: 30px;
            padding: 15px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
        }

        body.light-theme .lesson-step {
            background: rgba(200, 200, 200, 0.2);
        }

        .lesson-step h4 {
            margin-bottom: 10px;
            color: #3498db;
        }

        body.light-theme .lesson-step h4 {
            color: #2980b9;
        }

        .code-block {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 5px;
            padding: 10px;
            font-family: monospace;
            margin: 10px 0;
            overflow-x: auto;
            white-space: pre;
        }

        body.light-theme .code-block {
            background: rgba(240, 240, 240, 0.7);
        }

        .lesson-controls {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }

        .lesson-nav-btn {
            padding: 10px 20px;
            border-radius: 5px;
            font-size: 1rem;
            cursor: pointer;
        }

        .lesson-nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* –†–µ–¥–∞–∫—Ç–æ—Ä —É—Ä–æ–≤–Ω–µ–π */
        .level-editor {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #1a1a1a;
            z-index: 100;
            display: none;
            flex-direction: column;
        }

        body.light-theme .level-editor {
            background: #f0f0f0;
        }

        .editor-toolbar {
            padding: 15px;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            gap: 10px;
        }

        body.light-theme .editor-toolbar {
            background: rgba(200, 200, 200, 0.7);
        }

        .tool-button {
            padding: 8px 15px;
            background: #2c3e50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        body.light-theme .tool-button {
            background: #3498db;
        }

        .tool-button.active {
            background: #3498db;
            font-weight: bold;
        }

        body.light-theme .tool-button.active {
            background: #2980b9;
        }

        .editor-content {
            display: flex;
            flex: 1;
            padding: 15px;
            gap: 20px;
        }

        .editor-canvas-container {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #editor-canvas {
            background: #000;
            border-radius: 4px;
        }

        .editor-properties {
            width: 250px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 15px;
        }

        body.light-theme .editor-properties {
            background: rgba(200, 200, 200, 0.5);
        }

        .property-group {
            margin-bottom: 20px;
        }

        .property-group h4 {
            margin-bottom: 10px;
            color: #3498db;
        }

        body.light-theme .property-group h4 {
            color: #2980b9;
        }

        .property-input {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            border-radius: 4px;
            border: 1px solid #555;
            background: #333;
            color: white;
        }

        body.light-theme .property-input {
            background: white;
            border-color: #ddd;
            color: #333;
        }

        .editor-controls {
            display: flex;
            justify-content: space-between;
            padding: 15px;
            background: rgba(0, 0, 0, 0.7);
        }

        body.light-theme .editor-controls {
            background: rgba(200, 200, 200, 0.7);
        }

        /* –¢–µ—Å—Ç—ã */
        .test-panel {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 100;
            display: none;
            flex-direction: column;
            padding: 20px;
            box-sizing: border-box;
        }

        body.light-theme .test-panel {
            background: rgba(255, 255, 255, 0.95);
        }

        .test-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .test-title {
            font-size: 1.5rem;
            color: #FFD700;
        }

        body.light-theme .test-title {
            color: #D35400;
        }

        .test-close {
            background: #c0392b;
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            font-weight: bold;
            cursor: pointer;
        }

        .test-content {
            flex: 1;
            overflow-y: auto;
            padding: 0 10px;
        }

        .test-question {
            margin-bottom: 30px;
            padding: 20px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
        }

        body.light-theme .test-question {
            background: rgba(240, 240, 240, 0.7);
        }

        .test-question h4 {
            margin-bottom: 15px;
            color: #3498db;
        }

        body.light-theme .test-question h4 {
            color: #2980b9;
        }

        .test-option {
            padding: 12px;
            margin: 8px 0;
            border: 1px solid #555;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s;
        }

        body.light-theme .test-option {
            background: rgba(240, 240, 240, 0.7);
            border-color: #ddd;
        }

        .test-option:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        body.light-theme .test-option:hover {
            background: rgba(230, 230, 230, 0.7);
        }

        .feedback {
            margin-top: 15px;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
        }

        .feedback.success {
            background: rgba(46, 204, 113, 0.2);
            color: #27ae60;
        }

        .feedback.error {
            background: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
        }

        .test-results {
            text-align: center;
        }

        .test-score {
            font-size: 2rem;
            margin: 20px 0;
            color: #3498db;
        }

        body.light-theme .test-score {
            color: #2980b9;
        }

        .sound-visualization {
            display: flex;
            gap: 2px;
            height: 20px;
            margin-top: 5px;
        }

        .sound-bar {
            flex: 1;
            background: #3498db;
            border-radius: 2px 2px 0 0;
            transition: height 0.05s;
        }

        .music-indicator {
            position: absolute;
            bottom: 10px;
            right: 10px;
            width: 20px;
            height: 20px;
            background: #e74c3c;
            border-radius: 50%;
            display: none;
        }

        /* –†–µ–∂–∏–º –æ–±—É—á–µ–Ω–∏—è */
        .learning-mode {
            position: fixed;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            width: 80%;
            max-width: 600px;
            background: rgba(0, 0, 0, 0.8);
            border-radius: 10px;
            padding: 15px;
            display: none;
            z-index: 100;
        }

        body.light-theme .learning-mode {
            background: rgba(255, 255, 255, 0.9);
            color: #333;
        }

        .learning-mode h3 {
            margin-bottom: 10px;
            color: #FFD700;
        }

        body.light-theme .learning-mode h3 {
            color: #D35400;
        }

        /* –ü–∞–Ω–µ–ª—å –æ—Ç–ª–∞–¥–∫–∏ */
        .debug-panel {
            position: fixed;
            top: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 8px;
            padding: 15px;
            display: none;
            z-index: 100;
            font-size: 0.9rem;
        }

        body.light-theme .debug-panel {
            background: rgba(255, 255, 255, 0.9);
            color: #333;
        }

        .debug-content {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 10px;
        }

        .debug-item {
            display: flex;
            justify-content: space-between;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="game-container">
            <div class="header">
                <h1>PacmanLearn</h1>
                <div class="header-controls">
                    <button id="mode-toggle" class="btn"><span>üéì</span> –†–µ–∂–∏–º –æ–±—É—á–µ–Ω–∏—è: –í—ã–∫–ª</button>
                    <button id="theme-toggle" class="btn"><span>üåô</span> –¢–µ–º–Ω–∞—è —Ç–µ–º–∞</button>
                    <button id="achievements-btn" class="btn"><span>üèÜ</span> –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</button>
                    <button id="sound-toggle" class="btn"><span>üîä</span> –ó–≤—É–∫: –í–∫–ª</button>
                    <button id="pause-toggle" class="btn"><span>‚è∏Ô∏è</span> –ü–∞—É–∑–∞</button>
                    <button id="level-editor-toggle" class="btn"><span>üõ†Ô∏è</span> –†–µ–¥–∞–∫—Ç–æ—Ä</button>
                    <button id="save-progress" class="btn secondary"><span>üíæ</span> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    <button id="load-progress" class="btn secondary"><span>üìÇ</span> –ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
                    <select id="difficulty-select" class="btn" style="padding:8px 10px;">
                        <option value="easy">–õ–µ–≥–∫–æ</option>
                        <option value="normal" selected>–ù–æ—Ä–º–∞</option>
                        <option value="hard">–°–ª–æ–∂–Ω–æ</option>
                    </select>
                </div>
            </div>
            
            <div class="game-area">
                <canvas id="game-canvas" width="440" height="520"></canvas>
                <div class="mini-map-container">
                    <canvas id="mini-map" width="100" height="100"></canvas>
                </div>
            </div>
            
            <div class="sound-visualization" id="sound-visualizer">
                <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã–µ –±–∞—Ä—ã -->
            </div>
            <div class="music-indicator" id="music-indicator"></div>
            
            <div class="status-bar">
                <div class="score-info">
                    <div class="info-item">
                        <span>–û—á–∫–∏</span>
                        <span id="score" class="info-value">0</span>
                    </div>
                    <div class="info-item">
                        <span>–†–µ–∫–æ—Ä–¥</span>
                        <span id="high-score" class="info-value">0</span>
                    </div>
                </div>
                <div class="level-info">
                    <div class="info-item">
                        <span>–£—Ä–æ–≤–µ–Ω—å</span>
                        <span id="level" class="info-value">1</span>
                    </div>
                    <div class="info-item">
                        <span>–ñ–∏–∑–Ω–∏</span>
                        <span id="lives">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="learning-mode" id="learning-mode">
            <h3>–ü–æ—è—Å–Ω–µ–Ω–∏–µ –∫ –∫–æ–¥—É</h3>
            <p id="learning-content">–ù–∞–∂–º–∏—Ç–µ –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç –∏–≥—Ä—ã, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π —á–∞—Å—Ç–∏ –∫–æ–¥–∞</p>
        </div>
        
        <div class="debug-panel" id="debug-panel">
            <h3>–†–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏</h3>
            <div class="debug-content">
                <div class="debug-item">
                    <strong>–ü–æ–∑–∏—Ü–∏—è –ü–∞–∫–º–∞–Ω–∞:</strong> <span id="debug-pos">10, 15</span>
                </div>
                <div class="debug-item">
                    <strong>–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:</strong> <span id="debug-dir">right</span>
                </div>
                <div class="debug-item">
                    <strong>–°–∫–æ—Ä–æ—Å—Ç—å:</strong> <span id="debug-speed">200 –º—Å</span>
                </div>
                <div class="debug-item">
                    <strong>–°—É–ø–µ—Ä-–µ–¥–∞:</strong> <span id="debug-power">–ù–µ –∞–∫—Ç–∏–≤–Ω–∞</span>
                </div>
                <div class="debug-item">
                    <strong>FPS:</strong> <span id="debug-fps">60</span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –ü–∞–Ω–µ–ª—å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π -->
    <div class="achievements-panel" id="achievements-panel">
        <div class="achievements-header">
            <h2 class="achievements-title">–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h2>
            <button class="achievements-close" id="achievements-close">√ó</button>
        </div>
        <div id="achievements-list">
            <!-- –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –∑–¥–µ—Å—å -->
        </div>
    </div>
    
    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
    <div class="notification" id="notification"></div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
    <div class="modal" id="game-over">
        <div class="modal-content">
            <h2>–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞</h2>
            <p>–í–∞—à —Å—á–µ—Ç: <span id="final-score" class="info-value">0</span></p>
            <div class="modal-buttons">
                <button class="btn" id="restart-game">–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
                <button class="btn secondary" id="close-game-over">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>
    
    <div class="modal" id="level-complete">
        <div class="modal-content">
            <h2>–£—Ä–æ–≤–µ–Ω—å –ø—Ä–æ–π–¥–µ–Ω!</h2>
            <p>–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º, –≤—ã —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–∏–ª–∏ —É—Ä–æ–≤–µ–Ω—å <span id="completed-level" class="info-value">1</span></p>
            <div class="modal-buttons">
                <button class="btn" id="next-level">–°–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å</button>
            </div>
        </div>
    </div>
    
    <!-- –ü–∞–Ω–µ–ª—å —É—Ä–æ–∫–æ–≤ -->
    <div class="lesson-panel" id="lesson-panel">
        <div class="lesson-header">
            <h2 class="lesson-title" id="lesson-title"></h2>
            <button class="lesson-close" id="lesson-close">√ó</button>
        </div>
        <div class="lesson-content" id="lesson-content">
            <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —É—Ä–æ–∫–∞ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–æ –∑–¥–µ—Å—å -->
        </div>
        <div class="lesson-controls">
            <button class="lesson-nav-btn" id="lesson-prev">–ù–∞–∑–∞–¥</button>
            <button class="lesson-nav-btn" id="lesson-next">–î–∞–ª–µ–µ</button>
        </div>
    </div>
    
    <!-- –†–µ–¥–∞–∫—Ç–æ—Ä —É—Ä–æ–≤–Ω–µ–π -->
    <div class="level-editor" id="level-editor">
        <div class="editor-toolbar">
            <button class="tool-button active" data-tool="wall">–°—Ç–µ–Ω–∞</button>
            <button class="tool-button" data-tool="path">–ü—É—Ç—å</button>
            <button class="tool-button" data-tool="food">–ï–¥–∞</button>
            <button class="tool-button" data-tool="super-food">–°—É–ø–µ—Ä-–µ–¥–∞</button>
            <button class="tool-button" data-tool="pacman">–ü–∞–∫–º–∞–Ω</button>
            <button class="tool-button" data-tool="ghost">–ü—Ä–∏–≤–∏–¥–µ–Ω–∏–µ</button>
        </div>
        <div class="editor-content">
            <div class="editor-canvas-container">
                <canvas id="editor-canvas" width="440" height="520"></canvas>
            </div>
            <div class="editor-properties">
                <div class="property-group">
                    <h4>–°–≤–æ–π—Å—Ç–≤–∞ —É—Ä–æ–≤–Ω—è</h4>
                    <input type="text" class="property-input" id="level-name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —É—Ä–æ–≤–Ω—è">
                    <input type="number" class="property-input" id="level-number" placeholder="–ù–æ–º–µ—Ä —É—Ä–æ–≤–Ω—è" min="1">
                </div>
                <div class="property-group">
                    <h4>–î–µ–π—Å—Ç–≤–∏—è</h4>
                    <button class="btn" id="save-level">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å</button>
                    <button class="btn secondary" id="load-level">–ó–∞–≥—Ä—É–∑–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å</button>
                    <button class="btn secondary" id="reset-editor">–°–±—Ä–æ—Å–∏—Ç—å</button>
                </div>
            </div>
        </div>
        <div class="editor-controls">
            <button class="btn secondary" id="cancel-editor">–û—Ç–º–µ–Ω–∞</button>
            <button class="btn" id="apply-editor">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
        </div>
    </div>
    
    <!-- –ü–∞–Ω–µ–ª—å —Ç–µ—Å—Ç–æ–≤ -->
    <div class="test-panel" id="test-panel">
        <div class="test-header">
            <h2 class="test-title" id="test-title"></h2>
            <button class="test-close" id="test-close">√ó</button>
        </div>
        <div class="test-content" id="test-content">
            <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ç–µ—Å—Ç–∞ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–æ –∑–¥–µ—Å—å -->
        </div>
    </div>
    
    <script>
        /**
         * –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –∏–≥—Ä—ã PacmanLearn
         * @class PacmanGame
         * @description –û–±—É—á–∞—é—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π –∏–≥—Ä—ã —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
         * –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è –æ—Å–Ω–æ–≤ 2D-–≥–µ–π–º–¥–µ–≤–∞ –Ω–∞ JavaScript
         */
        class PacmanGame {
            /**
             * –°–æ–∑–¥–∞–µ—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä –∏–≥—Ä—ã –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
             * @constructor
             */
            constructor() {
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑–æ–≤—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
                this.canvas = document.getElementById('game-canvas');
                this.ctx = this.canvas.getContext('2d');
                this.cellSize = 22; // –†–∞–∑–º–µ—Ä —è—á–µ–π–∫–∏ –≤ –ø–∏–∫—Å–µ–ª—è—Ö
                this.gameSpeed = 200; // –ë–∞–∑–æ–≤–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –∏–≥—Ä—ã (–º—Å)
                this.isRunning = false;
                this.isLearningMode = false;
                this.isSoundEnabled = true;
                this.currentLevel = 1;
                this.lastTimestamp = 0;
                this.animationFrameId = null;
                this.soundVisualizer = document.getElementById('sound-visualizer');
                this.musicIndicator = document.getElementById('music-indicator');
                this.editorMoveTimeout = null;
                this.codeModified = false;
                this.powerModeTimer = null;
                this.powerModeStart = 0;
                this.powerMode = false;
                this.isVisualizingPath = false;
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ü–∞–∫–º–∞–Ω–∞
                this.pacman = {
                    x: 10,
                    y: 15,
                    direction: 'right',
                    nextDirection: null,
                    mouthAngle: 0,
                    mouthOpening: 0.1,
                    lastEatTime: 0,
                    eatInterval: 150 // –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –º–µ–∂–¥—É –∑–≤—É–∫–∞–º–∏ –ø–æ–µ–¥–∞–Ω–∏—è
                };
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–≤–∏–¥–µ–Ω–∏–π
                this.ghosts = [
                    {
                        x: 10,
                        y: 8,
                        direction: 'left',
                        mode: 'wandering', // wandering, chasing, fleeing
                        speed: 0.8,
                        color: 'red',
                        fearTimer: null
                    },
                    {
                        x: 9,
                        y: 9,
                        direction: 'up',
                        mode: 'wandering',
                        speed: 0.7,
                        color: 'pink',
                        fearTimer: null
                    },
                    {
                        x: 11,
                        y: 9,
                        direction: 'down',
                        mode: 'wandering',
                        speed: 0.6,
                        color: 'cyan',
                        fearTimer: null
                    },
                    {
                        x: 10,
                        y: 10,
                        direction: 'right',
                        mode: 'wandering',
                        speed: 0.5,
                        color: 'orange',
                        fearTimer: null
                    }
                ];
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä–æ–≤–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
                this.score = 0;
                this.highScore = parseInt(localStorage.getItem('pacmanHighScore') || '0', 10);
                this.lives = 3; // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∂–∏–∑–Ω–µ–π
                this.foodCount = 0;
                this.totalFood = 0; // –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –µ–¥—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ
                this.particles = [];
                this.activeSounds = new Set();
                this.musicPlaying = false;
                this.musicTimeout = null;
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–∏–Ω–∏-–∫–∞—Ä—Ç—ã
                this.miniMapCanvas = document.getElementById('mini-map');
                this.miniMapCtx = this.miniMapCanvas.getContext('2d');
                this.miniMapScale = 1;
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–≤—É–∫–∞
                this.setupSoundVisualizer();
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
                this.isDarkTheme = true;
                this.currentLesson = null;
                this.currentLessonStep = 0;
                this.currentTest = null;
                this.currentQuestion = 0;
                this.testScore = 0;
                this.codeModified = false;
                
                // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
                this.loadProgress();
                
                // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
                this.setupEventListeners();
                
                // –ó–∞–≥—Ä—É–∑–∫–∞ —É—Ä–æ–≤–Ω–µ–π
                this.levels = this.loadLevels();
                this.currentMap = this.cloneMap(this.levels[0]);
                this.populateFoodIfMissing(this.currentMap);
                this.countTotalFood();
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
                this.updateUI();
                
                // –ó–∞–≥—Ä—É–∑–∫–∞ –∑–≤—É–∫–æ–≤—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤
                this.audioContext = null;
                this.sounds = this.loadSounds();
                this.ensureAudioContext = this.ensureAudioContext.bind(this);
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —É—á–µ–±–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
                this.lessons = this.loadLessons();
                this.achievements = this.loadAchievements();
                this.tests = this.loadTests();
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö UI-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
                this.initUIComponents();
                
                // –ó–∞–ø—É—Å–∫ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∏–≥—Ä–æ–≤–æ–≥–æ —Ü–∏–∫–ª–∞
                this.startGameLoop();
            }
            
            /**
             * –≠–∫—Ä–∞–Ω–∏—Ä—É–µ—Ç HTML –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –∫–æ–¥-–±–ª–æ–∫–µ
             * @param {string} unsafe - –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω–∞—è —Å—Ç—Ä–æ–∫–∞
             * @returns {string} –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞
             */
            escapeHtml(unsafe) {
                return unsafe.replace(/&/g, "&amp;")
                    .replace(/</g, "&lt;")
                    .replace(/>/g, "&gt;")
                    .replace(/"/g, "&quot;")
                    .replace(/'/g, "&#039;");
            }
            
            /**
             * –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é AudioContext –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é
             */
            ensureAudioContext() {
                if (!this.audioContext) {
                    try {
                        window.AudioContext = window.AudioContext || window.webkitAudioContext;
                        this.audioContext = new AudioContext();
                    } catch (e) {
                        console.error('Web Audio API –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è', e);
                        this.isSoundEnabled = false;
                    }
                }
            }
            
            /**
             * –ê–∫—Ç–∏–≤–∏—Ä—É–µ—Ç —Ä–µ–∂–∏–º —Å—É–ø–µ—Ä-–µ–¥—ã
             */
            activatePowerMode() {
                this.collectFood(50);
                this.powerMode = true;
                this.powerModeStart = Date.now();
                
                // –ò–∑–º–µ–Ω—è–µ–º —Ü–≤–µ—Ç –≤—Å–µ—Ö –ø—Ä–∏–≤–∏–¥–µ–Ω–∏–π –Ω–∞ —Å–∏–Ω–∏–π
                for (let i = 0; i < this.ghosts.length; i++) {
                    this.ghosts[i].color = 'blue';
                    this.ghosts[i].mode = 'fleeing';
                    
                    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ç–∞–π–º–µ—Ä —Å—Ç—Ä–∞—Ö–∞, –µ—Å–ª–∏ –æ–Ω —É–∂–µ –∑–∞–ø—É—â–µ–Ω
                    if (this.ghosts[i].fearTimer) {
                        clearTimeout(this.ghosts[i].fearTimer);
                        this.ghosts[i].fearTimer = null;
                    }
                }
                
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–∞–π–º–µ—Ä –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–µ–∂–∏–º–∞ —Å—É–ø–µ—Ä-–µ–¥—ã
                if (this.powerModeTimer) {
                    clearTimeout(this.powerModeTimer);
                }
                
                const powerDuration = this.difficulty === 'easy' ? 12000 : this.difficulty === 'hard' ? 8000 : 10000;
                this.powerModeTimer = setTimeout(() => {
                    this.powerMode = false;
                    // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∏—Å—Ö–æ–¥–Ω—ã–µ —Ü–≤–µ—Ç–∞ –ø—Ä–∏–≤–∏–¥–µ–Ω–∏–π
                    for (let i = 0; i < this.ghosts.length; i++) {
                        this.ghosts[i].color = ['red', 'pink', 'cyan', 'orange'][i % 4];
                        this.ghosts[i].mode = 'chasing';
                    }
                }, powerDuration);
            }
            
            /**
             * –°–±—Ä–∞—Å—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏—é –ø—Ä–∏–≤–∏–¥–µ–Ω–∏—è –ø–æ—Å–ª–µ —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏—è
             * @param {number} index - –ò–Ω–¥–µ–∫—Å –ø—Ä–∏–≤–∏–¥–µ–Ω–∏—è
             */
            resetGhost(index) {
                this.ghosts[index].x = 10;
                this.ghosts[index].y = 8;
                this.ghosts[index].direction = 'left';
                this.ghosts[index].mode = 'wandering';
                this.ghosts[index].color = ['red', 'pink', 'cyan', 'orange'][index];
            }
            
            /**
             * –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è –º–µ–∂–¥—É –ü–∞–∫–º–∞–Ω–æ–º –∏ –¥—Ä—É–≥–∏–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏
             */
            checkCollisions() {
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å –µ–¥–æ–π
                if (this.hasFood(this.pacman.x, this.pacman.y)) {
                    this.collectFood(10);
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å —Å—É–ø–µ—Ä-–µ–¥–æ–π
                if (this.hasPowerFood(this.pacman.x, this.pacman.y)) {
                    this.activatePowerMode();
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å –ø—Ä–∏–≤–∏–¥–µ–Ω–∏—è–º–∏
                for (let i = 0; i < this.ghosts.length; i++) {
                    const ghost = this.ghosts[i];
                    
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å –ø—Ä–∏–≤–∏–¥–µ–Ω–∏–µ–º
                    if (this.pacman.x === ghost.x && this.pacman.y === ghost.y) {
                        // –ï—Å–ª–∏ –∞–∫—Ç–∏–≤–µ–Ω —Ä–µ–∂–∏–º —Å—É–ø–µ—Ä-–µ–¥—ã, —É–Ω–∏—á—Ç–æ–∂–∞–µ–º –ø—Ä–∏–≤–∏–¥–µ–Ω–∏–µ
                        if (this.powerMode) {
                            this.score += 200;
                            this.resetGhost(i);
                            this.playSound('eat-ghost');
                            this.createParticles(ghost.x, ghost.y);
                            this.updateUI();
                            this.checkAchievements();
                        } 
                        // –û–±—ã—á–Ω–æ–µ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ - –∫–æ–Ω–µ—Ü –∏–≥—Ä—ã
                        else {
                            this.gameOver();
                            return;
                        }
                    }
                }
            }
            
            /**
             * –û–±–Ω–æ–≤–ª—è–µ—Ç —Ä–µ–∂–∏–º –ø—Ä–∏–≤–∏–¥–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–≥—Ä—ã
             */
            updateGhostMode() {
                const dx = this.pacman.x - this.ghosts[0].x;
                const dy = this.pacman.y - this.ghosts[0].y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                // –†–µ–∂–∏–º —Å—É–ø–µ—Ä-–µ–¥—ã –∞–∫—Ç–∏–≤–µ–Ω
                if (this.powerMode) {
                    this.ghosts[0].mode = 'fleeing';
                    this.ghosts[0].color = 'blue';
                } 
                // –ë–ª–∏–∑–∫–æ –∫ –ü–∞–∫–º–∞–Ω—É
                else if (distance < 5) {
                    this.ghosts[0].mode = 'chasing';
                    this.ghosts[0].color = 'red';
                }
                // –î–∞–ª–µ–∫–æ –æ—Ç –ü–∞–∫–º–∞–Ω–∞
                else {
                    this.ghosts[0].mode = 'wandering';
                    this.ghosts[0].color = 'red';
                }
            }
            
            /**
             * –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞–∂–∞—Ç–∏–µ –∫–ª–∞–≤–∏—à –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ü–∞–∫–º–∞–Ω–æ–º
             * @param {KeyboardEvent} event - –°–æ–±—ã—Ç–∏–µ –Ω–∞–∂–∞—Ç–∏—è –∫–ª–∞–≤–∏—à–∏
             */
            handleKeyPress(event) {
                if (this.gameOverScreen) return;

                const key = event.key.toLowerCase();
                let direction = null;

                if (key === 'arrowup' || key === 'w') {
                    direction = 'up';
                } else if (key === 'arrowdown' || key === 's') {
                    direction = 'down';
                } else if (key === 'arrowleft' || key === 'a') {
                    direction = 'left';
                } else if (key === 'arrowright' || key === 'd') {
                    direction = 'right';
                }

                if (direction) {
                    this.pacman.setNextDirection(direction);
                }
            }

            /**
             * –û—Å–Ω–æ–≤–Ω–æ–π –∏–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª
             */
            gameLoop() {
                this.updateUI();
                this.checkCollisions();
                this.updateGhostMode();

                if (this.pacman.isMoving()) {
                    this.pacman.move();
                }

                this.ghosts.forEach(ghost => {
                    if (ghost.isMoving()) {
                        ghost.move();
                    }
                });

                requestAnimationFrame(this.gameLoop.bind(this));
            }
            
            /**
             * –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
             * @param {string} difficulty - –£—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ ('easy', 'medium', 'hard')
             */
            init(difficulty) {
                this.difficulty = difficulty;
                this.score = 0;
                this.powerMode = false;
                this.powerModeTimer = 0;
                this.ghosts = [];
                this.pacman = new Pacman(14, 23);
                this.createGhosts();
                this.createMaze();
                this.gameLoop();
                window.addEventListener('keydown', this.handleKeyPress.bind(this));
            }
            
            /**
             * –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏–≥—Ä—É –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —ç–∫—Ä–∞–Ω –∫–æ–Ω—Ü–∞ –∏–≥—Ä—ã
             */
            gameOver() {
                this.gameOverScreen = true;
                this.updateUI();
            }
            
            /**
             * –û–±–Ω–æ–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏–≥—Ä—ã
             */
            updateUI() {
                document.getElementById('score').textContent = `Score: ${this.score}`;
                document.getElementById('lives').textContent = `Lives: ${this.pacman.lives}`;
                if (this.gameOverScreen) {
                    document.getElementById('game-over').style.display = 'block';
                }
            }
            
            /**
             * –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∏–≥—Ä–æ–∫–∞
             */
            checkAchievements() {
                if (this.score >= 1000) {
                    this.unlockAchievement('1000 Points');
                }
                if (this.score >= 2000) {
                    this.unlockAchievement('2000 Points');
                }
                if (this.score >= 3000) {
                    this.unlockAchievement('3000 Points');
                }
                if (this.score >= 4000) {
                    this.unlockAchievement('4000 Points');
                }
                if (this.score >= 5000) {
                    this.unlockAchievement('5000 Points');
                }
            }
            
            /**
             * –ü–æ–¥–∫–ª—é—á–∞–µ—Ç –∑–≤—É–∫–æ–≤–æ–π —ç—Ñ—Ñ–µ–∫—Ç
             * @param {string} soundName - –ò–º—è –∑–≤—É–∫–æ–≤–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞
             */
            playSound(soundName) {
                const sound = new Audio(`sounds/${soundName}.mp3`);
                sound.play();
            }
            
            /**
             * –°–æ–∑–¥–∞–µ—Ç —á–∞—Å—Ç–∏—Ü—ã –≤ –∑–∞–¥–∞–Ω–Ω—ã—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞—Ö
             * @param {number} x - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ –ø–æ –æ—Å–∏ X
             * @param {number} y - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ –ø–æ –æ—Å–∏ Y
             */
            createParticles(x, y) {
                for (let i = 0; i < 50; i++) {
                    const particle = document.createElement('div');
                    particle.classList.add('particle');
                    particle.style.left = `${x * 20}px`;
                    particle.style.top = `${y * 20}px`;
                    particle.style.background = `hsl(${Math.random() * 360}, 100%, 50%)`;
                    document.getElementById('game-container').appendChild(particle);
                    setTimeout(() => {
                        particle.remove();
                    }, 1000);
                }
            }
            
            /**
             * –°–æ–∑–¥–∞–µ—Ç –ø—Ä–∏–≤–∏–¥–µ–Ω–∏–π
             */
            createGhosts() {
                this.ghosts.push(new Ghost(14, 11, 'red'));
                this.ghosts.push(new Ghost(12, 14, 'pink'));
                this.ghosts.push(new Ghost(14, 14, 'cyan'));
                this.ghosts.push(new Ghost(16, 14, 'orange'));
            }
            
            /**
             * –°–æ–∑–¥–∞–µ—Ç –ª–∞–±–∏—Ä–∏–Ω—Ç
             */
            createMaze() {
                const maze = document.getElementById('maze');
                maze.innerHTML = '';
                for (let y = 0; y < 28; y++) {
                    for (let x = 0; x < 28; x++) {
                        const cell = document.createElement('div');
                        cell.classList.add('cell');
                        if (this.isWall(x, y)) {
                            cell.classList.add('wall');
                        } else if (this.isDot(x, y)) {
                            cell.classList.add('dot');
                        } else if (this.isPowerPellet(x, y)) {
                            cell.classList.add('power-pellet');
                        }
                        maze.appendChild(cell);
                    }
                }
            }
            
            /**
             * –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –∫–ª–µ—Ç–∫–∞ —Å—Ç–µ–Ω–æ–π
             * @param {number} x - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ –ø–æ –æ—Å–∏ X
             * @param {number} y - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ –ø–æ –æ—Å–∏ Y
             * @returns {boolean} - –Ø–≤–ª—è–µ—Ç—Å—è –ª–∏ –∫–ª–µ—Ç–∫–∞ —Å—Ç–µ–Ω–æ–π
             */
            isWall(x, y) {
                return this.mazeData[y][x] === 1;
            }
            
            /**
             * –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –∫–ª–µ—Ç–∫–∞ —Ç–æ—á–∫–æ–π
             * @param {number} x - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ –ø–æ –æ—Å–∏ X
             * @param {number} y - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ –ø–æ –æ—Å–∏ Y
             * @returns {boolean} - –Ø–≤–ª—è–µ—Ç—Å—è –ª–∏ –∫–ª–µ—Ç–∫–∞ —Ç–æ—á–∫–æ–π
             */
            isDot(x, y) {
                return this.mazeData[y][x] === 2;
            }
            
            /**
             * –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –∫–ª–µ—Ç–∫–∞ —Å—É–ø–µ—Ä-–µ–¥–æ–π
             * @param {number} x - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ –ø–æ –æ—Å–∏ X
             * @param {number} y - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ –ø–æ –æ—Å–∏ Y
             * @returns {boolean} - –Ø–≤–ª—è–µ—Ç—Å—è –ª–∏ –∫–ª–µ—Ç–∫–∞ —Å—É–ø–µ—Ä-–µ–¥–æ–π
             */
            isPowerPellet(x, y) {
                return this.mazeData[y][x] === 3;
            }
            
            /**
             * –ê–∫—Ç–∏–≤–∏—Ä—É–µ—Ç —Ä–µ–∂–∏–º —Å—É–ø–µ—Ä-–µ–¥—ã
             */
            activatePowerMode() {
                this.powerMode = true;
                this.powerModeTimer = 10000;
                this.playSound('power-pellet');
            }
            
            /**
             * –î–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç —Ä–µ–∂–∏–º —Å—É–ø–µ—Ä-–µ–¥—ã
             */
            deactivatePowerMode() {
                this.powerMode = false;
            }
            
            /**
             * –°–±—Ä–∞—Å—ã–≤–∞–µ—Ç –ø—Ä–∏–≤–∏–¥–µ–Ω–∏—è –≤ –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
             */
            resetGhosts() {
                this.ghosts.forEach(ghost => {
                    ghost.reset();
                });
            }
            
            /**
             * –°–±—Ä–∞—Å—ã–≤–∞–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –ø—Ä–∏–≤–∏–¥–µ–Ω–∏–µ –≤ –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
             * @param {number} index - –ò–Ω–¥–µ–∫—Å –ø—Ä–∏–≤–∏–¥–µ–Ω–∏—è
             */
            resetGhost(index) {
                this.ghosts[index].reset();
            }
            
            /**
             * –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ—Ç –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ
             * @param {string} achievement - –ù–∞–∑–≤–∞–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
             */
            unlockAchievement(achievement) {
                console.log(`Achievement unlocked: ${achievement}`);
            }
        }
        
        const game = new PacmanGame();
        game.init('medium');

                        ghost.mode = 'wandering';
                        ghost.color = ['red', 'pink', 'cyan', 'orange'][index];
                    }
                });
            }
            
            /**
             * –ù–∞—Ö–æ–¥–∏—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –ø—É—Ç—å –∫ —Ü–µ–ª–∏
             * @param {number} ghostIndex - –ò–Ω–¥–µ–∫—Å –ø—Ä–∏–≤–∏–¥–µ–Ω–∏—è
             * @param {number} targetX - –¶–µ–ª–µ–≤–∞—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ X
             * @param {number} targetY - –¶–µ–ª–µ–≤–∞—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ Y
             * @returns {string} –õ—É—á—à–µ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è
             */
            findPathToTarget(ghostIndex, targetX, targetY) {
                const ghost = this.ghosts[ghostIndex];
                const directions = ['up', 'down', 'left', 'right'];
                let bestDirection = null;
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–µ–∂–∏–º –ø—Ä–∏–≤–∏–¥–µ–Ω–∏—è –¥–ª—è –≤—ã–±–æ—Ä–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
                const isFleeing = this.ghosts[ghostIndex].mode === 'fleeing';
                let bestScore = isFleeing ? -Infinity : Infinity;
                
                for (const direction of directions) {
                    const nextPos = this.getFuturePosition(ghost.x, ghost.y, direction);
                    
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ —Ö–æ–¥–∞
                    if (!this.isValidMove(nextPos.x, nextPos.y, 'ghost') || 
                        direction === this.getOppositeDirection(ghost.direction)) {
                        continue;
                    }
                    
                    // –†–∞—Å—á–µ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –¥–æ —Ü–µ–ª–∏
                    const dx = targetX - nextPos.x;
                    const dy = targetY - nextPos.y;
                    const distance = dx * dx + dy * dy; // –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–≤–∞–¥—Ä–∞—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
                    
                    if (!isFleeing && distance < bestScore) {
                        bestScore = distance;
                        bestDirection = direction;
                    }
                    if (isFleeing && distance > bestScore) {
                        bestScore = distance;
                        bestDirection = direction;
                    }
                }
                
                // –ï—Å–ª–∏ –Ω–µ—Ç –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π, –æ—Å—Ç–∞–µ–º—Å—è –Ω–∞ –º–µ—Å—Ç–µ
                return bestDirection || ghost.direction;
            }
            
            /**
             * –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
             * @param {string} direction - –¢–µ–∫—É—â–µ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
             * @returns {string} –ü—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
             */
            getOppositeDirection(direction) {
                switch(direction) {
                    case 'up': return 'down';
                    case 'down': return 'up';
                    case 'left': return 'right';
                    case 'right': return 'left';
                    default: return direction;
                }
            }
            
            /**
             * –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –±—É–¥—É—â—É—é –ø–æ–∑–∏—Ü–∏—é –ø—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏ –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏
             * @param {number} x - –¢–µ–∫—É—â–∞—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ X
             * @param {number} y - –¢–µ–∫—É—â–∞—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ Y
             * @param {string} direction - –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è
             * @returns {Object} –û–±—ä–µ–∫—Ç —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ x –∏ y
             */
            getFuturePosition(x, y, direction) {
                const nextPos = { x, y };
                switch(direction) {
                    case 'up': nextPos.y--; break;
                    case 'down': nextPos.y++; break;
                    case 'left': nextPos.x--; break;
                    case 'right': nextPos.x++; break;
                }
                return nextPos;
            }
            
            /**
             * –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Ö–æ–¥ –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –¥–æ–ø—É—Å—Ç–∏–º—ã–º
             * @param {number} x - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ X
             * @param {number} y - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ Y
             * @param {string} type - –¢–∏–ø –æ–±—ä–µ–∫—Ç–∞ (pacman –∏–ª–∏ ghost)
             * @returns {boolean} –î–æ–ø—É—Å—Ç–∏–º –ª–∏ —Ö–æ–¥
             */
            isValidMove(x, y, type) {
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã—Ö–æ–¥–∞ –∑–∞ –≥—Ä–∞–Ω–∏—Ü—ã –∫–∞—Ä—Ç—ã
                if (y < 0 || y >= this.currentMap.length || 
                    x < 0 || x >= this.currentMap[0].length) {
                    return false;
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å—Ç–µ–Ω—É
                if (this.currentMap[y][x] === 0) {
                    return false;
                }
                
                // –í–∞–ª–∏–¥–Ω—ã–π —Ö–æ–¥
                return true;
            }
            
            /**
             * –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –æ–±—ã—á–Ω–æ–π –µ–¥—ã –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏
             * @param {number} x - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ X
             * @param {number} y - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ Y
             * @returns {boolean} –ï—Å—Ç—å –ª–∏ –µ–¥–∞
             */
            hasFood(x, y) {
                return this.currentMap[y] && this.currentMap[y][x] === 2;
            }
            
            /**
             * –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —Å—É–ø–µ—Ä-–µ–¥—ã –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏
             * @param {number} x - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ X
             * @param {number} y - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ Y
             * @returns {boolean} –ï—Å—Ç—å –ª–∏ —Å—É–ø–µ—Ä-–µ–¥–∞
             */
            hasPowerFood(x, y) {
                return this.currentMap[y] && this.currentMap[y][x] === 3;
            }
            
            /**
             * –°–æ–±–∏—Ä–∞–µ—Ç –µ–¥—É –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏
             * @param {number} points - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—á–∫–æ–≤
             */
            collectFood(points) {
                const x = this.pacman.x;
                const y = this.pacman.y;
                
                // –£–¥–∞–ª—è–µ–º –µ–¥—É —Å –∫–∞—Ä—Ç—ã
                if (points === 10) {
                    this.currentMap[y][x] = 1;
                    this.foodCount++;
                    this.playSound('eat');
                } else if (points === 50) {
                    this.currentMap[y][x] = 1;
                    this.foodCount += 5;
                }
                
                // –î–æ–±–∞–≤–ª—è–µ–º –æ—á–∫–∏
                this.score += points;
                this.updateUI();
                this.checkAchievements();
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —É—Ä–æ–≤–Ω—è
                this.checkLevelCompletion();
            }
            
            /**
             * –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è
             */
            checkLevelCompletion() {
                if (this.foodCount >= this.totalFood) {
                    this.levelComplete();
                }
            }
            
            /**
             * –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è
             */
            levelComplete() {
                this.pauseGame();
                this.currentLevel++;
                
                // –ó–∞—Ü–∏–∫–ª–∏–≤–∞–µ–º —É—Ä–æ–≤–Ω–∏
                if (this.currentLevel > this.levels.length) {
                    this.currentLevel = 1;
                }
                
                // –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏–≥—Ä—ã
                this.gameSpeed = Math.max(80, this.gameSpeed - 20);
                
                // –°–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è
                this.resetGameState();
                
                // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
                const levelComplete = document.getElementById('level-complete');
                document.getElementById('completed-level').textContent = this.currentLevel - 1;
                levelComplete.style.display = 'block';
                
                setTimeout(() => {
                    levelComplete.style.display = 'none';
                    this.resumeGame();
                }, 2000);
                
                this.updateUI();
                this.checkAchievements();
            }
            
            /**
             * –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ–∫–æ–Ω—á–∞–Ω–∏–µ –∏–≥—Ä—ã
             */
            gameOver() {
                this.lives--;
                if (this.lives <= 0) {
                    // –ò–≥—Ä–∞ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –æ–∫–æ–Ω—á–µ–Ω–∞
                    this.pauseGame();
                    const statusEl = document.getElementById('game-status');
                    if (statusEl) statusEl.textContent = '–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞';
                    document.getElementById('final-score').textContent = this.score;
                    document.getElementById('game-over').style.display = 'block';
                    this.playSound('death');
                    this.createConfetti();
                } else {
                    // –£ –∏–≥—Ä–æ–∫–∞ –µ—â–µ –µ—Å—Ç—å –∂–∏–∑–Ω–∏, –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º —É—Ä–æ–≤–µ–Ω—å
                    this.showNotification(`–û—Å—Ç–∞–ª–æ—Å—å –∂–∏–∑–Ω–µ–π: ${this.lives}`, 'error');
                    this.resetLevel();
                }
            }
            
            /**
             * –°–±—Ä–∞—Å—ã–≤–∞–µ—Ç —Ç–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å
             */
            resetLevel() {
                this.pauseGame();
                this.resetGameState();
                this.updateUI();
                this.resumeGame();
            }
            
            /**
             * –°–±—Ä–∞—Å—ã–≤–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã –∫ –Ω–∞—á–∞–ª—å–Ω–æ–º—É
             */
            resetGameState() {
                // –°–±—Ä–æ—Å –ü–∞–∫–º–∞–Ω–∞
                this.pacman = {
                    x: 10,
                    y: 15,
                    direction: 'right',
                    nextDirection: null,
                    mouthAngle: 0,
                    mouthOpening: 0.1,
                    lastEatTime: 0,
                    eatInterval: 150
                };
                
                // –°–±—Ä–æ—Å –≤—Å–µ—Ö –ø—Ä–∏–≤–∏–¥–µ–Ω–∏–π
                this.ghosts = [
                    {
                        x: 10,
                        y: 8,
                        direction: 'left',
                        mode: 'wandering',
                        speed: 0.8,
                        color: 'red',
                        fearTimer: null
                    },
                    {
                        x: 9,
                        y: 9,
                        direction: 'up',
                        mode: 'wandering',
                        speed: 0.7,
                        color: 'pink',
                        fearTimer: null
                    },
                    {
                        x: 11,
                        y: 9,
                        direction: 'down',
                        mode: 'wandering',
                        speed: 0.6,
                        color: 'cyan',
                        fearTimer: null
                    },
                    {
                        x: 10,
                        y: 10,
                        direction: 'right',
                        mode: 'wandering',
                        speed: 0.5,
                        color: 'orange',
                        fearTimer: null
                    }
                ];
                
                // –°–±—Ä–æ—Å –∏–≥—Ä–æ–≤–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
                this.powerMode = false;
                this.foodCount = 0;
                
                // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —É—Ä–æ–≤–Ω—è
                this.currentMap = this.cloneMap(this.levels[this.currentLevel - 1]);
                this.populateFoodIfMissing(this.currentMap);
                this.mapLayerDirty = true;
                this.countTotalFood();
            }
            
            /**
             * –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç –∏–≥—Ä—É —Å–Ω–∞—á–∞–ª–∞
             */
            restartGame() {
                this.currentLevel = 1;
                this.lives = 3;
                this.score = 0;
                this.gameSpeed = 200;
                this.resetLevel();
                document.getElementById('game-over').style.display = 'none';
                this.updateUI();
            }
            
            /**
             * –û–±–Ω–æ–≤–ª—è–µ—Ç UI, –¥–æ–±–∞–≤–∏–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤
             */
            updateUI() {
                const scoreElement = document.getElementById('score');
                const highScoreElement = document.getElementById('high-score');
                const levelElement = document.getElementById('level');
                const livesElement = document.getElementById('lives');
                
                if (scoreElement) scoreElement.textContent = this.score;
                if (highScoreElement) highScoreElement.textContent = this.highScore;
                if (levelElement) levelElement.textContent = this.currentLevel;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∂–∏–∑–Ω–µ–π
                if (livesElement) {
                    livesElement.innerHTML = '';
                    for (let i = 0; i < this.lives; i++) {
                        const life = document.createElement('span');
                        life.innerHTML = '‚ù§Ô∏è';
                        livesElement.appendChild(life);
                    }
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–ª–∞–¥–æ—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
                this.updateDebugInfo();
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∫–æ—Ä–¥–∞
                if (this.score > this.highScore) {
                    this.highScore = this.score;
                    localStorage.setItem('pacmanHighScore', this.highScore.toString());
                    if (highScoreElement) highScoreElement.textContent = this.highScore;
                }
            }
            
            /**
             * –û–±–Ω–æ–≤–ª—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ –ø–∞–Ω–µ–ª–∏ –æ—Ç–ª–∞–¥–∫–∏
             */
            updateDebugInfo() {
                const debugPos = document.getElementById('debug-pos');
                const debugDir = document.getElementById('debug-dir');
                const debugSpeed = document.getElementById('debug-speed');
                const debugPower = document.getElementById('debug-power');
                
                if (debugPos) debugPos.textContent = `${this.pacman.x}, ${this.pacman.y}`;
                if (debugDir) debugDir.textContent = this.pacman.direction;
                if (debugSpeed) debugSpeed.textContent = `${this.gameSpeed} –º—Å`;
                if (debugPower) {
                    if (this.powerMode) {
                        const timeLeft = 10 - Math.floor((Date.now() - this.powerModeStart) / 1000);
                        debugPower.textContent = `–ê–∫—Ç–∏–≤–Ω–∞ (${timeLeft} —Å)`;
                    } else {
                        debugPower.textContent = '–ù–µ –∞–∫—Ç–∏–≤–Ω–∞';
                    }
                }
            }
            
            /**
             * –û–±–Ω–æ–≤–ª—è–µ—Ç –º–∏–Ω–∏-–∫–∞—Ä—Ç—É
             */
            updateMiniMap() {
                const mapHeight = this.currentMap.length;
                const mapWidth = this.currentMap[0].length;
                const scale = Math.min(
                    this.miniMapCanvas.width / mapWidth,
                    this.miniMapCanvas.height / mapHeight
                );
                
                this.miniMapCtx.clearRect(0, 0, this.miniMapCanvas.width, this.miniMapCanvas.height);
                
                for (let y = 0; y < mapHeight; y++) {
                    for (let x = 0; x < mapWidth; x++) {
                        const cell = this.currentMap[y][x];
                        
                        // –°—Ç–µ–Ω—ã
                        if (cell === 0) {
                            this.miniMapCtx.fillStyle = '#34495e';
                            this.miniMapCtx.fillRect(x * scale, y * scale, scale, scale);
                        }
                        // –ü—É—Ç—å
                        else if (cell === 1) {
                            this.miniMapCtx.fillStyle = '#2c3e50';
                            this.miniMapCtx.fillRect(x * scale, y * scale, scale, scale);
                        }
                        // –ï–¥–∞
                        else if (cell === 2) {
                            this.miniMapCtx.fillStyle = '#ecf0f1';
                            this.miniMapCtx.fillRect(x * scale + scale/3, y * scale + scale/3, scale/3, scale/3);
                        }
                        // –°—É–ø–µ—Ä-–µ–¥–∞
                        else if (cell === 3) {
                            this.miniMapCtx.fillStyle = '#f1c40f';
                            this.miniMapCtx.fillRect(x * scale + scale/4, y * scale + scale/4, scale/2, scale/2);
                        }
                    }
                }
                
                // –ü–æ–∑–∏—Ü–∏—è –ü–∞–∫–º–∞–Ω–∞
                this.miniMapCtx.fillStyle = '#f1c40f';
                this.miniMapCtx.beginPath();
                this.miniMapCtx.arc(
                    this.pacman.x * scale + scale/2,
                    this.pacman.y * scale + scale/2,
                    scale/2.5,
                    0,
                    Math.PI * 2
                );
                this.miniMapCtx.fill();
                
                // –ü–æ–∑–∏—Ü–∏–∏ –ø—Ä–∏–≤–∏–¥–µ–Ω–∏–π
                for (const ghost of this.ghosts) {
                    this.miniMapCtx.fillStyle = ghost.color;
                    this.miniMapCtx.beginPath();
                    this.miniMapCtx.arc(
                        ghost.x * scale + scale/2,
                        ghost.y * scale + scale/2,
                        scale/2.5,
                        0,
                        Math.PI * 2
                    );
                    this.miniMapCtx.fill();
                }
            }
            
            /**
             * –û—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç –∫–∞—Ä—Ç—É
             */
            drawMap() {
                const mapHeight = this.currentMap.length;
                const mapWidth = this.currentMap[0].length;
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º offscreen —Å–ª–æ–π
                if (!this.mapLayerCanvas) {
                    this.mapLayerCanvas = document.createElement('canvas');
                    this.mapLayerCanvas.width = this.canvas.width;
                    this.mapLayerCanvas.height = this.canvas.height;
                    this.mapLayerCtx = this.mapLayerCanvas.getContext('2d');
                    this.redrawStaticMapLayer();
                }
                
                // –ï—Å–ª–∏ –∫–∞—Ä—Ç–∞ –º–µ–Ω—è–ª–∞—Å—å, –ø–µ—Ä–µ—Ä–∏—Å—É–µ–º —Å–ª–æ–π
                if (this.mapLayerDirty) {
                    this.redrawStaticMapLayer();
                    this.mapLayerDirty = false;
                }
                
                // –†–∏—Å—É–µ–º —Å–ª–æ–π –∫–∞—Ä—Ç—ã
                this.ctx.drawImage(this.mapLayerCanvas, 0, 0);
                
                // –î–æ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º –µ–¥—É –ø–æ–≤–µ—Ä—Ö
                for (let y = 0; y < mapHeight; y++) {
                    for (let x = 0; x < mapWidth; x++) {
                        const cell = this.currentMap[y][x];
                        const xPos = x * this.cellSize;
                        const yPos = y * this.cellSize;
                        if (cell === 2) {
                            this.ctx.fillStyle = 'white';
                            this.ctx.beginPath();
                            this.ctx.arc(xPos + this.cellSize/2, yPos + this.cellSize/2, 2, 0, Math.PI * 2);
                            this.ctx.fill();
                        } else if (cell === 3) {
                            this.ctx.fillStyle = '#FFD700';
                            this.ctx.beginPath();
                            this.ctx.arc(xPos + this.cellSize/2, yPos + this.cellSize/2, 5, 0, Math.PI * 2);
                            this.ctx.fill();
                        }
                    }
                }
            }

            /**
             * –ü–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–ª–æ–π –∫–∞—Ä—Ç—ã (—Å—Ç–µ–Ω—ã/–ø—É—Ç—å)
             */
            redrawStaticMapLayer() {
                const mapHeight = this.currentMap.length;
                const mapWidth = this.currentMap[0].length;
                this.mapLayerCtx.fillStyle = '#000';
                this.mapLayerCtx.fillRect(0, 0, this.mapLayerCanvas.width, this.mapLayerCanvas.height);
                for (let y = 0; y < mapHeight; y++) {
                    for (let x = 0; x < mapWidth; x++) {
                        const cell = this.currentMap[y][x];
                        const xPos = x * this.cellSize;
                        const yPos = y * this.cellSize;
                        if (cell === 0) {
                            this.mapLayerCtx.fillStyle = '#2c3e50';
                            this.mapLayerCtx.fillRect(xPos, yPos, this.cellSize, this.cellSize);
                        } else if (cell === 1) {
                            this.mapLayerCtx.fillStyle = '#1a1a1a';
                            this.mapLayerCtx.fillRect(xPos, yPos, this.cellSize, this.cellSize);
                        }
                    }
                }
            }
            
            /**
             * –û—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç –ü–∞–∫–º–∞–Ω–∞
             */
            drawPacman() {
                const x = this.pacman.x * this.cellSize + this.cellSize/2;
                const y = this.pacman.y * this.cellSize + this.cellSize/2;
                const radius = this.cellSize/2 - 2;
                
                this.ctx.fillStyle = 'yellow';
                this.ctx.beginPath();
                
                // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —É–≥–æ–ª —Ä—Ç–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
                let startAngle, endAngle;
                switch(this.pacman.direction) {
                    case 'right':
                        startAngle = this.pacman.mouthAngle;
                        endAngle = Math.PI * 2 - this.pacman.mouthAngle;
                        break;
                    case 'left':
                        startAngle = Math.PI + this.pacman.mouthAngle;
                        endAngle = Math.PI * 3 - this.pacman.mouthAngle;
                        break;
                    case 'up':
                        startAngle = Math.PI * 1.5 + this.pacman.mouthAngle;
                        endAngle = Math.PI * 1.5 - this.pacman.mouthAngle + Math.PI * 2;
                        break;
                    case 'down':
                        startAngle = Math.PI * 0.5 + this.pacman.mouthAngle;
                        endAngle = Math.PI * 0.5 - this.pacman.mouthAngle + Math.PI * 2;
                        break;
                    default:
                        startAngle = 0;
                        endAngle = Math.PI * 2;
                }
                
                this.ctx.arc(x, y, radius, startAngle, endAngle);
                this.ctx.lineTo(x, y);
                this.ctx.fill();
            }
            
            /**
             * –û—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç –ø—Ä–∏–≤–∏–¥–µ–Ω–∏–µ
             */
            drawGhosts() {
                for (const ghost of this.ghosts) {
                    const x = ghost.x * this.cellSize;
                    const y = ghost.y * this.cellSize;
                    
                    // –¢–µ–ª–æ –ø—Ä–∏–≤–∏–¥–µ–Ω–∏—è
                    this.ctx.fillStyle = ghost.color;
                    this.ctx.beginPath();
                    this.ctx.arc(
                        x + this.cellSize/3,
                        y + this.cellSize/2,
                        this.cellSize/3,
                        0,
                        Math.PI * 2
                    );
                    this.ctx.arc(
                        x + 2 * this.cellSize/3,
                        y + this.cellSize/2,
                        this.cellSize/3,
                        0,
                        Math.PI * 2
                    );
                    this.ctx.fillRect(
                        x + this.cellSize/3,
                        y + this.cellSize/2,
                        this.cellSize/3,
                        this.cellSize/2
                    );
                    this.ctx.fill();
                    
                    // –ó–∞–∫—Ä—É–≥–ª–µ–Ω–Ω—ã–π –Ω–∏–∑
                    this.ctx.beginPath();
                    this.ctx.moveTo(x, y + this.cellSize/2);
                    this.ctx.lineTo(x, y + this.cellSize);
                    this.ctx.lineTo(x + this.cellSize, y + this.cellSize);
                    this.ctx.lineTo(x + this.cellSize, y + this.cellSize/2);
                    
                    for (let i = 0; i < 3; i++) {
                        const step = this.cellSize / 6;
                        const xPos = x + step * (i * 2 + 1);
                        const yPos = y + this.cellSize - (i % 2 === 0 ? step : 0);
                        
                        this.ctx.lineTo(xPos, yPos);
                    }
                    
                    this.ctx.lineTo(x + this.cellSize, y + this.cellSize/2);
                    this.ctx.fill();
                    
                    // –ó—Ä–∞—á–∫–∏ (–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∑–≥–ª—è–¥–∞)
                    this.ctx.fillStyle = 'blue';
                    const pupilOffset = this.cellSize/8;
                    let pupilX = 0, pupilY = 0;
                    
                    switch(ghost.direction) {
                        case 'up': pupilY = -pupilOffset; break;
                        case 'down': pupilY = pupilOffset; break;
                        case 'left': pupilX = -pupilOffset; break;
                        case 'right': pupilX = pupilOffset; break;
                    }
                    
                    // –õ–µ–≤—ã–π –∑—Ä–∞—á–æ–∫
                    this.ctx.beginPath();
                    this.ctx.arc(
                        x + this.cellSize/3 + pupilX,
                        y + this.cellSize/3 + pupilY,
                        this.cellSize/10,
                        0,
                        Math.PI * 2
                    );
                    this.ctx.fill();
                    
                    // –ü—Ä–∞–≤—ã–π –∑—Ä–∞—á–æ–∫
                    this.ctx.beginPath();
                    this.ctx.arc(
                        x + 2 * this.cellSize/3 + pupilX,
                        y + this.cellSize/3 + pupilY,
                        this.cellSize/10,
                        0,
                        Math.PI * 2
                    );
                    this.ctx.fill();
                }
            }
            
            /**
             * –ê–Ω–∏–º–∏—Ä—É–µ—Ç —Ä–æ—Ç –ü–∞–∫–º–∞–Ω–∞
             */
            animateMouth() {
                // –ò–∑–º–µ–Ω–µ–Ω–∏–µ —É–≥–ª–∞ —Ä—Ç–∞
                this.pacman.mouthAngle += this.pacman.mouthOpening;
                
                // –°–º–µ–Ω–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—Ç–∫—Ä—ã—Ç–∏—è/–∑–∞–∫—Ä—ã—Ç–∏—è
                if (this.pacman.mouthAngle >= 0.4 || this.pacman.mouthAngle <= 0.05) {
                    this.pacman.mouthOpening = -this.pacman.mouthOpening;
                }
            }
            
            /**
             * –°–æ–∑–¥–∞–µ—Ç —á–∞—Å—Ç–∏—Ü—ã –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤
             * @param {number} x - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ X
             * @param {number} y - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ Y
             */
            createParticles(x, y) {
                const particleCount = 20;
                const baseSize = 3;
                
                for (let i = 0; i < particleCount; i++) {
                    const angle = Math.random() * Math.PI * 2;
                    const speed = 0.5 + Math.random() * 2;
                    
                    this.particles.push({
                        x: x * this.cellSize + this.cellSize/2,
                        y: y * this.cellSize + this.cellSize/2,
                        size: baseSize * (0.5 + Math.random()),
                        speedX: Math.cos(angle) * speed,
                        speedY: Math.sin(angle) * speed,
                        color: '#FFD700',
                        alpha: 1,
                        decay: 0.02 + Math.random() * 0.03
                    });
                }
            }
            
            /**
             * –û–±–Ω–æ–≤–ª—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ —á–∞—Å—Ç–∏—Ü
             */
            updateParticles() {
                // –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–∞—Å—Ç–∏—Ü
                for (let i = this.particles.length - 1; i >= 0; i--) {
                    const particle = this.particles[i];
                    particle.x += particle.speedX;
                    particle.y += particle.speedY;
                    particle.alpha -= particle.decay;
                    
                    if (particle.alpha <= 0) {
                        this.particles.splice(i, 1);
                        continue;
                    }
                    
                    this.ctx.globalAlpha = particle.alpha;
                    this.ctx.fillStyle = particle.color;
                    this.ctx.beginPath();
                    this.ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);
                    this.ctx.fill();
                }
                
                this.ctx.globalAlpha = 1;
            }
            
            /**
             * –°–æ–∑–¥–∞–µ—Ç –∫–æ–Ω—Ñ–µ—Ç—Ç–∏ –¥–ª—è –ø—Ä–∞–∑–¥–Ω–æ–≤–∞–Ω–∏—è
             */
            createConfetti() {
                const confettiCount = 100;
                
                for (let i = 0; i < confettiCount; i++) {
                    const x = Math.random() * this.canvas.width;
                    const y = -20;
                    const size = 5 + Math.random() * 10;
                    const color = `hsl(${Math.random() * 360}, 70%, 50%)`;
                    
                    this.particles.push({
                        x,
                        y,
                        size,
                        speedX: (Math.random() - 0.5) * 6,
                        speedY: 2 + Math.random() * 3,
                        color,
                        alpha: 1,
                        decay: 0.01
                    });
                }
            }
            
            /**
             * –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –ü–∞–∫–º–∞–Ω–∞
             */
            movePacman() {
                // –ü—Ä–æ–≤–µ—Ä–∫–∞, –º–æ–∂–Ω–æ –ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
                if (this.pacman.nextDirection) {
                    const nextPos = this.getFuturePosition(
                        this.pacman.x,
                        this.pacman.y,
                        this.pacman.nextDirection
                    );
                    
                    if (this.isValidMove(nextPos.x, nextPos.y, 'pacman')) {
                        this.pacman.direction = this.pacman.nextDirection;
                        this.pacman.nextDirection = null;
                    }
                }
                
                // –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –≤ —Ç–µ–∫—É—â–µ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏
                const nextPos = this.getFuturePosition(
                    this.pacman.x,
                    this.pacman.y,
                    this.pacman.direction
                );
                
                if (this.isValidMove(nextPos.x, nextPos.y, 'pacman')) {
                    this.pacman.x = nextPos.x;
                    this.pacman.y = nextPos.y;
                    
                    // –¢—É–Ω–Ω–µ–ª–∏
                    if (this.pacman.x < 0) this.pacman.x = this.currentMap[0].length - 1;
                    if (this.pacman.x >= this.currentMap[0].length) this.pacman.x = 0;
                    if (this.pacman.y < 0) this.pacman.y = this.currentMap.length - 1;
                    if (this.pacman.y >= this.currentMap.length) this.pacman.y = 0;
                }
            }
            
            /**
             * –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –ø—Ä–∏–≤–∏–¥–µ–Ω–∏–π
             */
            moveGhosts() {
                this.ghosts.forEach((ghost, index) => {
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Ä–µ–∂–∏–º –ø—Ä–∏–≤–∏–¥–µ–Ω–∏—è
                    this.updateGhostMode();
                    
                    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ü–µ–ª—å –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∂–∏–º–∞
                    let targetX, targetY;
                    
                    if (ghost.mode === 'fleeing') {
                        // –¶–µ–ª—å - –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ –æ—Ç –ü–∞–∫–º–∞–Ω–∞
                        targetX = this.pacman.x + (this.pacman.x - ghost.x) * 2;
                        targetY = this.pacman.y + (this.pacman.y - ghost.y) * 2;
                    } else {
                        // –¶–µ–ª—å - –ü–∞–∫–º–∞–Ω
                        targetX = this.pacman.x;
                        targetY = this.pacman.y;
                    }
                    
                    // –ù–∞—Ö–æ–¥–∏–º –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –ø—É—Ç—å –∫ —Ü–µ–ª–∏
                    const direction = this.findPathToTarget(index, targetX, targetY);
                    
                    // –ü–µ—Ä–µ–º–µ—â–∞–µ–º –ø—Ä–∏–≤–∏–¥–µ–Ω–∏–µ
                    const nextPos = this.getFuturePosition(ghost.x, ghost.y, direction);
                    
                    if (this.isValidMove(nextPos.x, nextPos.y, 'ghost')) {
                        ghost.x = nextPos.x;
                        ghost.y = nextPos.y;
                        ghost.direction = direction;
                        
                        // –¢—É–Ω–Ω–µ–ª–∏
                        if (ghost.x < 0) ghost.x = this.currentMap[0].length - 1;
                        if (ghost.x >= this.currentMap[0].length) ghost.x = 0;
                        if (ghost.y < 0) ghost.y = this.currentMap.length - 1;
                        if (ghost.y >= this.currentMap.length) ghost.y = 0;
                    }
                });
            }
            
            /**
             * –û–±–Ω–æ–≤–ª—è–µ—Ç –∏–≥—Ä—É
             */
            update() {
                this.movePacman();
                this.moveGhosts();
                this.checkCollisions();
                this.checkLevelCompletion();
            }
            
            /**
             * –û—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç –∏–≥—Ä—É
             */
            draw() {
                // –û—á–∏—Å—Ç–∫–∞ —Ö–æ–ª—Å—Ç–∞
                this.ctx.fillStyle = 'black';
                this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
                
                // –†–∏—Å—É–µ–º –∫–∞—Ä—Ç—É
                this.drawMap();
                
                // –†–∏—Å—É–µ–º –ü–∞–∫–º–∞–Ω–∞
                this.drawPacman();
                
                // –†–∏—Å—É–µ–º –ø—Ä–∏–≤–∏–¥–µ–Ω–∏–π
                this.drawGhosts();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —á–∞—Å—Ç–∏—Ü—ã
                this.updateParticles();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –º–∏–Ω–∏-–∫–∞—Ä—Ç—É
                this.updateMiniMap();
                
                // –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø—É—Ç–∏ (–¥–ª—è –æ–±—É—á–µ–Ω–∏—è)
                if (this.isVisualizingPath) {
                    this.visualizePathfinding();
                }
            }
            
            /**
             * –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º –ø–æ–∏—Å–∫–∞ –ø—É—Ç–∏
             */
            visualizePathfinding() {
                // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ü–µ–ª–µ–≤—ã–µ —Ç–æ—á–∫–∏ –¥–ª—è –ø—Ä–∏–≤–∏–¥–µ–Ω–∏–π
                this.ghosts.forEach((ghost, index) => {
                    let targetX, targetY;
                    
                    if (ghost.mode === 'fleeing') {
                        targetX = this.pacman.x + (this.pacman.x - ghost.x) * 2;
                        targetY = this.pacman.y + (this.pacman.y - ghost.y) * 2;
                    } else {
                        targetX = this.pacman.x;
                        targetY = this.pacman.y;
                    }
                    
                    // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º —Ü–µ–ª–µ–≤—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
                    targetX = Math.max(0, Math.min(targetX, this.currentMap[0].length - 1));
                    targetY = Math.max(0, Math.min(targetY, this.currentMap.length - 1));
                    
                    this.ctx.strokeStyle = 'rgba(255, 255, 255, 0.5)';
                    this.ctx.lineWidth = 2;
                    this.ctx.beginPath();
                    this.ctx.arc(
                        targetX * this.cellSize + this.cellSize/2,
                        targetY * this.cellSize + this.cellSize/2,
                        this.cellSize/3,
                        0,
                        Math.PI * 2
                    );
                    this.ctx.stroke();
                });
            }
            
            /**
             * –ó–∞–ø—É—Å–∫–∞–µ—Ç –∏–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —à–∞–≥–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
             */
            startGameLoop() {
                if (this.animationFrameId) {
                    cancelAnimationFrame(this.animationFrameId);
                }
                
                const FIXED_TIMESTEP = 16.67; // ~60 FPS
                let accumulator = 0;
                let lastFpsTime = performance.now();
                let frames = 0;
                
                const gameLoop = (timestamp) => {
                    // –í—ã—á–∏—Å–ª—è–µ–º deltaTime –¥–ª—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —á–∞—Å—Ç–æ—Ç—ã –∫–∞–¥—Ä–æ–≤
                    const deltaTime = timestamp - this.lastTimestamp;
                    accumulator += deltaTime;
                    
                    // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Ñ–∏–∑–∏–∫—É —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —à–∞–≥–æ–º
                    while (accumulator >= FIXED_TIMESTEP) {
                        this.update();
                        accumulator -= FIXED_TIMESTEP;
                    }
                    
                // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –∏–≥—Ä—ã
                this.draw();
                this.animateMouth();
                    
                    this.lastTimestamp = timestamp;
                    this.animationFrameId = requestAnimationFrame(gameLoop);

                    // FPS
                    frames++;
                    if (timestamp - lastFpsTime >= 500) {
                        const fps = Math.round((frames * 1000) / (timestamp - lastFpsTime));
                        const fpsEl = document.getElementById('debug-fps');
                        if (fpsEl) fpsEl.textContent = `${fps}`;
                        frames = 0;
                        lastFpsTime = timestamp;
                    }
                };
                
                this.isRunning = true;
                this.lastTimestamp = performance.now();
                this.animationFrameId = requestAnimationFrame(gameLoop);
                
                // –ó–∞–ø—É—Å–∫–∞–µ–º –º—É–∑—ã–∫—É
                if (this.isSoundEnabled) {
                    this.ensureAudioContext();
                    this.sounds.music.play(this);
                }
            }
            
            /**
             * –ü—Ä–∏–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏–≥—Ä—É
             */
            pauseGame() {
                this.isRunning = false;
                if (this.animationFrameId) {
                    cancelAnimationFrame(this.animationFrameId);
                    this.animationFrameId = null;
                }
                
                // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º—É–∑—ã–∫—É
                if (this.isSoundEnabled) {
                    this.sounds.music.stop(this);
                }
            }
            
            /**
             * –í–æ–∑–æ–±–Ω–æ–≤–ª—è–µ—Ç –∏–≥—Ä—É
             */
            resumeGame() {
                if (!this.isRunning) {
                    this.startGameLoop();
                }
            }
            
            /**
             * –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞–∂–∞—Ç–∏–µ –∫–ª–∞–≤–∏—à –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ü–∞–∫–º–∞–Ω–æ–º
             * @param {KeyboardEvent} e - –°–æ–±—ã—Ç–∏–µ –Ω–∞–∂–∞—Ç–∏—è –∫–ª–∞–≤–∏—à–∏
             */
            handleKey(e) {
                if (!this.isRunning) return;
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è
                switch(e.key) {
                    case 'ArrowUp':
                    case 'w':
                    case 'W':
                        this.pacman.nextDirection = 'up';
                        e.preventDefault();
                        break;
                    case 'ArrowDown':
                    case 's':
                    case 'S':
                        this.pacman.nextDirection = 'down';
                        e.preventDefault();
                        break;
                    case 'ArrowLeft':
                    case 'a':
                    case 'A':
                        this.pacman.nextDirection = 'left';
                        e.preventDefault();
                        break;
                    case 'ArrowRight':
                    case 'd':
                    case 'D':
                        this.pacman.nextDirection = 'right';
                        e.preventDefault();
                        break;
                    case 'l':
                        if (e.ctrlKey) {
                            this.openLesson(1);
                            e.preventDefault();
                        }
                        break;
                }
            }
            
            /**
             * –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–ª–∏–∫ –ø–æ –∏–≥—Ä–æ–≤–æ–º—É –ø–æ–ª—é –≤ —Ä–µ–∂–∏–º–µ –æ–±—É—á–µ–Ω–∏—è
             * @param {MouseEvent} e - –°–æ–±—ã—Ç–∏–µ –∫–ª–∏–∫–∞
             */
            handleCanvasClick(e) {
                if (!this.isLearningMode) return;
                
                const rect = this.canvas.getBoundingClientRect();
                const x = Math.floor((e.clientX - rect.left) / this.cellSize);
                const y = Math.floor((e.clientY - rect.top) / this.cellSize);
                
                let explanation = '';
                if (x === this.pacman.x && y === this.pacman.y) {
                    explanation = '–≠—Ç–æ –ü–∞–∫–º–∞–Ω! –£–ø—Ä–∞–≤–ª—è–µ—Ç –∏–≥—Ä–æ–∫. –î–≤–∏–∂–µ—Ç—Å—è –ø–æ –ª–∞–±–∏—Ä–∏–Ω—Ç—É, —Å–æ–±–∏—Ä–∞—è –µ–¥—É –∏ –∏–∑–±–µ–≥–∞—è –ø—Ä–∏–≤–∏–¥–µ–Ω–∏–π.';
                } else {
                    for (let i = 0; i < this.ghosts.length; i++) {
                        if (x === this.ghosts[i].x && y === this.ghosts[i].y) {
                            explanation = '–≠—Ç–æ –ø—Ä–∏–≤–∏–¥–µ–Ω–∏–µ! –ò–º–µ–µ—Ç —Ç—Ä–∏ —Ä–µ–∂–∏–º–∞: –±–ª—É–∂–¥–∞–Ω–∏–µ, –ø—Ä–µ—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –∏ –±–µ–≥—Å—Ç–≤–æ (–ø—Ä–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —Å—É–ø–µ—Ä-–µ–¥—ã).';
                            break;
                        }
                    }
                }
                
                if (!explanation && this.currentMap[y] && this.currentMap[y][x] === 2) {
                    explanation = '–û–±—ã—á–Ω–∞—è –µ–¥–∞. –î–∞–µ—Ç 10 –æ—á–∫–æ–≤ –ø—Ä–∏ —Å–±–æ—Ä–µ.';
                } else if (!explanation && this.currentMap[y] && this.currentMap[y][x] === 3) {
                    explanation = '–°—É–ø–µ—Ä-–µ–¥–∞. –î–∞–µ—Ç 50 –æ—á–∫–æ–≤ –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç —Ä–µ–∂–∏–º –æ—Ö–æ—Ç—ã –Ω–∞ 10 —Å–µ–∫—É–Ω–¥.';
                } else if (!explanation && this.currentMap[y] && this.currentMap[y][x] === 0) {
                    explanation = '–°—Ç–µ–Ω–∞. –ü–∞–∫–º–∞–Ω –∏ –ø—Ä–∏–≤–∏–¥–µ–Ω–∏–µ –Ω–µ –º–æ–≥—É—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç—å —Å–∫–≤–æ–∑—å —Å—Ç–µ–Ω—ã.';
                }
                
                if (explanation) {
                    document.getElementById('learning-content').textContent = explanation;
                    document.getElementById('learning-mode').style.display = 'block';
                }
            }
            
            /**
             * –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –º—ã—à–∏ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ —É—Ä–æ–≤–Ω–µ–π —Å debounce
             * @param {MouseEvent} e - –°–æ–±—ã—Ç–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è –º—ã—à–∏
             */
            handleEditorMouseMove(e) {
                if (this.isDrawing) {
                    if (!this.editorMoveTimeout) {
                        this.editorMoveTimeout = setTimeout(() => {
                            this.updateEditorCell(e);
                            this.editorMoveTimeout = null;
                        }, 50);
                    }
                }
            }
            
            /**
             * –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
             */
            setupEventListeners() {
                // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∞–≤–∏—à
                document.addEventListener('keydown', (e) => this.handleKey(e));
                // –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏ –ø–∞—É–∑—ã
                document.addEventListener('keydown', (e) => {
                    if (e.code === 'Space') {
                        e.preventDefault();
                        const btn = document.getElementById('pause-toggle');
                        if (this.isRunning) {
                            this.pauseGame();
                            if (btn) btn.innerHTML = `<span>‚ñ∂Ô∏è</span> –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å`;
                        } else {
                            if (btn) btn.innerHTML = `<span>‚è∏Ô∏è</span> –ü–∞—É–∑–∞`;
                            this.resumeGame();
                        }
                    }
                });
                
                // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞ –ø–æ —Ö–æ–ª—Å—Ç—É
                this.canvas.addEventListener('click', (e) => this.handleCanvasClick(e));
                
                // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–π
                document.getElementById('mode-toggle').addEventListener('click', () => {
                    this.isLearningMode = !this.isLearningMode;
                    const button = document.getElementById('mode-toggle');
                    button.innerHTML = `<span>üéì</span> –†–µ–∂–∏–º –æ–±—É—á–µ–Ω–∏—è: ${this.isLearningMode ? '–í–∫–ª' : '–í—ã–∫–ª'}`;
                    this.showNotification(`–†–µ–∂–∏–º –æ–±—É—á–µ–Ω–∏—è: ${this.isLearningMode ? '–≤–∫–ª—é—á–µ–Ω' : '–≤—ã–∫–ª—é—á–µ–Ω'}`);
                });
                
                document.getElementById('theme-toggle').addEventListener('click', () => this.toggleTheme());
                document.getElementById('achievements-btn').addEventListener('click', () => this.showAchievementsPanel());
                
                // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–≤—É–∫–æ–º
                document.getElementById('sound-toggle').addEventListener('click', () => {
                    this.isSoundEnabled = !this.isSoundEnabled;
                    const btn = document.getElementById('sound-toggle');
                    btn.innerHTML = `<span>${this.isSoundEnabled ? 'üîä' : 'üîá'}</span> –ó–≤—É–∫: ${this.isSoundEnabled ? '–í–∫–ª' : '–í—ã–∫–ª'}`;
                    if (!this.isSoundEnabled) {
                        this.sounds.music.stop(this);
                    } else if (this.isRunning) {
                        this.ensureAudioContext();
                        this.sounds.music.play(this);
                    }
                });
                
                // –ü–∞—É–∑–∞
                document.getElementById('pause-toggle').addEventListener('click', () => {
                    if (this.isRunning) {
                        this.pauseGame();
                        document.getElementById('pause-toggle').innerHTML = `<span>‚ñ∂Ô∏è</span> –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å`;
                    } else {
                        document.getElementById('pause-toggle').innerHTML = `<span>‚è∏Ô∏è</span> –ü–∞—É–∑–∞`;
                        this.resumeGame();
                    }
                });
                
                // –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
                document.getElementById('restart-game').addEventListener('click', () => this.restartGame());
                document.getElementById('close-game-over').addEventListener('click', () => {
                    document.getElementById('game-over').style.display = 'none';
                    this.resumeGame();
                });
                
                document.getElementById('next-level').addEventListener('click', () => {
                    document.getElementById('level-complete').style.display = 'none';
                    this.resumeGame();
                });
                
                // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–∞–Ω–µ–ª–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
                document.getElementById('achievements-close').addEventListener('click', () => {
                    document.getElementById('achievements-panel').classList.remove('open');
                });
                
                // –†–µ–¥–∞–∫—Ç–æ—Ä —É—Ä–æ–≤–Ω–µ–π
                document.getElementById('level-editor-toggle').addEventListener('click', () => this.openLevelEditor());
                document.getElementById('cancel-editor').addEventListener('click', () => this.closeLevelEditor());
                document.getElementById('apply-editor').addEventListener('click', () => this.applyLevelChanges());
                document.getElementById('save-level').addEventListener('click', () => this.applyLevelChanges());
                
                // –û–±—Ä–∞–±–æ—Ç–∫–∞ —É—Ä–æ–∫–æ–≤
                document.getElementById('lesson-close').addEventListener('click', () => this.closeLesson());
                document.getElementById('lesson-prev').addEventListener('click', () => this.previousLessonStep());
                document.getElementById('lesson-next').addEventListener('click', () => this.nextLessonStep());
                
                // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ—Å—Ç–æ–≤
                document.getElementById('test-close').addEventListener('click', () => this.closeTest());
                
                // –ü—Ä–æ–≥—Ä–µ—Å—Å
                document.getElementById('save-progress').addEventListener('click', () => this.saveProgress());
                document.getElementById('load-progress').addEventListener('click', () => {
                    if (this.loadProgress()) {
                        this.showNotification('–ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–≥—Ä—É–∂–µ–Ω');
                    } else {
                        this.showNotification('–ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞', 'error');
                    }
                });

                // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∫–æ–Ω—Å–æ–ª—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞
                this.setupDevConsole();
            }
            
            /**
             * –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –∫–æ–Ω—Å–æ–ª—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
             */
            setupDevConsole() {
                const gameInstance = this;
                window.game = {
                    /**
                     * –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å–∫–æ—Ä–æ—Å—Ç—å –∏–≥—Ä—ã
                     * @param {number} [amount=20] - –ù–∞ —Å–∫–æ–ª—å–∫–æ —É–º–µ–Ω—å—à–∏—Ç—å –∑–∞–¥–µ—Ä–∂–∫—É
                     */
                    increaseSpeed: function(amount = 20) {
                        gameInstance.gameSpeed = Math.max(50, gameInstance.gameSpeed - amount);
                        gameInstance.codeModified = true;
                        gameInstance.checkAchievements();
                        gameInstance.showNotification('–°–∫–æ—Ä–æ—Å—Ç—å –∏–≥—Ä—ã —É–≤–µ–ª–∏—á–µ–Ω–∞!');
                    },
                    
                    /**
                     * –î–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤–æ–µ –ø—Ä–∏–≤–∏–¥–µ–Ω–∏–µ
                     */
                    addGhost: function() {
                        // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–µ –ø—Ä–∏–≤–∏–¥–µ–Ω–∏–µ
                        const colors = ['red', 'pink', 'cyan', 'orange', 'purple', 'green'];
                        gameInstance.ghosts.push({
                            x: 10,
                            y: 8,
                            direction: ['up', 'down', 'left', 'right'][Math.floor(Math.random() * 4)],
                            mode: 'wandering',
                            speed: 0.5 + Math.random() * 0.5,
                            color: colors[Math.floor(Math.random() * colors.length)],
                            fearTimer: null
                        });
                        
                        gameInstance.codeModified = true;
                        gameInstance.checkAchievements();
                        gameInstance.showNotification('–î–æ–±–∞–≤–ª–µ–Ω–æ –Ω–æ–≤–æ–µ –ø—Ä–∏–≤–∏–¥–µ–Ω–∏–µ!');
                    },
                    
                    /**
                     * –¢–µ–ª–µ–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –ü–∞–∫–º–∞–Ω–∞ –≤ —É–∫–∞–∑–∞–Ω–Ω—É—é –ø–æ–∑–∏—Ü–∏—é
                     * @param {number} x - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ X
                     * @param {number} y - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ Y
                     */
                    teleport: function(x, y) {
                        gameInstance.pacman.x = x;
                        gameInstance.pacman.y = y;
                        gameInstance.codeModified = true;
                        gameInstance.checkAchievements();
                        gameInstance.showNotification(`–ü–∞–∫–º–∞–Ω —Ç–µ–ª–µ–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –≤ (${x}, ${y})`);
                    },
                    
                    /**
                     * –ü–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç —Ä–µ–∂–∏–º –æ–±—É—á–µ–Ω–∏—è
                     */
                    toggleLearningMode: function() {
                        gameInstance.isLearningMode = !gameInstance.isLearningMode;
                        const button = document.getElementById('mode-toggle');
                        if (button) {
                            button.innerHTML = `<span>üéì</span> –†–µ–∂–∏–º –æ–±—É—á–µ–Ω–∏—è: ${gameInstance.isLearningMode ? '–í–∫–ª' : '–í—ã–∫–ª'}`;
                        }
                        gameInstance.showNotification(`–†–µ–∂–∏–º –æ–±—É—á–µ–Ω–∏—è: ${gameInstance.isLearningMode ? '–≤–∫–ª—é—á–µ–Ω' : '–≤—ã–∫–ª—é—á–µ–Ω'}`);
                    },
                    
                    /**
                     * –í–∫–ª—é—á–∞–µ—Ç –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤
                     */
                    enablePathVisualization: function() {
                        gameInstance.isVisualizingPath = true;
                        gameInstance.showNotification('–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –≤–∫–ª—é—á–µ–Ω–∞');
                    },
                    
                    /**
                     * –û—Ç–∫–ª—é—á–∞–µ—Ç –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤
                     */
                    disablePathVisualization: function() {
                        gameInstance.isVisualizingPath = false;
                        gameInstance.showNotification('–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –≤—ã–∫–ª—é—á–µ–Ω–∞');
                    }
                };
            }
            
            /**
             * –ó–∞–≥—Ä—É–∂–∞–µ—Ç —É—Ä–æ–≤–Ω–∏ –∏–≥—Ä—ã
             * @returns {Array} –ú–∞—Å—Å–∏–≤ —É—Ä–æ–≤–Ω–µ–π
             */
            loadLevels() {
                return [
                    // –£—Ä–æ–≤–µ–Ω—å 1: –ë–∞–∑–æ–≤—ã–π –ª–∞–±–∏—Ä–∏–Ω—Ç
                    [
                        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                        [0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0],
                        [0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],
                        [0,1,0,1,1,1,0,1,1,1,1,1,1,0,1,1,1,0,1,0],
                        [0,1,0,1,0,0,0,1,0,0,0,0,1,0,0,0,1,0,1,0],
                        [0,1,0,1,0,1,1,1,0,1,1,0,1,1,1,0,1,0,1,0],
                        [0,1,0,1,0,1,0,0,0,1,1,0,0,0,1,0,1,0,1,0],
                        [0,1,0,1,0,1,0,1,1,1,1,1,1,0,1,0,1,0,1,0],
                        [0,1,0,1,0,1,0,1,0,0,0,0,1,0,1,0,1,0,1,0],
                        [0,1,0,1,0,1,0,1,0,1,1,0,1,0,1,0,1,0,1,0],
                        [0,1,0,1,0,1,0,1,0,1,1,0,1,0,1,0,1,0,1,0],
                        [0,1,0,1,0,1,0,1,0,0,0,0,1,0,1,0,1,0,1,0],
                        [0,1,0,1,0,1,0,1,1,1,1,1,1,0,1,0,1,0,1,0],
                        [0,1,0,1,0,1,0,0,0,1,1,0,0,0,1,0,1,0,1,0],
                        [0,1,0,1,0,1,1,1,0,1,1,0,1,1,1,0,1,0,1,0],
                        [0,1,0,1,0,0,0,1,0,0,0,0,1,0,0,0,1,0,1,0],
                        [0,1,0,1,1,1,0,1,1,1,1,1,1,0,1,1,1,0,1,0],
                        [0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],
                        [0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0],
                        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
                    ],
                    
                    // –£—Ä–æ–≤–µ–Ω—å 2: –£—Å–ª–æ–∂–Ω–µ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
                    [
                        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                        [0,1,1,1,0,1,1,1,0,1,1,0,1,1,1,0,1,1,1,0],
                        [0,1,0,1,0,1,0,1,0,0,0,0,1,0,1,0,1,0,1,0],
                        [0,1,0,1,0,1,0,1,0,1,1,0,1,0,1,0,1,0,1,0],
                        [0,1,0,1,0,1,0,1,0,1,1,0,1,0,1,0,1,0,1,0],
                        [0,1,0,1,0,1,0,1,0,0,0,0,1,0,1,0,1,0,1,0],
                        [0,1,1,1,0,1,1,1,0,1,1,0,1,1,1,0,1,1,1,0],
                        [0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0],
                        [0,1,1,1,0,1,1,1,0,1,1,0,1,1,1,0,1,1,1,0],
                        [0,1,0,1,0,1,0,1,0,0,0,0,1,0,1,0,1,0,1,0],
                        [0,1,0,1,0,1,0,1,0,1,1,0,1,0,1,0,1,0,1,0],
                        [0,1,0,1,0,1,0,1,0,1,1,0,1,0,1,0,1,0,1,0],
                        [0,1,0,1,0,1,0,1,0,0,0,0,1,0,1,0,1,0,1,0],
                        [0,1,1,1,0,1,1,1,0,1,1,0,1,1,1,0,1,1,1,0],
                        [0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0],
                        [0,1,1,1,0,1,1,1,0,1,1,0,1,1,1,0,1,1,1,0],
                        [0,1,0,1,0,1,0,1,0,0,0,0,1,0,1,0,1,0,1,0],
                        [0,1,0,1,0,1,0,1,0,1,1,0,1,0,1,0,1,0,1,0],
                        [0,1,0,1,0,1,0,1,0,1,1,0,1,0,1,0,1,0,1,0],
                        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
                    ],
                    
                    // –£—Ä–æ–≤–µ–Ω—å 3: –õ–∞–±–∏—Ä–∏–Ω—Ç —Å —Ç—É–ø–∏–∫–∞–º–∏
                    [
                        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                        [0,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,0],
                        [0,1,0,0,1,0,0,0,1,0,1,0,0,0,1,0,0,0,1,0],
                        [0,2,0,0,1,0,0,0,1,0,1,0,0,0,1,0,0,0,2,0],
                        [0,1,0,0,1,0,0,0,1,0,1,0,0,0,1,0,0,0,1,0],
                        [0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0],
                        [0,1,0,0,1,0,1,0,0,0,0,0,1,0,1,0,0,0,1,0],
                        [0,1,0,0,1,0,1,0,0,0,0,0,1,0,1,0,0,0,1,0],
                        [0,1,1,1,1,0,1,1,1,0,1,1,1,0,1,1,1,1,1,0],
                        [0,0,0,0,1,0,0,0,2,0,2,0,0,0,1,0,0,0,0,0],
                        [0,0,0,0,1,0,2,0,0,2,0,0,2,0,1,0,0,0,0,0],
                        [0,1,1,1,1,0,1,1,1,0,1,1,1,0,1,1,1,1,1,0],
                        [0,1,0,0,1,0,1,0,0,0,0,0,1,0,1,0,0,0,1,0],
                        [0,1,0,0,1,0,1,0,0,0,0,0,1,0,1,0,0,0,1,0],
                        [0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0],
                        [0,1,0,0,1,0,0,0,1,0,1,0,0,0,1,0,0,0,1,0],
                        [0,3,1,0,1,1,1,1,1,0,1,1,1,1,1,0,1,3,1,0],
                        [0,1,0,0,1,0,0,0,1,0,1,0,0,0,1,0,0,0,1,0],
                        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
                    ],
                    
                    // –£—Ä–æ–≤–µ–Ω—å 4: –ó–≤–µ–∑–¥–Ω—ã–π –ª–∞–±–∏—Ä–∏–Ω—Ç
                    [
                        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                        [0,1,1,1,0,1,1,1,0,1,1,0,1,1,1,0,1,1,1,0],
                        [0,1,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,1,0],
                        [0,2,0,0,0,1,0,0,2,3,3,2,0,0,1,0,0,0,2,0],
                        [0,1,0,0,0,1,0,0,3,2,2,3,0,0,1,0,0,0,1,0],
                        [0,1,0,1,0,1,0,0,2,3,3,2,0,0,1,0,1,0,1,0],
                        [0,1,1,1,0,1,1,0,0,1,1,0,0,1,1,0,1,1,1,0],
                        [0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0],
                        [0,1,1,1,0,1,1,1,0,1,1,0,1,1,1,0,1,1,1,0],
                        [0,1,0,1,0,1,0,1,0,0,0,0,1,0,1,0,1,0,1,0],
                        [0,1,0,1,0,1,0,1,0,1,1,0,1,0,1,0,1,0,1,0],
                        [0,1,0,1,0,1,0,1,0,1,1,0,1,0,1,0,1,0,1,0],
                        [0,1,0,1,0,1,0,1,0,0,0,0,1,0,1,0,1,0,1,0],
                        [0,1,1,1,0,1,1,1,0,1,1,0,1,1,1,0,1,1,1,0],
                        [0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0],
                        [0,1,1,1,0,1,1,1,0,1,1,0,1,1,1,0,1,1,1,0],
                        [0,1,0,1,0,1,0,1,0,0,0,0,1,0,1,0,1,0,1,0],
                        [0,1,0,1,0,1,0,1,0,1,1,0,1,0,1,0,1,0,1,0],
                        [0,1,0,1,0,1,0,1,0,1,1,0,1,0,1,0,1,0,1,0],
                        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
                    ],
                    
                    // –£—Ä–æ–≤–µ–Ω—å 5: –°–ø–∏—Ä–∞–ª—å–Ω—ã–π –ª–∞–±–∏—Ä–∏–Ω—Ç
                    [
                        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                        [0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0],
                        [0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],
                        [0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0],
                        [0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0],
                        [0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0],
                        [0,1,0,1,0,1,0,0,0,0,0,0,0,0,1,0,1,0,1,0],
                        [0,1,0,1,0,1,0,1,1,1,1,1,1,0,1,0,1,0,1,0],
                        [0,1,0,1,0,1,0,1,0,0,0,0,1,0,1,0,1,0,1,0],
                        [0,1,0,1,0,1,0,1,0,1,1,0,1,0,1,0,1,0,1,0],
                        [0,1,0,1,0,1,0,1,0,1,1,0,1,0,1,0,1,0,1,0],
                        [0,1,0,1,0,1,0,1,0,0,0,0,1,0,1,0,1,0,1,0],
                        [0,1,0,1,0,1,0,1,1,1,1,1,1,0,1,0,1,0,1,0],
                        [0,1,0,1,0,1,0,0,0,0,0,0,0,0,1,0,1,0,1,0],
                        [0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0],
                        [0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0],
                        [0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0],
                        [0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],
                        [0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0],
                        [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
                    ]
                ];
            }
            
            /**
             * –ó–∞–≥—Ä—É–∂–∞–µ—Ç —É—á–µ–±–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã
             * @returns {Array} –ú–∞—Å—Å–∏–≤ —É—Ä–æ–∫–æ–≤
             */
            loadLessons() {
                return [
                    {
                        id: 1,
                        title: "–û—Å–Ω–æ–≤—ã –∏–≥—Ä–æ–≤–æ–≥–æ —Ü–∏–∫–ª–∞",
                        description: "–£–∑–Ω–∞–π—Ç–µ, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –∏–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª –∏ –ø–æ—á–µ–º—É –æ–Ω –≤–∞–∂–µ–Ω –¥–ª—è 2D-–∏–≥—Ä.",
                        steps: [
                            {
                                highlight: "gameLoop",
                                explanation: "–ú–µ—Ç–æ–¥ gameLoop - —Å–µ—Ä–¥—Ü–µ –ª—é–±–æ–π –∏–≥—Ä—ã. –û–Ω –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã.",
                                codeSnippet: `startGameLoop() {
    if (!this.isRunning) return;
    
    const FIXED_TIMESTEP = 16.67; // ~60 FPS
    let accumulator = 0;
    
    const gameLoop = (timestamp) => {
        // –í—ã—á–∏—Å–ª—è–µ–º deltaTime –¥–ª—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —á–∞—Å—Ç–æ—Ç—ã –∫–∞–¥—Ä–æ–≤
        const deltaTime = timestamp - this.lastTimestamp;
        accumulator += deltaTime;
        
        // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Ñ–∏–∑–∏–∫—É —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —à–∞–≥–æ–º
        while (accumulator >= FIXED_TIMESTEP) {
            this.update();
            accumulator -= FIXED_TIMESTEP;
        }
        
        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –∏–≥—Ä—ã
        this.draw();
        this.animateMouth();
        this.updateParticles();
        
        this.lastTimestamp = timestamp;
        this.animationFrameId = requestAnimationFrame(gameLoop);
    };
    
    this.lastTimestamp = performance.now();
    this.animationFrameId = requestAnimationFrame(gameLoop);
}`
                            },
                            {
                                highlight: "update()",
                                explanation: "–ú–µ—Ç–æ–¥ update() –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ª–æ–≥–∏–∫—É –∏–≥—Ä—ã: –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤, –ø—Ä–æ–≤–µ—Ä–∫—É –∫–æ–ª–ª–∏–∑–∏–π –∏ —Ç.–¥.",
                                codeSnippet: `update() {
    this.movePacman();
    this.moveGhosts();
    this.checkCollisions();
    this.checkLevelCompletion();
}`
                            },
                            {
                                highlight: "draw()",
                                explanation: "–ú–µ—Ç–æ–¥ draw() –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –æ—Ç—Ä–∏—Å–æ–≤–∫—É –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ —ç–∫—Ä–∞–Ω–µ.",
                                codeSnippet: `draw() {
    // –û—á–∏—Å—Ç–∫–∞ —Ö–æ–ª—Å—Ç–∞
    this.ctx.fillStyle = 'black';
    this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
    
    // –†–∏—Å—É–µ–º –∫–∞—Ä—Ç—É
    this.drawMap();
    
    // –†–∏—Å—É–µ–º –ü–∞–∫–º–∞–Ω–∞
    this.drawPacman();
    
    // –†–∏—Å—É–µ–º –ø—Ä–∏–≤–∏–¥–µ–Ω–∏–π
    this.drawGhosts();
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –º–∏–Ω–∏-–∫–∞—Ä—Ç—É
    this.updateMiniMap();
}`
                            }
                        ]
                    },
                    {
                        id: 2,
                        title: "–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞",
                        description: "–ò–∑—É—á–∏—Ç–µ, –∫–∞–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥ –≤ –∏–≥—Ä–∞—Ö –Ω–∞ JavaScript.",
                        steps: [
                            {
                                highlight: "handleKey",
                                explanation: "–ú–µ—Ç–æ–¥ handleKey –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞–∂–∞—Ç–∏—è –∫–ª–∞–≤–∏—à –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ü–∞–∫–º–∞–Ω–æ–º.",
                                codeSnippet: `handleKey(e) {
    if (!this.isRunning) return;
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è
    switch(e.key) {
        case 'ArrowUp':
            this.pacman.nextDirection = 'up';
            e.preventDefault();
            break;
        case 'ArrowDown':
            this.pacman.nextDirection = 'down';
            e.preventDefault();
            break;
        case 'ArrowLeft':
            this.pacman.nextDirection = 'left';
            e.preventDefault();
            break;
        case 'ArrowRight':
            this.pacman.nextDirection = 'right';
            e.preventDefault();
            break;
    }
}`
                            },
                            {
                                highlight: "movePacman",
                                explanation: "–ú–µ—Ç–æ–¥ movePacman –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –ü–∞–∫–º–∞–Ω–∞ —Å —É—á–µ—Ç–æ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ —Å—Ç–µ–Ω—É.",
                                codeSnippet: `movePacman() {
    // –ü—Ä–æ–≤–µ—Ä–∫–∞, –º–æ–∂–Ω–æ –ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
    if (this.pacman.nextDirection) {
        const nextPos = this.getFuturePosition(
            this.pacman.x,
            this.pacman.y,
            this.pacman.nextDirection
        );
        
        if (this.isValidMove(nextPos.x, nextPos.y, 'pacman')) {
            this.pacman.direction = this.pacman.nextDirection;
            this.pacman.nextDirection = null;
        }
    }
    
    // –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –≤ —Ç–µ–∫—É—â–µ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏
    const nextPos = this.getFuturePosition(
        this.pacman.x,
        this.pacman.y,
        this.pacman.direction
    );
    
    if (this.isValidMove(nextPos.x, nextPos.y, 'pacman')) {
        this.pacman.x = nextPos.x;
        this.pacman.y = nextPos.y;
    }
}`

                    },
                    {
                        id: 3,
                        title: "–ò–ò –ø—Ä–∏–≤–∏–¥–µ–Ω–∏—è",
                        description: "–ò–∑—É—á–∏—Ç–µ, –∫–∞–∫ —Å–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Å—Ç–æ–π, –Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç –¥–ª—è –ø—Ä–∏–≤–∏–¥–µ–Ω–∏–π.",
                        steps: [
                            {
                                highlight: "updateGhostMode",
                                explanation: "–ú–µ—Ç–æ–¥ updateGhostMode –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–µ–∫—É—â–∏–π —Ä–µ–∂–∏–º –ø—Ä–∏–≤–∏–¥–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –¥–æ –ü–∞–∫–º–∞–Ω–∞.",
                                codeSnippet: `updateGhostMode() {
    this.ghosts.forEach((ghost, index) => {
        const dx = this.pacman.x - ghost.x;
        const dy = this.pacman.y - ghost.y;
        const distance = Math.sqrt(dx * dx + dy * dy);
        const chaseThreshold = this.difficulty === 'easy' ? 4 : this.difficulty === 'hard' ? 7 : 5;
        
        // –†–µ–∂–∏–º —Å—É–ø–µ—Ä-–µ–¥—ã –∞–∫—Ç–∏–≤–µ–Ω
        if (this.powerMode) {
            ghost.mode = 'fleeing';
            ghost.color = 'blue';
        } 
        // –ë–ª–∏–∑–∫–æ –∫ –ü–∞–∫–º–∞–Ω—É
        else if (distance < chaseThreshold) {
            ghost.mode = 'chasing';
            ghost.color = ['red', 'pink', 'cyan', 'orange'][index];
        }
        // –î–∞–ª–µ–∫–æ –æ—Ç –ü–∞–∫–º–∞–Ω–∞
        else {
            ghost.mode = 'wandering';
            ghost.color = ['red', 'pink', 'cyan', 'orange'][index];
        }
    });
}`
                            },
                            {
                                highlight: "findPathToTarget",
                                explanation: "–ú–µ—Ç–æ–¥ findPathToTarget –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ—Å—Ç–æ–π –∞–ª–≥–æ—Ä–∏—Ç–º –ø–æ–∏—Å–∫–∞ –ø—É—Ç–∏ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–≤–∏–∂–µ–Ω–∏—è.",
                                codeSnippet: `findPathToTarget(ghostIndex, targetX, targetY) {
    const ghost = this.ghosts[ghostIndex];
    const directions = ['up', 'down', 'left', 'right'];
    let bestDirection = null;
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–µ–∂–∏–º –ø—Ä–∏–≤–∏–¥–µ–Ω–∏—è –¥–ª—è –≤—ã–±–æ—Ä–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
    const isFleeing = this.ghosts[ghostIndex].mode === 'fleeing';
    let bestScore = isFleeing ? -Infinity : Infinity;
    
    for (const direction of directions) {
        const nextPos = this.getFuturePosition(ghost.x, ghost.y, direction);
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ —Ö–æ–¥–∞
        if (!this.isValidMove(nextPos.x, nextPos.y, 'ghost') ||
            direction === this.getOppositeDirection(ghost.direction)) {
            continue;
        }
        
        // –†–∞—Å—á–µ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –¥–æ —Ü–µ–ª–∏
        const dx = targetX - nextPos.x;
        const dy = targetY - nextPos.y;
        const distance = dx * dx + dy * dy; // –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–≤–∞–¥—Ä–∞—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
        
        if (!isFleeing && distance < bestScore) {
            bestScore = distance;
            bestDirection = direction;
        }
        if (isFleeing && distance > bestScore) {
            bestScore = distance;
            bestDirection = direction;
        }
    }
    
    // –ï—Å–ª–∏ –Ω–µ—Ç –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π, –æ—Å—Ç–∞–µ–º—Å—è –Ω–∞ –º–µ—Å—Ç–µ
    return bestDirection || ghost.direction;
}`
                            }
                        title: '–ú–∞—Å—Ç–µ—Ä –ª–∞–±–∏—Ä–∏–Ω—Ç–∞',
                        description: '–ü—Ä–æ–π–¥–∏—Ç–µ –ø–µ—Ä–≤—ã–π —É—Ä–æ–≤–µ–Ω—å',
                        condition: () => this.currentLevel > 1,
                        earned: false
                    },
                    {
                        id: 'power-mode',
                        title: '–°—É–ø–µ—Ä–≥–µ—Ä–æ–π',
                        description: '–ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ —Ä–µ–∂–∏–º —Å—É–ø–µ—Ä-–µ–¥—ã',
                        condition: () => this.powerMode,
                        earned: false
                    },
                    {
                        id: 'code-modified',
                        title: '–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫',
                        description: '–ò–∑–º–µ–Ω–∏—Ç–µ –∏–≥—Ä–æ–≤–æ–π –∫–æ–¥ —á–µ—Ä–µ–∑ –∫–æ–Ω—Å–æ–ª—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞',
                        condition: () => this.codeModified,
                        earned: false
                    },
                    {
                        id: 'ghost-destroyed',
                        title: '–û—Ö–æ—Ç–Ω–∏–∫',
                        description: '–£–Ω–∏—á—Ç–æ–∂—å—Ç–µ –ø—Ä–∏–≤–∏–¥–µ–Ω–∏–µ –≤ —Ä–µ–∂–∏–º–µ —Å—É–ø–µ—Ä-–µ–¥—ã',
                        condition: () => this.score >= 210,
                        earned: false
                    },
                    {
                        id: 'five-levels',
                        title: '–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª',
                        description: '–ü—Ä–æ–π–¥–∏—Ç–µ 5 —É—Ä–æ–≤–Ω–µ–π –ø–æ–¥—Ä—è–¥',
                        condition: () => this.currentLevel > 5,
                        earned: false
                    }
                ];
            }
            
            /**
             * –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ç–µ—Å—Ç—ã
             * @returns {Array} –ú–∞—Å—Å–∏–≤ —Ç–µ—Å—Ç–æ–≤
             */
            loadTests() {
                return [
                    {
                        id: 'game-loop',
                        title: '–¢–µ—Å—Ç: –ò–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª',
                        questions: [
                            {
                                question: '–ö–∞–∫–æ–π –º–µ—Ç–æ–¥ —è–≤–ª—è–µ—Ç—Å—è –æ—Å–Ω–æ–≤–æ–π –∏–≥—Ä–æ–≤–æ–≥–æ —Ü–∏–∫–ª–∞?',
                                options: ['update()', 'draw()', 'gameLoop()', 'startGameLoop()'],
                                correctAnswer: 2,
                                explanation: '–ú–µ—Ç–æ–¥ gameLoop() –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —á–µ—Ä–µ–∑ requestAnimationFrame –∏ —è–≤–ª—è–µ—Ç—Å—è –æ—Å–Ω–æ–≤–æ–π –∏–≥—Ä–æ–≤–æ–≥–æ —Ü–∏–∫–ª–∞.'
                            },
                            {
                                question: '–ß—Ç–æ –¥–µ–ª–∞–µ—Ç –º–µ—Ç–æ–¥ update()?',
                                options: ['–û—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç –∏–≥—Ä—É', '–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ª–æ–≥–∏–∫—É –∏–≥—Ä—ã', '–£–ø—Ä–∞–≤–ª—è–µ—Ç –∑–≤—É–∫–æ–º', '–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤–≤–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è'],
                                correctAnswer: 1,
                                explanation: '–ú–µ—Ç–æ–¥ update() –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –∏–≥—Ä–æ–≤–æ–π –ª–æ–≥–∏–∫–∏: –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤, –ø—Ä–æ–≤–µ—Ä–∫—É –∫–æ–ª–ª–∏–∑–∏–π –∏ —Ç.–¥.'
                            },
                            {
                                question: '–ö–∞–∫–æ–π –º–µ—Ç–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –∏–≥—Ä—ã?',
                                options: ['update()', 'draw()', 'gameLoop()', 'render()'],
                                correctAnswer: 1,
                                explanation: '–ú–µ—Ç–æ–¥ draw() –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –æ—Ç—Ä–∏—Å–æ–≤–∫—É –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ —ç–∫—Ä–∞–Ω–µ.'
                            }
                        ]
                    },
                    {
                        id: 'input-handling',
                        title: '–¢–µ—Å—Ç: –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞',
                        questions: [
                            {
                                question: '–ö–∞–∫–æ–π –º–µ—Ç–æ–¥ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞–∂–∞—Ç–∏—è –∫–ª–∞–≤–∏—à?',
                                options: ['handleInput()', 'handleKey()', 'processInput()', 'processKey()'],
                                correctAnswer: 1,
                                explanation: '–ú–µ—Ç–æ–¥ handleKey() –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞–∂–∞—Ç–∏—è –∫–ª–∞–≤–∏—à –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ü–∞–∫–º–∞–Ω–æ–º.'
                            },
                            {
                                question: '–ö–∞–∫–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ü–∞–∫–º–∞–Ω–∞?',
                                options: ['direction', 'nextDirection', 'targetDirection', 'pendingDirection'],
                                correctAnswer: 1,
                                explanation: '–°–≤–æ–π—Å—Ç–≤–æ nextDirection –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è, –ø–æ–∫–∞ —Ç–µ–∫—É—â–µ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ.'
                            }
                        ]
                    }
                ];
            }
            
            /**
             * –ó–∞–≥—Ä—É–∂–∞–µ—Ç –∑–≤—É–∫–æ–≤—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
             * @returns {Object} –û–±—ä–µ–∫—Ç —Å–æ –∑–≤—É–∫–∞–º–∏
             */
            loadSounds() {
                return {
                    eat: {
                        play: (game) => {
                            if (!game.isSoundEnabled || game.activeSounds.has('eat')) return;
                            
                            game.activeSounds.add('eat');
                            setTimeout(() => {
                                game.activeSounds.delete('eat');
                            }, 200);
                            
                            // –°–æ–∑–¥–∞–µ–º –ø—Ä–æ—Å—Ç–æ–π –∑–≤—É–∫
                            if (game.audioContext) {
                                const oscillator = game.audioContext.createOscillator();
                                const gainNode = game.audioContext.createGain();
                                
                                oscillator.connect(gainNode);
                                gainNode.connect(game.audioContext.destination);
                                
                                oscillator.type = 'sine';
                                oscillator.frequency.value = 440;
                                gainNode.gain.value = 0.1;
                                
                                oscillator.start();
                                oscillator.stop(game.audioContext.currentTime + 0.1);
                            }
                        }
                    },
                    'eat-ghost': {
                        play: (game) => {
                            if (!game.isSoundEnabled || game.activeSounds.has('eat-ghost')) return;
                            
                            game.activeSounds.add('eat-ghost');
                            setTimeout(() => {
                                game.activeSounds.delete('eat-ghost');
                            }, 500);
                            
                            if (game.audioContext) {
                                const oscillator = game.audioContext.createOscillator();
                                const gainNode = game.audioContext.createGain();
                                
                                oscillator.connect(gainNode);
                                gainNode.connect(game.audioContext.destination);
                                
                                oscillator.type = 'sine';
                                oscillator.frequency.value = 880;
                                gainNode.gain.value = 0.2;
                                
                                oscillator.start();
                                oscillator.stop(game.audioContext.currentTime + 0.3);
                            }
                        }
                    },
                    death: {
                        play: (game) => {
                            if (!game.isSoundEnabled || game.activeSounds.has('death')) return;
                            
                            game.activeSounds.add('death');
                            setTimeout(() => {
                                game.activeSounds.delete('death');
                            }, 1000);
                            
                            if (game.audioContext) {
                                const oscillator = game.audioContext.createOscillator();
                                const gainNode = game.audioContext.createGain();
                                
                                oscillator.connect(gainNode);
                                gainNode.connect(game.audioContext.destination);
                                
                                oscillator.type = 'sine';
                                oscillator.frequency.value = 110;
                                gainNode.gain.value = 0.3;
                                
                                oscillator.start();
                                oscillator.stop(game.audioContext.currentTime + 0.8);
                            }
                        }
                    },
                    music: {
                        play: (game) => {
                            if (!game.isSoundEnabled || game.musicPlaying) return;
                            
                            game.musicPlaying = true;
                            game.musicIndicator.style.display = 'block';
                            
                            // –°–æ–∑–¥–∞–µ–º –ø—Ä–æ—Å—Ç—É—é –º–µ–ª–æ–¥–∏—é
                            const sequence = [
                                { freq: 261.63, dur: 0.2 }, // C4
                                { freq: 293.66, dur: 0.2 }, // D4
                                { freq: 329.63, dur: 0.2 }, // E4
                                { freq: 349.23, dur: 0.2 }, // F4
                                { freq: 392.00, dur: 0.2 }, // G4
                                { freq: 349.23, dur: 0.2 }, // F4
                                { freq: 329.63, dur: 0.2 }, // E4
                                { freq: 293.66, dur: 0.2 }  // D4
                            ];
                            
                            const startTime = game.audioContext.currentTime;
                            const totalDuration = sequence.reduce((sum, note) => sum + note.dur, 0) * 1000 + 500;
                            
                            sequence.forEach((note, i) => {
                                const oscillator = game.audioContext.createOscillator();
                                const gainNode = game.audioContext.createGain();
                                
                                oscillator.connect(gainNode);
                                gainNode.connect(game.audioContext.destination);
                                
                                oscillator.type = 'sine';
                                oscillator.frequency.value = note.freq;
                                gainNode.gain.value = 0.1;
                                
                                oscillator.start(startTime + i * 0.2);
                                oscillator.stop(startTime + i * 0.2 + note.dur);
                            });
                            
                            // –ü–ª–∞–Ω–∏—Ä—É–µ–º —Å–ª–µ–¥—É—é—â–µ–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –ø–∞—É–∑—É
                            game.musicTimeout = setTimeout(() => {
                                game.musicTimeout = null;
                                if (game.isRunning && game.isSoundEnabled) {
                                    game.sounds.music.play(game);
                                } else {
                                    game.musicPlaying = false;
                                    if (game.updateSoundVisualization) {
                                        game.updateSoundVisualization();
                                    }
                                }
                            }, totalDuration);
                        },
                        /**
                         * –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –∑–≤—É–∫–∞
                         */
                        setupSoundVisualizer() {
                            // –°–æ–∑–¥–∞–µ–º –±–∞—Ä—ã –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
                            for (let i = 0; i < 20; i++) {
                                const bar = document.createElement('div');
                                bar.className = 'sound-bar';
                                this.soundVisualizer.appendChild(bar);
                            }
                            
                            // –û–±–Ω–æ–≤–ª—è–µ–º –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é
                            setInterval(() => {
                                if (this.musicPlaying) {
                                    const bars = this.soundVisualizer.querySelectorAll('.sound-bar');
                                    bars.forEach(bar => {
                                        const height = 5 + Math.random() * 15;
                                        bar.style.height = `${height}px`;
                                    });
                                }
                            }, 50);
                        }
            
                        /**
                         * –û–±–Ω–æ–≤–ª—è–µ—Ç –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –∑–≤—É–∫–∞
                         */
                        updateSoundVisualization() {
                            if (this.musicPlaying) {
                                const bars = this.soundVisualizer.querySelectorAll('.sound-bar');
                                bars.forEach(bar => {
                                    const height = 5 + Math.random() * 15;
                                    bar.style.height = `${height}px`;
                                });
                            }
                        }
                    },
                    {
                        /**
                         * –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç UI-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
                         */
                        initUIComponents() {
                            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–º—ã
                            this.initTheme();
                            
                            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
                            this.initAchievements();
                            
                            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ —É—Ä–æ–≤–Ω–µ–π
                            this.initLevelEditor();

                            // –ö–Ω–æ–ø–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                            const soundBtn = document.getElementById('sound-toggle');
                            if (soundBtn) {
                                soundBtn.innerHTML = `<span>${this.isSoundEnabled ? 'üîä' : 'üîá'}</span> –ó–≤—É–∫: ${this.isSoundEnabled ? '–í–∫–ª' : '–í—ã–∫–ª'}`;
                            }
                            const pauseBtn = document.getElementById('pause-toggle');
                            if (pauseBtn) {
                                pauseBtn.innerHTML = `<span>‚è∏Ô∏è</span> –ü–∞—É–∑–∞`;
                            }

                            // –°–ª–æ–∂–Ω–æ—Å—Ç—å
                            this.difficulty = 'normal';
                            const diffSelect = document.getElementById('difficulty-select');
                            if (diffSelect) {
                                diffSelect.value = 'normal';
                                diffSelect.addEventListener('change', () => {
                                    this.difficulty = diffSelect.value;
                                });
                            }
                        },
                        /**
                         * –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ç–µ–º—É
                         */
                        initTheme() {
                            this.currentTheme = this.themeService.getRandomTheme();
                            const backgroundEl = document.querySelector('#theme');
                            if (backgroundEl) {
                                backgroundEl.style.backgroundColor = this.currentTheme.backgroundColor;
                            }
                        },
                        /**
                         * –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
                         */
                        initAchievements() {
                            const allAchievements = [
                                'start-quest', 
                                'reach-score', 
                                'finish-first-quest', 
                                'collect-max-spheres'
                            ];

                            const achievementsListEl = document.querySelector('#achievements');
                            if (achievementsListEl) {
                                allAchievements.forEach(key => {
                                    const itemEl = document.createElement('div');
                                    itemEl.classList.add('achievement', `achievement--${key}`, key === this.completedAchievement ? 'achievement--completed' : '');
                                    const title = key[0].toUpperCase() + key.substring(1);
                                    title.replace(/([A-Z])/g, ' $1');
                                    itemEl.textContent = title.replace('-', ' ');

                                    achievementsListEl.appendChild(itemEl);
                                });
                            }
                        },
                        /**
                         * –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ä–µ–¥–∞–∫—Ç–æ—Ä —É—Ä–æ–≤–Ω–µ–π
                         */
                        initLevelEditor() {
                            const levelEditorContainerEl = document.querySelector('#level-editor');
                            if (levelEditorContainerEl) {
                                const levelEditor = document.createElement('textarea');
                                levelEditor.className = 'level-editor';
                                levelEditor.rows = '12';

                                const loadLevelsEl = document.createElement('button');
                                loadLevelsEl.textContent = '–ó–∞–≥—Ä—É–∑–∏—Ç—å —É—Ä–æ–≤–Ω–∏ –∏–∑ textarea';

                                const saveLevelBtnEl = document.createElement('button');
                                saveLevelBtnEl.textContent = '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å';
                                
                                const saveFileEl = document.createElement('input');
                                saveFileEl.type = 'file';

                                levelEditorContainerEl.appendChild(levelEditor);
                                levelEditorContainerEl.appendChild(loadLevelsEl);
                                levelEditorContainerEl.appendChild(saveLevelBtnEl);
                                levelEditorContainerEl.appendChild(saveFileEl);

                                // –§—É–Ω–∫—Ü–∏–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
                                levelEditor.addEventListener('input', e => this.loadLevelTextFrom(e.target));
                                saveLevelBtnEl.addEventListener('click', e => this.saveCurrentLevel());

                                saveFileEl.addEventListener('input', e => {
                                    const file = saveFileEl.files[0];
                                    this.loadLevelTextFrom(file);

                                });

                                loadLevelsEl.addEventListener('click', e => {
                                    const levelsString = levelEditor.value.split(/,
?
|
\*,*
?|\*,\s|,,+/)
                                      .filter(i => !!i.length && !!parseInt(i.substring(i.lastIndexOf('_'), i.indexOf('+')))
                                          || this.themeService.getAllThemeIDs()
                                      );

                                  for(let lvlIDStr = ''; isNaN((lvlID = +lvlIDStr));)
                                if (this.currentLvl = ~levelMap.has(4*(parseInt('')+~(' '+i)))){ }
                             let lvlID = 0;
                             let levelMap = new Map();
                             let levels = [];
                             let levelIDs = [];
                             let currentLvl = 0;

                             for(let lvlIDStr = ''; isNaN((lvlID = +lvlIDStr));)
                             if (this.currentLvl = ~levelMap.has(4*(parseInt('')+~(' '+i)))){ }
                             let lvlID = 0;
                             let levelMap = new Map();
                             let levels = [];
                             let levelIDs = [];
                             let currentLvl = 0;
                                });

                                levelEditor.value = this.levelService.getLevelsString();
                            }
                        }
                    }
                ]
            }
                        this.showNotification(`–°–ª–æ–∂–Ω–æ—Å—Ç—å: ${this.difficulty}`);
                    });
                }
            }
            
            /**
             * –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ç–µ–º—É
             */
            initTheme() {
                const savedTheme = localStorage.getItem('pacmanTheme');
                this.isDarkTheme = savedTheme === 'dark' || (!savedTheme && window.matchMedia('(prefers-color-scheme: dark)').matches);
                document.body.classList.toggle('light-theme', !this.isDarkTheme);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É —Ç–µ–º—ã
                const themeButton = document.getElementById('theme-toggle');
                themeButton.innerHTML = `<span>${this.isDarkTheme ? 'üåô' : '‚òÄÔ∏è'}</span> ${this.isDarkTheme ? '–¢–µ–º–Ω–∞—è' : '–°–≤–µ—Ç–ª–∞—è'} —Ç–µ–º–∞`;
            }
            
            /**
             * –ü–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç —Ç–µ–º—É (—Ç–µ–º–Ω–∞—è/—Å–≤–µ—Ç–ª–∞—è)
             */
            toggleTheme() {
                this.isDarkTheme = !this.isDarkTheme;
                document.body.classList.toggle('light-theme', !this.isDarkTheme);
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±–æ—Ä —Ç–µ–º—ã
                localStorage.setItem('pacmanTheme', this.isDarkTheme ? 'dark' : 'light');
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É —Ç–µ–º—ã
                const themeButton = document.getElementById('theme-toggle');
                themeButton.innerHTML = `<span>${this.isDarkTheme ? 'üåô' : '‚òÄÔ∏è'}</span> ${this.isDarkTheme ? '–¢–µ–º–Ω–∞—è' : '–°–≤–µ—Ç–ª–∞—è'} —Ç–µ–º–∞`;
            }
            
            /**
             * –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å–∏—Å—Ç–µ–º—É –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
             */
            initAchievements() {
                // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
                const savedAchievements = JSON.parse(localStorage.getItem('pacmanAchievements') || '[]');
                
                this.achievements.forEach(achievement => {
                    const saved = savedAchievements.find(a => a.id === achievement.id);
                    if (saved) {
                        achievement.earned = saved.earned;
                    }
                });
                
                // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
                this.renderAchievements();
            }
            
            /**
             * –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –≤ –ø–∞–Ω–µ–ª–∏
             */
            renderAchievements() {
                const achievementsList = document.getElementById('achievements-list');
                achievementsList.innerHTML = '';
                
                this.achievements.forEach(achievement => {
                    const achievementElement = document.createElement('div');
                    achievementElement.className = 'achievement';
                    
                    achievementElement.innerHTML = `
                        <h3 class="achievement-title">${achievement.title}</h3>
                        <p class="achievement-description">${achievement.description}</p>
                        <span class="achievement-status">${achievement.earned ? '–ü–æ–ª—É—á–µ–Ω–æ' : '–ù–µ –ø–æ–ª—É—á–µ–Ω–æ'}</span>
                    `;
                    
                    achievementsList.appendChild(achievementElement);
                });
            }
            
            /**
             * –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–∞–Ω–µ–ª—å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
             */
            showAchievementsPanel() {
                document.getElementById('achievements-panel').classList.add('open');
            }
            
            /**
             * –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
             */
            checkAchievements() {
                let newAchievements = 0;
                
                this.achievements.forEach(achievement => {
                    if (!achievement.earned && achievement.condition()) {
                        achievement.earned = true;
                        newAchievements++;
                        this.showAchievement(achievement);
                    }
                });
                
                if (newAchievements > 0) {
                    this.saveAchievements();
                    this.renderAchievements();
                }
            }
            
            /**
             * –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ
             * @param {Object} achievement - –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ
             */
            showAchievement(achievement) {
                const notification = document.getElementById('notification');
                notification.textContent = `–ù–æ–≤–æ–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ: ${achievement.title} - ${achievement.description}`;
                notification.className = 'notification achievement';
                notification.classList.add('show');
                
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 3000);
            }
            
            /**
             * –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –≤ localStorage
             */
            saveAchievements() {
                const earnedAchievements = this.achievements.map(a => ({
                    id: a.id,
                    earned: a.earned
                }));
                
                localStorage.setItem('pacmanAchievements', JSON.stringify(earnedAchievements));
            }
            
            /**
             * –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ä–µ–¥–∞–∫—Ç–æ—Ä —É—Ä–æ–≤–Ω–µ–π
             */
            initLevelEditor() {
                this.editorCanvas = document.getElementById('editor-canvas');
                this.editorCtx = this.editorCanvas.getContext('2d');
                this.editorMap = this.cloneMap(this.levels[0]);
                this.currentTool = 'wall';
                
                // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
                this.editorCanvas.addEventListener('mousedown', (e) => {
                    this.isDrawing = true;
                    this.updateEditorCell(e);
                });
                
                this.editorCanvas.addEventListener('mousemove', (e) => this.handleEditorMouseMove(e));
                document.addEventListener('mouseup', () => {
                    this.isDrawing = false;
                    if (this.editorMoveTimeout) {
                        clearTimeout(this.editorMoveTimeout);
                        this.editorMoveTimeout = null;
                    }
                });
                
                // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
                document.querySelectorAll('.tool-button').forEach(button => {
                    button.addEventListener('click', () => {
                        document.querySelectorAll('.tool-button').forEach(b => b.classList.remove('active'));
                        button.classList.add('active');
                        this.currentTool = button.dataset.tool;
                    });
                });
            }
            
            /**
             * –û–±–Ω–æ–≤–ª—è–µ—Ç —è—á–µ–π–∫—É –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ —É—Ä–æ–≤–Ω–µ–π
             * @param {MouseEvent} e - –°–æ–±—ã—Ç–∏–µ –º—ã—à–∏
             */
            updateEditorCell(e) {
                const rect = this.editorCanvas.getBoundingClientRect();
                const x = Math.floor((e.clientX - rect.left) / this.cellSize);
                const y = Math.floor((e.clientY - rect.top) / this.cellSize);
                
                if (x >= 0 && x < this.editorMap[0].length && y >= 0 && y < this.editorMap.length) {
                    switch(this.currentTool) {
                        case 'wall':
                            this.editorMap[y][x] = 0;
                            break;
                        case 'path':
                            this.editorMap[y][x] = 1;
                            break;
                        case 'food':
                            this.editorMap[y][x] = 2;
                            break;
                        case 'super-food':
                            this.editorMap[y][x] = 3;
                            break;
                        case 'pacman':
                            // –°–Ω–∞—á–∞–ª–∞ –æ—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â—É—é –ø–æ–∑–∏—Ü–∏—é –ü–∞–∫–º–∞–Ω–∞
                            for (let i = 0; i < this.editorMap.length; i++) {
                                for (let j = 0; j < this.editorMap[i].length; j++) {
                                    if (this.editorMap[i][j] === 4) {
                                        this.editorMap[i][j] = 1;
                                    }
                                }
                            }
                            this.editorMap[y][x] = 4;
                            break;
                        case 'ghost':
                            // –°–Ω–∞—á–∞–ª–∞ –æ—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â—É—é –ø–æ–∑–∏—Ü–∏—é –ø—Ä–∏–≤–∏–¥–µ–Ω–∏—è
                            for (let i = 0; i < this.editorMap.length; i++) {
                                for (let j = 0; j < this.editorMap[i].length; j++) {
                                    if (this.editorMap[i][j] === 5) {
                                        this.editorMap[i][j] = 1;
                                    }
                                }
                            }
                            this.editorMap[y][x] = 5;
                            break;
                    }
                    
                    this.drawEditorMap();
                }
            }
            
            /**
             * –û—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç –∫–∞—Ä—Ç—É –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ —É—Ä–æ–≤–Ω–µ–π
             */
            drawEditorMap() {
                const mapHeight = this.editorMap.length;
                const mapWidth = this.editorMap[0].length;
                
                // –û—á–∏—Å—Ç–∫–∞ —Ö–æ–ª—Å—Ç–∞
                this.editorCtx.fillStyle = 'black';
                this.editorCtx.fillRect(0, 0, this.editorCanvas.width, this.editorCanvas.height);
                
                for (let y = 0; y < mapHeight; y++) {
                    for (let x = 0; x < mapWidth; x++) {
                        const cell = this.editorMap[y][x];
                        
                        // –°—Ç–µ–Ω—ã
                        if (cell === 0) {
                            this.editorCtx.fillStyle = 'blue';
                            this.editorCtx.fillRect(
                                x * this.cellSize,
                                y * this.cellSize,
                                this.cellSize,
                                this.cellSize
                            );
                        }
                        // –ü—É—Ç—å
                        else if (cell === 1) {
                            this.editorCtx.fillStyle = 'black';
                            this.editorCtx.fillRect(
                                x * this.cellSize,
                                y * this.cellSize,
                                this.cellSize,
                                this.cellSize
                            );
                        }
                        // –û–±—ã—á–Ω–∞—è –µ–¥–∞
                        else if (cell === 2) {
                            this.editorCtx.fillStyle = 'white';
                            this.editorCtx.beginPath();
                            this.editorCtx.arc(
                                x * this.cellSize + this.cellSize/2,
                                y * this.cellSize + this.cellSize/2,
                                2,
                                0,
                                Math.PI * 2
                            );
                            this.editorCtx.fill();
                        }
                        // –°—É–ø–µ—Ä-–µ–¥–∞
                        else if (cell === 3) {
                            this.editorCtx.fillStyle = '#FFD700';
                            this.editorCtx.beginPath();
                            this.editorCtx.arc(
                                x * this.cellSize + this.cellSize/2,
                                y * this.cellSize + this.cellSize/2,
                                5,
                                0,
                                Math.PI * 2
                            );
                            this.editorCtx.fill();
                        }
                        // –ü–∞–∫–º–∞–Ω
                        else if (cell === 4) {
                            this.editorCtx.fillStyle = 'yellow';
                            this.editorCtx.beginPath();
                            this.editorCtx.arc(
                                x * this.cellSize + this.cellSize/2,
                                y * this.cellSize + this.cellSize/2,
                                this.cellSize/2 - 2,
                                0,
                                Math.PI * 1.8
                            );
                            this.editorCtx.lineTo(
                                x * this.cellSize + this.cellSize/2,
                                y * this.cellSize + this.cellSize/2
                            );
                            this.editorCtx.fill();
                        }
                        // –ü—Ä–∏–≤–∏–¥–µ–Ω–∏–µ
                        else if (cell === 5) {
                            this.editorCtx.fillStyle = 'red';
                            this.editorCtx.fillRect(
                                x * this.cellSize,
                                y * this.cellSize,
                                this.cellSize,
                                this.cellSize
                            );
                        }
                    }
                }
            }
            
            /**
             * –ü—Ä–∏–º–µ–Ω—è–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–∑ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ —É—Ä–æ–≤–Ω–µ–π
             */
            applyLevelChanges() {
                const levelName = document.getElementById('level-name').value;
                const levelNumber = parseInt(document.getElementById('level-number').value);
                
                if (!levelName || !levelNumber) {
                    this.showNotification('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ –Ω–æ–º–µ—Ä —É—Ä–æ–≤–Ω—è', 'error');
                    return;
                }
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º —É—Ä–æ–≤–µ–Ω—å –≤ –º–∞—Å—Å–∏–≤ —É—Ä–æ–≤–Ω–µ–π
                this.levels[levelNumber - 1] = this.cloneMap(this.editorMap);
                
                this.showNotification(`–£—Ä–æ–≤–µ–Ω—å "${levelName}" —Å–æ—Ö—Ä–∞–Ω–µ–Ω!`);
                this.closeLevelEditor();
            }
            
            /**
             * –û—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ä–µ–¥–∞–∫—Ç–æ—Ä —É—Ä–æ–≤–Ω–µ–π
             */
            openLevelEditor() {
                document.getElementById('level-editor').style.display = 'flex';
                this.editorMap = this.cloneMap(this.levels[this.currentLevel - 1]);
                document.getElementById('level-name').value = `–£—Ä–æ–≤–µ–Ω—å ${this.currentLevel}`;
                document.getElementById('level-number').value = this.currentLevel;
                this.drawEditorMap();
            }
            
            /**
             * –ó–∞–∫—Ä—ã–≤–∞–µ—Ç —Ä–µ–¥–∞–∫—Ç–æ—Ä —É—Ä–æ–≤–Ω–µ–π
             */
            closeLevelEditor() {
                document.getElementById('level-editor').style.display = 'none';
            }
            
            /**
             * –û—Ç–∫—Ä—ã–≤–∞–µ—Ç —É—Ä–æ–∫
             * @param {number} lessonId - ID —É—Ä–æ–∫–∞
             */
            openLesson(lessonId) {
                this.currentLesson = this.lessons.find(lesson => lesson.id === lessonId);
                if (!this.currentLesson) return;
                
                this.currentLessonStep = 0;
                document.getElementById('lesson-title').textContent = this.currentLesson.title;
                this.showLessonStep();
                document.getElementById('lesson-panel').style.display = 'flex';
            }
            
            /**
             * –ó–∞–∫—Ä—ã–≤–∞–µ—Ç —É—Ä–æ–∫
             */
            closeLesson() {
                document.getElementById('lesson-panel').style.display = 'none';
            }
            
            /**
             * –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ç–µ–∫—É—â–∏–π —à–∞–≥ —É—Ä–æ–∫–∞
             */
            showLessonStep() {
                const lesson = this.currentLesson;
                const step = lesson.steps[this.currentLessonStep];
                
                const content = document.getElementById('lesson-content');
                content.innerHTML = '';
                
                const stepElement = document.createElement('div');
                stepElement.className = 'lesson-step';
                
                stepElement.innerHTML = `
                    <h4>${step.highlight}</h4>
                    <p>${step.explanation}</p>
                    <div class="code-block">${this.escapeHtml(step.codeSnippet)}</div>
                `;
                
                content.appendChild(stepElement);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–æ–∫
                document.getElementById('lesson-prev').disabled = this.currentLessonStep === 0;
                document.getElementById('lesson-next').disabled = this.currentLessonStep === lesson.steps.length - 1;
            }
            
            /**
             * –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É —à–∞–≥—É —É—Ä–æ–∫–∞
             */
            previousLessonStep() {
                if (this.currentLessonStep > 0) {
                    this.currentLessonStep--;
                    this.showLessonStep();
                }
            }
            
            /**
             * –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É —É—Ä–æ–∫–∞
             */
            nextLessonStep() {
                if (this.currentLessonStep < this.currentLesson.steps.length - 1) {
                    this.currentLessonStep++;
                    this.showLessonStep();
                } else {
                    this.closeLesson();
                }
            }
            
            /**
             * –û—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ç–µ—Å—Ç
             * @param {string} testId - ID —Ç–µ—Å—Ç–∞
             */
            openTest(testId) {
                this.currentTest = this.tests.find(test => test.id === testId);
                if (!this.currentTest) return;
                
                this.currentQuestion = 0;
                this.testScore = 0;
                
                document.getElementById('test-title').textContent = this.currentTest.title;
                this.showTestQuestion();
                document.getElementById('test-panel').style.display = 'flex';
            }
            
            /**
             * –ó–∞–∫—Ä—ã–≤–∞–µ—Ç —Ç–µ—Å—Ç
             */
            closeTest() {
                document.getElementById('test-panel').style.display = 'none';
            }
            
            /**
             * –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ç–µ–∫—É—â–∏–π –≤–æ–ø—Ä–æ—Å —Ç–µ—Å—Ç–∞
             */
            showTestQuestion() {
                const test = this.currentTest;
                const question = test.questions[this.currentQuestion];
                
                const content = document.getElementById('test-content');
                content.innerHTML = `
                    <div class="test-question">
                        <h4>–í–æ–ø—Ä–æ—Å ${this.currentQuestion + 1} –∏–∑ ${test.questions.length}</h4>
                        <p>${question.question}</p>
                        ${question.options.map((option, i) => `
                            <div class="test-option" data-index="${i}">
                                ${option}
                            </div>
                        `).join('')}
                        <div class="feedback" id="test-feedback"></div>
                    </div>
                `;
                
                // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
                document.querySelectorAll('.test-option').forEach(option => {
                    option.addEventListener('click', () => {
                        this.checkAnswer(parseInt(option.dataset.index));
                    });
                });
            }
            
            /**
             * –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –æ—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å
             * @param {number} answerIndex - –ò–Ω–¥–µ–∫—Å –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞
             */
            checkAnswer(answerIndex) {
                const question = this.currentTest.questions[this.currentQuestion];
                const feedback = document.getElementById('test-feedback');
                
                if (answerIndex === question.correctAnswer) {
                    feedback.className = 'feedback success';
                    feedback.textContent = '–ü—Ä–∞–≤–∏–ª—å–Ω–æ! ' + question.explanation;
                    this.testScore++;
                } else {
                    feedback.className = 'feedback error';
                    feedback.textContent = '–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. ' + question.explanation;
                }
                
                // –°–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
                setTimeout(() => {
                    this.currentQuestion++;
                    
                    if (this.currentQuestion < this.currentTest.questions.length) {
                        this.showTestQuestion();
                    } else {
                        this.showTestResults();
                    }
                }, 2000);
            }
            
            /**
             * –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞
             */
            showTestResults() {
                const content = document.getElementById('test-content');
                content.innerHTML = `
                    <div class="test-results">
                        <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞</h3>
                        <div class="test-score">${this.testScore} –∏–∑ ${this.currentTest.questions.length}</div>
                        <p>–í–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç: ${Math.round((this.testScore / this.currentTest.questions.length) * 100)}%</p>
                        <div class="modal-buttons" style="margin-top: 30px;">
                            <button class="btn" id="close-test-results">–ó–∞–∫—Ä—ã—Ç—å</button>
                        </div>
                    </div>
                `;
                
                document.getElementById('close-test-results').addEventListener('click', () => {
                    this.closeTest();
                });
            }
            
            /**
             * –ö–ª–æ–Ω–∏—Ä—É–µ—Ç –∫–∞—Ä—Ç—É —É—Ä–æ–≤–Ω—è
             * @param {Array} map - –ö–∞—Ä—Ç–∞ —É—Ä–æ–≤–Ω—è
             * @returns {Array} –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–∞—Ä—Ç–∞
             */
            cloneMap(map) {
                return JSON.parse(JSON.stringify(map));
            }
            
            /**
             * –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –µ–¥—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ
             */
            countTotalFood() {
                this.totalFood = 0;
                for (const row of this.currentMap) {
                    for (const cell of row) {
                        if (cell === 2 || cell === 3) {
                            this.totalFood++;
                        }
                    }
                }
            }
            
            /**
             * –ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –µ–¥—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ, –µ—Å–ª–∏ –æ–Ω–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
             * @param {Array} map - –ö–∞—Ä—Ç–∞ —É—Ä–æ–≤–Ω—è
             */
            populateFoodIfMissing(map) {
                let hasFood = false;
                for (let y = 0; y < map.length; y++) {
                    for (let x = 0; x < map[y].length; x++) {
                        if (map[y][x] === 2 || map[y][x] === 3) {
                            hasFood = true;
                            break;
                        }
                    }
                    if (hasFood) break;
                }
                if (!hasFood) {
                    for (let y = 0; y < map.length; y++) {
                        for (let x = 0; x < map[y].length; x++) {
                            if (map[y][x] === 1) {
                                map[y][x] = 2;
                            }
                        }
                    }
                    // –î–æ–±–∞–≤–∏–º 4 —Å—É–ø–µ—Ä-—Ç–æ—á–∫–∏ –ø–æ —É–≥–ª–∞–º –ø—Ä–æ—Ö–æ–¥–æ–≤, –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã
                    const positions = [
                        {x:1,y:1},
                        {x:map[0].length-2,y:1},
                        {x:1,y:map.length-2},
                        {x:map[0].length-2,y:map.length-2}
                    ];
                    positions.forEach(p => {
                        if (map[p.y] && map[p.y][p.x] && map[p.y][p.x] !== 0) {
                            map[p.y][p.x] = 3;
                        }
                    });
                }
            }
            
            /**
             * –ó–∞–≥—Ä—É–∂–∞–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å –∏–≥—Ä—ã
             * @returns {boolean} –£—Å–ø–µ—à–Ω–æ –ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–æ
             */
            loadProgress() {
                const saved = localStorage.getItem('pacmanProgress');
                if (saved) {
                    try {
                        const progress = JSON.parse(saved);
                        if (progress.version === '1.1') {
                            this.highScore = progress.highScore;
                            this.currentLevel = Math.min(progress.currentLevel, this.levels.length);
                            
                            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
                            if (progress.achievements && Array.isArray(progress.achievements)) {
                                progress.achievements.forEach(id => {
                                    const achievement = this.achievements.find(a => a.id === id);
                                    if (achievement) achievement.earned = true;
                                });
                            }
                            
                            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                            if (progress.settings) {
                                this.isSoundEnabled = progress.settings.soundEnabled !== undefined ? 
                                    progress.settings.soundEnabled : true;
                                this.isLearningMode = progress.settings.learningMode !== undefined ? 
                                    progress.settings.learningMode : false;
                                
                                // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º —Ç–µ–º—É
                                this.isDarkTheme = progress.settings.theme !== 'light';
                                document.body.classList.toggle('light-theme', !this.isDarkTheme);
                                
                                // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ —Ç–µ–º—ã
                                const themeBtn = document.getElementById('theme-toggle');
                                if (themeBtn) {
                                    themeBtn.innerHTML = `<span>${this.isDarkTheme ? 'üåô' : '‚òÄÔ∏è'}</span> ${this.isDarkTheme ? '–¢–µ–º–Ω–∞—è' : '–°–≤–µ—Ç–ª–∞—è'} —Ç–µ–º–∞`;
                                }
                            }
                            
                            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                            this.updateUI();
                            return true;
                        }
                    } catch (e) {
                        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞:', e);
                    }
                }
                return false;
            }
            
            /**
             * –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å –∏–≥—Ä—ã
             */
            saveProgress() {
                try {
                    const progress = {
                        version: '1.1',
                        highScore: this.highScore,
                        currentLevel: this.currentLevel,
                        unlockedLevels: Math.min(this.levels.length, this.currentLevel),
                        achievements: this.achievements.filter(a => a.earned).map(a => a.id),
                        settings: {
                            soundEnabled: this.isSoundEnabled,
                            learningMode: this.isLearningMode,
                            theme: this.isDarkTheme ? 'dark' : 'light'
                        }
                    };
                    
                    localStorage.setItem('pacmanProgress', JSON.stringify(progress));
                    this.showNotification('–ü—Ä–æ–≥—Ä–µ—Å—Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω!');
                } catch (e) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞:', e);
                    this.showNotification('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å', 'error');
                }
            }
            
            /**
             * –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
             * @param {string} message - –¢–µ–∫—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
             * @param {string} [type='success'] - –¢–∏–ø —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (success, error, achievement)
             */
            showNotification(message, type = 'success') {
                const notification = document.getElementById('notification');
                notification.textContent = message;
                notification.className = 'notification';
                notification.classList.add('show');
                
                if (type !== 'success') {
                    notification.classList.add(type);
                }
                
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 3000);
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', () => {
            // –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä –∏–≥—Ä—ã
            const game = new PacmanGame();
        });
    </script>
</body>
</html>