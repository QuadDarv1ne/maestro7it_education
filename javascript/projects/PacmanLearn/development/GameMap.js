class GameMap {
    constructor() {
        // Карта уровня (1 - путь, 0 - стена, 2 - еда, 3 - супер-еда)
        // Исправленный начальный уровень в стиле классического Pacman с открытым дизайном
        this.map = [
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0],
            [0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0],
            [0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0],
            [0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0],
            [0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0],
            [0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0],
            [0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0],
            [0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0],
            [0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0],
            [0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0],
            [0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0],
            [0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0],
            [0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0],
            [0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
        ];

        // Система уровней с разными картами
        this.levelMaps = [
            // Уровень 1 - Новичок (классический Pacman стиль)
            [
                [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                [0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0],
                [0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0],
                [0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0],
                [0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0],
                [0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0],
                [0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0],
                [0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0],
                [0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0],
                [0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0],
                [0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0],
                [0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0],
                [0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0],
                [0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0],
                [0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0],
                [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
            ],
            // Уровень 2 - Новичок (больше стен, меньше путей)
            [
                [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                [0,2,2,0,2,2,0,2,2,2,2,2,2,0,2,2,0,2,2,0],
                [0,2,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,2,0],
                [0,2,0,2,2,0,2,2,0,2,2,0,2,2,0,2,2,0,2,0],
                [0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0],
                [0,2,0,2,0,2,2,2,0,2,2,0,2,2,2,0,2,0,2,0],
                [0,2,0,0,0,2,0,0,0,2,2,0,0,0,2,0,0,0,2,0],
                [0,2,2,0,0,2,0,2,2,2,2,2,2,0,2,0,0,2,2,0],
                [0,0,0,0,2,0,0,2,0,0,0,0,2,0,0,2,0,0,0,0],
                [0,2,2,0,2,0,0,2,0,2,2,0,2,0,0,2,0,2,2,0],
                [0,0,0,0,2,0,0,2,0,2,2,0,2,0,0,2,0,0,0,0],
                [0,2,2,0,0,2,0,0,0,0,0,0,0,0,2,0,0,2,2,0],
                [0,2,0,0,0,2,0,2,2,2,2,2,2,0,2,0,0,0,2,0],
                [0,2,0,2,0,2,0,0,0,2,2,0,0,0,2,0,2,0,2,0],
                [0,0,0,2,0,2,2,2,0,2,2,0,2,2,2,0,2,0,0,0],
                [0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0],
                [0,2,0,2,2,0,2,2,0,2,2,0,2,2,0,2,2,0,2,0],
                [0,2,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,2,0],
                [0,2,2,0,2,2,0,2,2,2,2,2,2,0,2,2,0,2,2,0],
                [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
            ],
            // Уровень 3 - Продвинутый (узкие проходы)
            [
                [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                [0,2,0,2,0,2,0,2,0,2,2,0,2,0,2,0,2,0,2,0],
                [0,2,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,2,0],
                [0,2,0,2,2,2,0,2,0,2,2,0,2,0,2,2,2,0,2,0],
                [0,0,0,2,0,0,0,2,0,0,0,0,2,0,0,0,2,0,0,0],
                [0,2,0,2,0,2,2,2,0,2,2,0,2,2,2,0,2,0,2,0],
                [0,2,0,0,0,2,0,0,0,2,2,0,0,0,2,0,0,0,2,0],
                [0,2,2,0,0,2,0,2,2,2,2,2,2,0,2,0,0,2,2,0],
                [0,0,0,0,2,0,0,2,0,0,0,0,2,0,0,2,0,0,0,0],
                [0,2,2,0,2,0,0,2,0,2,2,0,2,0,0,2,0,2,2,0],
                [0,0,0,0,2,0,0,2,0,2,2,0,2,0,0,2,0,0,0,0],
                [0,2,2,0,0,2,0,0,0,0,0,0,0,0,2,0,0,2,2,0],
                [0,2,0,0,0,2,0,2,2,2,2,2,2,0,2,0,0,0,2,0],
                [0,2,0,2,0,2,0,0,0,2,2,0,0,0,2,0,2,0,2,0],
                [0,0,0,2,0,2,2,2,0,2,2,0,2,2,2,0,2,0,0,0],
                [0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0],
                [0,2,0,2,2,0,2,2,2,0,0,2,2,2,0,2,2,0,2,0],
                [0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0],
                [0,2,2,0,2,2,0,2,2,2,2,2,2,0,2,2,0,2,2,0],
                [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
            ],
            // Уровень 4 - Сложный (сложный лабиринт)
            [
                [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                [0,2,2,0,2,0,2,0,2,0,0,2,0,2,0,2,0,2,2,0],
                [0,0,0,0,2,0,0,0,2,0,0,2,0,0,0,2,0,0,0,0],
                [0,2,2,0,2,0,2,0,2,2,2,2,0,2,0,2,0,2,2,0],
                [0,2,0,0,0,0,2,0,0,0,0,0,0,2,0,0,0,0,2,0],
                [0,2,0,2,2,0,2,0,2,0,0,2,0,2,0,2,2,0,2,0],
                [0,0,0,2,0,0,0,0,2,0,0,2,0,0,0,0,2,0,0,0],
                [0,2,0,2,0,2,2,0,2,2,2,2,0,2,2,0,2,0,2,0],
                [0,2,0,0,0,2,0,0,0,0,0,0,0,0,2,0,0,0,2,0],
                [0,2,2,0,0,2,0,2,0,2,2,0,2,0,2,0,0,2,2,0],
                [0,0,0,0,2,0,0,2,0,2,2,0,2,0,0,2,0,0,0,0],
                [0,2,2,0,2,0,0,0,0,0,0,0,0,0,0,2,0,2,2,0],
                [0,2,0,0,2,2,0,2,2,2,2,2,2,0,2,2,0,0,2,0],
                [0,2,0,2,0,0,0,2,0,0,0,0,2,0,0,0,0,2,2,0],
                [0,0,0,2,0,2,0,2,0,2,2,0,2,0,2,0,2,0,0,0],
                [0,2,0,0,0,2,0,0,0,2,2,0,0,0,2,0,0,0,2,0],
                [0,2,2,0,2,2,2,0,2,2,2,2,0,2,2,2,0,2,2,0],
                [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                [0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0],
                [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
            ],
            // Уровень 5 - Продвинутый (множество путей, больше призраков)
            [
                [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                [0,3,0,2,0,2,0,2,0,2,2,0,2,0,2,0,2,0,3,0],
                [0,0,0,2,0,0,0,0,0,2,2,0,0,0,0,0,2,0,0,0],
                [0,2,0,2,0,2,2,0,0,2,2,0,0,2,2,0,2,0,2,0],
                [0,2,0,0,0,2,0,0,2,0,0,2,0,0,2,0,0,0,2,0],
                [0,2,2,0,0,2,0,2,2,0,0,2,2,0,2,0,0,2,2,0],
                [0,0,0,0,2,0,0,2,0,0,0,0,2,0,0,2,0,0,0,0],
                [0,2,2,0,2,0,0,2,0,2,2,0,2,0,0,2,0,2,2,0],
                [0,2,0,0,2,2,0,0,0,2,2,0,0,0,2,2,0,0,2,0],
                [0,2,0,2,0,0,0,2,0,2,2,0,2,0,0,0,0,2,2,0],
                [0,2,0,2,0,2,0,2,0,0,0,0,2,0,2,0,2,0,2,0],
                [0,0,0,0,0,2,0,0,0,2,2,0,0,0,2,0,0,0,0,0],
                [0,2,2,0,0,2,2,0,2,2,2,2,0,2,2,0,0,2,2,0],
                [0,0,0,0,2,0,0,0,2,0,0,2,0,0,0,2,0,0,0,0],
                [0,2,2,0,2,0,2,0,2,0,0,2,0,2,0,2,0,2,2,0],
                [0,3,0,0,0,0,2,0,0,0,0,0,0,2,0,0,0,0,3,0],
                [0,2,0,2,2,0,2,0,2,2,2,2,0,2,0,2,2,0,2,0],
                [0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0],
                [0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0],
                [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
            ],
            // Уровень 6 - Эксперт (плотные стены, стратегическое размещение еды)
            [
                [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                [0,3,2,0,2,0,2,3,2,0,0,2,3,2,0,2,0,2,3,0],
                [0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0],
                [0,2,0,2,0,2,0,2,0,2,2,0,2,0,2,0,2,0,2,0],
                [0,0,0,2,0,2,0,0,0,2,2,0,0,0,2,0,2,0,0,0],
                [0,2,0,2,0,2,0,2,0,2,2,0,2,0,2,0,2,0,2,0],
                [0,2,0,0,0,0,0,2,0,0,0,0,2,0,0,0,0,0,2,0],
                [0,2,0,2,2,0,0,2,2,0,0,2,2,0,0,2,2,0,2,0],
                [0,0,0,0,0,0,2,0,0,0,0,0,0,2,0,0,0,0,0,0],
                [0,2,2,0,2,0,2,0,2,2,2,2,0,2,0,2,0,2,2,0],
                [0,0,0,0,2,0,2,0,2,0,0,2,0,2,0,2,0,0,0,0],
                [0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2],
                [0,0,0,0,2,0,2,2,0,0,0,0,2,2,0,2,0,0,0,0],
                [0,2,2,0,2,0,0,0,0,2,2,0,0,0,0,2,0,2,2,0],
                [0,0,0,0,0,0,2,2,0,2,2,0,2,2,0,0,0,0,0,0],
                [0,2,0,2,2,0,0,0,0,0,0,0,0,0,0,2,2,0,2,0],
                [0,2,0,0,0,0,2,0,2,2,2,2,0,2,0,0,0,0,2,0],
                [0,0,0,2,0,0,2,0,0,0,0,0,0,2,0,0,2,0,0,0],
                [0,3,2,0,2,0,2,3,2,0,0,2,3,2,0,2,0,2,3,0],
                [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
            ],
            // Уровень 7 - Мастер (сложные узоры, ограниченная видимость)
            [
                [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                [0,2,0,2,0,2,0,2,0,2,2,0,2,0,2,0,2,0,2,0],
                [0,2,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,2,0],
                [0,2,0,2,2,0,2,0,0,2,2,0,0,2,0,2,2,0,2,0],
                [0,0,0,0,0,0,2,0,2,0,0,2,0,2,0,0,0,0,0,0],
                [0,2,2,0,2,0,2,0,2,0,0,2,0,2,0,2,0,2,2,0],
                [0,0,0,0,2,0,0,0,2,0,0,2,0,0,0,2,0,0,0,0],
                [0,2,0,0,2,2,0,2,2,2,2,2,2,0,2,2,0,0,2,0],
                [0,2,0,2,0,0,0,2,0,0,0,0,2,0,0,0,0,2,2,0],
                [0,2,0,2,0,2,0,2,0,2,2,0,2,0,2,0,2,0,2,0],
                [0,2,0,2,0,2,0,2,0,2,2,0,2,0,2,0,2,0,2,0],
                [0,0,0,0,2,0,0,0,2,0,0,2,0,0,0,2,0,0,0,0],
                [0,2,2,0,2,0,2,2,2,2,2,2,2,2,0,2,0,2,2,0],
                [0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0],
                [0,2,2,0,2,2,0,2,0,0,0,0,2,0,2,2,0,2,2,0],
                [0,0,0,0,0,0,0,2,0,2,2,0,2,0,0,0,0,0,0,0],
                [0,2,0,2,2,0,0,2,0,2,2,0,2,0,0,2,2,0,2,0],
                [0,2,0,0,0,0,2,0,0,0,0,0,0,2,0,0,0,0,2,0],
                [0,2,2,0,2,0,2,2,2,0,0,2,2,2,0,2,0,2,2,0],
                [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
            ],
            // Уровень 8 - Легендарный (экстремальная сложность)
            [
                [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                [0,3,0,2,0,2,0,3,0,2,2,0,3,0,2,0,2,0,3,0],
                [0,0,0,2,0,0,0,0,0,2,2,0,0,0,0,0,2,0,0,0],
                [0,2,0,2,0,2,2,0,0,2,2,0,0,2,2,0,2,0,2,0],
                [0,2,0,0,0,2,0,0,2,0,0,2,0,0,2,0,0,0,2,0],
                [0,2,2,0,0,2,0,2,2,0,0,2,2,0,2,0,0,2,2,0],
                [0,0,0,0,2,0,0,2,0,0,0,0,2,0,0,2,0,0,0,0],
                [0,2,2,0,2,0,0,2,0,2,2,0,2,0,0,2,0,2,2,0],
                [0,2,0,0,2,2,0,0,0,2,2,0,0,0,2,2,0,0,2,0],
                [0,2,0,2,0,0,0,2,0,2,2,0,2,0,0,0,0,2,2,0],
                [0,2,0,2,0,2,0,2,0,0,0,0,2,0,2,0,2,0,2,0],
                [0,0,0,0,0,2,0,0,0,2,2,0,0,0,2,0,0,0,0,0],
                [0,2,2,0,0,2,2,0,2,2,2,2,0,2,2,0,0,2,2,0],
                [0,0,0,0,2,0,0,0,2,0,0,2,0,0,0,2,0,0,0,0],
                [0,2,2,0,2,0,2,0,2,0,0,2,0,2,0,2,0,2,2,0],
                [0,3,0,0,0,0,2,0,0,0,0,0,0,2,0,0,0,0,3,0],
                [0,2,0,2,2,0,2,0,2,2,2,2,0,2,0,2,2,0,2,0],
                [0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0],
                [0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0],
                [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
            ],
            // Уровень 9 - Божественный (почти невозможный)
            [
                [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                [0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0],
                [0,0,0,2,2,2,2,2,2,0,0,2,2,2,2,2,2,0,0,0],
                [0,0,0,2,0,0,0,0,2,0,0,2,0,0,0,0,2,0,0,0],
                [0,0,0,2,0,2,2,0,2,0,0,2,0,2,2,0,2,0,0,0],
                [0,2,2,2,0,2,2,0,2,2,2,2,0,2,2,0,2,2,2,0],
                [0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0