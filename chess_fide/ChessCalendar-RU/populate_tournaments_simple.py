"""
–£–ø—Ä–æ—â–µ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Ç—É—Ä–Ω–∏—Ä–æ–≤ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
"""
import sqlite3
import os
from datetime import date
import json

def populate_tournaments_directly():
    """–ù–∞–ø—Ä—è–º—É—é –¥–æ–±–∞–≤–ª—è–µ–º —Ç—É—Ä–Ω–∏—Ä—ã –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö SQL"""
    db_path = os.path.join(os.path.dirname(__file__), 'instance', 'chess_calendar.db')
    
    if not os.path.exists(db_path):
        print(f"–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –Ω–∞–π–¥–µ–Ω–∞: {db_path}")
        return False
    
    try:
        conn = sqlite3.connect(db_path)
        cursor = conn.cursor()
        
        # –û—á–∏—â–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ
        cursor.execute("DELETE FROM tournament")
        print("‚úÖ –û—á–∏—â–µ–Ω—ã —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ —Ç—É—Ä–Ω–∏—Ä–æ–≤")
        
        # –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ —Ç—É—Ä–Ω–∏—Ä—ã
        tournaments = [
            (
                '–ß–µ–º–ø–∏–æ–Ω–∞—Ç –º–∏—Ä–∞ –ø–æ —à–∞—Ö–º–∞—Ç–∞–º 2026',
                '2026-04-15',
                '2026-05-05',
                '–ú–æ—Å–∫–≤–∞, –†–æ—Å—Å–∏—è',
                'World Championship',
                'Scheduled',
                '–ß–µ–º–ø–∏–æ–Ω–∞—Ç –º–∏—Ä–∞ —Å—Ä–µ–¥–∏ –º—É–∂—á–∏–Ω –ø–æ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–º —à–∞—Ö–º–∞—Ç–∞–º 2026 –≥–æ–¥–∞.',
                '2,000,000 USD',
                'FIDE',
                'WCH2026',
                'https://fide.com',
                2000000,  # prize_fund_usd
                16,       # players_count
                'Classical'  # time_control
            ),
            (
                '–ß–µ–º–ø–∏–æ–Ω–∞—Ç –†–æ—Å—Å–∏–∏ –ø–æ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–º —à–∞—Ö–º–∞—Ç–∞–º 2026',
                '2026-03-10',
                '2026-03-25',
                '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥, –†–æ—Å—Å–∏—è',
                'National Championship',
                'Scheduled',
                '–ï–∂–µ–≥–æ–¥–Ω—ã–π —á–µ–º–ø–∏–æ–Ω–∞—Ç –†–æ—Å—Å–∏–∏ –ø–æ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–º —à–∞—Ö–º–∞—Ç–∞–º.',
                '250,000 USD',
                '–§–µ–¥–µ—Ä–∞—Ü–∏—è —à–∞—Ö–º–∞—Ç –†–æ—Å—Å–∏–∏',
                'RUS2026',
                'https://ruchess.ru',
                250000,   # prize_fund_usd
                128,      # players_count
                'Classical'  # time_control
            ),
            (
                '–ö—É–±–æ–∫ –†–æ—Å—Å–∏–∏ –ø–æ –±—ã—Å—Ç—Ä—ã–º —à–∞—Ö–º–∞—Ç–∞–º 2026',
                '2026-05-20',
                '2026-05-25',
                '–ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥, –†–æ—Å—Å–∏—è',
                'Rapid & Blitz',
                'Scheduled',
                '–¢—É—Ä–Ω–∏—Ä –ø–æ –±—ã—Å—Ç—Ä—ã–º –∏ –±–ª–∏—Ü —à–∞—Ö–º–∞—Ç–∞–º —Å—Ä–µ–¥–∏ —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –≥—Ä–æ—Å—Å–º–µ–π—Å—Ç–µ—Ä–æ–≤.',
                '150,000 USD',
                '–§–µ–¥–µ—Ä–∞—Ü–∏—è —à–∞—Ö–º–∞—Ç –†–æ—Å—Å–∏–∏',
                'RUS-RB-2026',
                'https://ruchess.ru',
                150000,   # prize_fund_usd
                64,       # players_count
                'Rapid & Blitz'  # time_control
            ),
            (
                '–ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–π —Ç—É—Ä–Ω–∏—Ä "–ö—É–±–æ–∫ –°–∏–±–∏—Ä–∏" 2026',
                '2026-06-01',
                '2026-06-10',
                '–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫, –†–æ—Å—Å–∏—è',
                'Open International',
                'Scheduled',
                '–ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–π —Ç—É—Ä–Ω–∏—Ä —Å—Ä–µ–¥–∏ —Å–∏–ª—å–Ω–µ–π—à–∏—Ö —à–∞—Ö–º–∞—Ç–∏—Å—Ç–æ–≤ –°–∏–±–∏—Ä–∏ –∏ —Å–æ—Å–µ–¥–Ω–∏—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤.',
                '100,000 USD',
                '–°–∏–±–∏—Ä—Å–∫–∞—è —à–∞—Ö–º–∞—Ç–Ω–∞—è –∞—Å—Å–æ—Ü–∏–∞—Ü–∏—è',
                'SIBERIA2026',
                'https://chesstour.ru',
                100000,   # prize_fund_usd
                120,      # players_count
                'Classical'  # time_control
            ),
            (
                '–¢—É—Ä–Ω–∏—Ä –ø—Ä–µ—Ç–µ–Ω–¥–µ–Ω—Ç–æ–≤ FIDE 2026',
                '2026-07-05',
                '2026-07-25',
                '–ú–∞–¥—Ä–∏–¥, –ò—Å–ø–∞–Ω–∏—è',
                'FIDE Candidates',
                'Scheduled',
                '–¢—É—Ä–Ω–∏—Ä –ø—Ä–µ—Ç–µ–Ω–¥–µ–Ω—Ç–æ–≤ –Ω–∞ –∑–≤–∞–Ω–∏–µ —á–µ–º–ø–∏–æ–Ω–∞ –º–∏—Ä–∞ –ø–æ —à–∞—Ö–º–∞—Ç–∞–º.',
                '500,000 USD',
                'FIDE',
                'FIDE-CAND-2026',
                'https://fide.com',
                500000,   # prize_fund_usd
                8,        # players_count
                'Classical'  # time_control
            ),
            (
                '–ß–µ–º–ø–∏–æ–Ω–∞—Ç –†–æ—Å—Å–∏–∏ –ø–æ –±–ª–∏—Ü-—à–∞—Ö–º–∞—Ç–∞–º 2026',
                '2026-08-15',
                '2026-08-17',
                '–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥, –†–æ—Å—Å–∏—è',
                'Blitz Championship',
                'Scheduled',
                '–ß–µ–º–ø–∏–æ–Ω–∞—Ç –†–æ—Å—Å–∏–∏ –ø–æ –±–ª–∏—Ü —à–∞—Ö–º–∞—Ç–∞–º.',
                '80,000 USD',
                '–§–µ–¥–µ—Ä–∞—Ü–∏—è —à–∞—Ö–º–∞—Ç –†–æ—Å—Å–∏–∏',
                'RUS-BLITZ-2026',
                'https://ruchess.ru',
                80000,    # prize_fund_usd
                150,      # players_count
                'Blitz'   # time_control
            ),
            (
                '–ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–π –∂–µ–Ω—Å–∫–∏–π —Ç—É—Ä–Ω–∏—Ä "–ö—É–±–æ–∫ –ï–≤—Ä–æ–ø—ã" 2026',
                '2026-09-10',
                '2026-09-20',
                '–ë—É—Ö–∞—Ä–µ—Å—Ç, –†—É–º—ã–Ω–∏—è',
                'Women\'s Open',
                'Scheduled',
                '–ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–π —Ç—É—Ä–Ω–∏—Ä —Å—Ä–µ–¥–∏ –∂–µ–Ω—â–∏–Ω-–≥—Ä–æ—Å—Å–º–µ–π—Å—Ç–µ—Ä–æ–≤ –ï–≤—Ä–æ–ø—ã.',
                '120,000 USD',
                'FIDE Women\'s Commission',
                'WOMEN-EUROPE-2026',
                'https://fide.com',
                120000,   # prize_fund_usd
                96,       # players_count
                'Classical'  # time_control
            ),
            (
                '–Æ–Ω–æ—à–µ—Å–∫–∏–π —á–µ–º–ø–∏–æ–Ω–∞—Ç –†–æ—Å—Å–∏–∏ U16 2026',
                '2026-10-05',
                '2026-10-12',
                '–ö–∞–∑–∞–Ω—å, –†–æ—Å—Å–∏—è',
                'Youth Championship',
                'Scheduled',
                '–ß–µ–º–ø–∏–æ–Ω–∞—Ç –†–æ—Å—Å–∏–∏ —Å—Ä–µ–¥–∏ —é–Ω–æ—à–µ–π –∏ –¥–µ–≤—É—à–µ–∫ –¥–æ 16 –ª–µ—Ç.',
                '30,000 USD',
                '–§–µ–¥–µ—Ä–∞—Ü–∏—è —à–∞—Ö–º–∞—Ç –†–æ—Å—Å–∏–∏',
                'YOUTH-RUS-2026',
                'https://ruchess.ru',
                30000,    # prize_fund_usd
                200,      # players_count
                'Classical'  # time_control
            ),
            (
                '–û—Ç–∫—Ä—ã—Ç—ã–π —Ç—É—Ä–Ω–∏—Ä –ø–∞–º—è—Ç–∏ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–∞ –ê–ª–µ—Ö–∏–Ω–∞ 2026',
                '2026-11-01',
                '2026-11-10',
                '–ü–∞—Ä–∏–∂, –§—Ä–∞–Ω—Ü–∏—è',
                'Historic Memorial',
                'Scheduled',
                '–ï–∂–µ–≥–æ–¥–Ω—ã–π –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–π —Ç—É—Ä–Ω–∏—Ä, –ø–æ—Å–≤—è—â—ë–Ω–Ω—ã–π –ø–∞–º—è—Ç–∏ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–∞ –ê–ª–µ—Ö–∏–Ω–∞.',
                '300,000 USD',
                '–§—Ä–∞–Ω—Ü—É–∑—Å–∫–∞—è —à–∞—Ö–º–∞—Ç–Ω–∞—è —Ñ–µ–¥–µ—Ä–∞—Ü–∏—è',
                'ALEKHINE-2026',
                'https://chesspro.ru',
                300000,   # prize_fund_usd
                128,      # players_count
                'Classical'  # time_control
            ),
            (
                '–¢—É—Ä–Ω–∏—Ä –≤–µ—Ç–µ—Ä–∞–Ω–æ–≤ –°–ù–ì 2026',
                '2026-12-15',
                '2026-12-22',
                '–¢–±–∏–ª–∏—Å–∏, –ì—Ä—É–∑–∏—è',
                'Senior Championship',
                'Scheduled',
                '–ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–π —Ç—É—Ä–Ω–∏—Ä —Å—Ä–µ–¥–∏ —à–∞—Ö–º–∞—Ç–∏—Å—Ç–æ–≤ —Å—Ç–∞—Ä—à–µ 60 –ª–µ—Ç –∏–∑ —Å—Ç—Ä–∞–Ω –°–ù–ì.',
                '40,000 USD',
                '–®–∞—Ö–º–∞—Ç–Ω–∞—è –∞—Å—Å–æ—Ü–∏–∞—Ü–∏—è –°–ù–ì',
                'SENIOR-CIS-2026',
                'https://chesstour.ge',
                40000,    # prize_fund_usd
                80,       # players_count
                'Classical'  # time_control
            )
        ]
        
        # –í—Å—Ç–∞–≤–ª—è–µ–º —Ç—É—Ä–Ω–∏—Ä—ã –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
        insert_query = """
        INSERT INTO tournament 
        (name, start_date, end_date, location, category, status, description, 
         prize_fund, organizer, fide_id, source_url, prize_fund_usd, players_count, time_control)
        VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
        """
        
        cursor.executemany(insert_query, tournaments)
        conn.commit()
        
        print(f"‚úÖ –£—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ {len(tournaments)} —Ç—É—Ä–Ω–∏—Ä–æ–≤ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö")
        
        # –ü—Ä–æ–≤–µ—Ä–∏–º, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –±—ã–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã
        cursor.execute("SELECT COUNT(*) FROM tournament")
        count = cursor.fetchone()[0]
        print(f"üìä –í—Å–µ–≥–æ —Ç—É—Ä–Ω–∏—Ä–æ–≤ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö: {count}")
        
        conn.close()
        return True
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö: {e}")
        return False

if __name__ == "__main__":
    populate_tournaments_directly()