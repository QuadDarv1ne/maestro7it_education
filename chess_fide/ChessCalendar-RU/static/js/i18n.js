/**
 * Internationalization (i18n) JavaScript module for ChessCalendar-RU
 * Handles client-side translations and language switching
 */

class I18nManager {
    constructor() {
        this.translations = {
            'en': {
                'welcome': 'Welcome to Chess Calendar',
                'tournaments': 'Tournaments',
                'calendar': 'Calendar',
                'favorites': 'Favorites',
                'search': 'Search',
                'settings': 'Settings',
                'login': 'Login',
                'logout': 'Logout',
                'register': 'Register',
                'new_tournament': 'New Tournament',
                'upcoming_tournaments': 'Upcoming Tournaments',
                'recent_tournaments': 'Recent Tournaments',
                'tournament_details': 'Tournament Details',
                'name': 'Name',
                'location': 'Location',
                'dates': 'Dates',
                'category': 'Category',
                'status': 'Status',
                'description': 'Description',
                'prize_fund': 'Prize Fund',
                'organizer': 'Organizer',
                'website': 'Website',
                'registration_deadline': 'Registration Deadline',
                'participants': 'Participants',
                'rating': 'Rating',
                'reviews': 'Reviews',
                'add_to_favorites': 'Add to Favorites',
                'remove_from_favorites': 'Remove from Favorites',
                'export_calendar': 'Export to Calendar',
                'notifications': 'Notifications',
                'my_profile': 'My Profile',
                'about': 'About',
                'contact': 'Contact',
                'help': 'Help',
                'privacy_policy': 'Privacy Policy',
                'terms_of_service': 'Terms of Service',
                'language': 'Language',
                'theme': 'Theme',
                'dark_mode': 'Dark Mode',
                'light_mode': 'Light Mode',
                'auto_mode': 'Auto',
                'filters': 'Filters',
                'sort_by': 'Sort By',
                'date_added': 'Date Added',
                'popularity': 'Popularity',
                'apply_filters': 'Apply Filters',
                'reset_filters': 'Reset Filters',
                'no_results_found': 'No results found',
                'try_different_search': 'Try a different search term',
                'load_more': 'Load More',
                'loading': 'Loading...',
                'save_changes': 'Save Changes',
                'cancel': 'Cancel',
                'delete': 'Delete',
                'edit': 'Edit',
                'view': 'View',
                'share': 'Share',
                'copy_link': 'Copy Link',
                'share_facebook': 'Share on Facebook',
                'share_twitter': 'Share on Twitter',
                'share_linkedin': 'Share on LinkedIn',
                'error_occurred': 'An error occurred',
                'please_try_again': 'Please try again',
                'success': 'Success',
                'saved_successfully': 'Saved successfully',
                'changes_saved': 'Changes saved successfully',
                'search_placeholder': 'Search tournaments...',
                'select_language': 'Select Language',
                'all_categories': 'All Categories',
                'all_locations': 'All Locations',
                'all_statuses': 'All Statuses',
                'scheduled': 'Scheduled',
                'ongoing': 'Ongoing',
                'completed': 'Completed',
                'cancelled': 'Cancelled',
                'fide_events': 'FIDE Events',
                'national_championships': 'National Championships',
                'online_tournaments': 'Online Tournaments',
                'rapid_blitz': 'Rapid & Blitz',
                'women_events': 'Women Events',
                'youth_events': 'Youth Events',
                'senior_events': 'Senior Events',
                'today': 'Today',
                'this_week': 'This Week',
                'this_month': 'This Month',
                'next_month': 'Next Month',
                'custom_range': 'Custom Range',
                'export_formats': 'Export Formats',
                'ics_format': 'ICS (Calendar)',
                'csv_format': 'CSV (Spreadsheet)',
                'pdf_format': 'PDF (Document)',
                'subscribe': 'Subscribe',
                'unsubscribe': 'Unsubscribe',
                'email_notifications': 'Email Notifications',
                'push_notifications': 'Push Notifications',
                'sms_notifications': 'SMS Notifications',
                'unsubscribe_confirmation': 'Are you sure you want to unsubscribe?',
                'yes': 'Yes',
                'no': 'No',
                'confirm': 'Confirm',
                'close': 'Close',
                'previous': 'Previous',
                'next': 'Next',
                'page': 'Page',
                'of': 'of',
                'results_per_page': 'Results per page',
                'showing_results': 'Showing {start} to {end} of {total} results',
                'refresh': 'Refresh',
                'sync': 'Sync',
                'offline_mode': 'Offline Mode',
                'online': 'Online',
                'offline': 'Offline',
                'connection_lost': 'Connection Lost',
                'reconnecting': 'Reconnecting...',
                'connected': 'Connected',
                'last_updated': 'Last Updated',
                'never': 'Never',
                'minutes_ago': '{minutes} minutes ago',
                'hours_ago': '{hours} hours ago',
                'days_ago': '{days} days ago',
                'weeks_ago': '{weeks} weeks ago',
                'months_ago': '{months} months ago',
                'years_ago': '{years} years ago',
                'now': 'Just now',
                'yesterday': 'Yesterday',
                'tomorrow': 'Tomorrow',
                'monday': 'Monday',
                'tuesday': 'Tuesday',
                'wednesday': 'Wednesday',
                'thursday': 'Thursday',
                'friday': 'Friday',
                'saturday': 'Saturday',
                'sunday': 'Sunday',
                'january': 'January',
                'february': 'February',
                'march': 'March',
                'april': 'April',
                'may': 'May',
                'june': 'June',
                'july': 'July',
                'august': 'August',
                'september': 'September',
                'october': 'October',
                'november': 'November',
                'december': 'December',
                'jan': 'Jan',
                'feb': 'Feb',
                'mar': 'Mar',
                'apr': 'Apr',
                'may_short': 'May',
                'jun': 'Jun',
                'jul': 'Jul',
                'aug': 'Aug',
                'sep': 'Sep',
                'oct': 'Oct',
                'nov': 'Nov',
                'dec': 'Dec',
                'mon': 'Mon',
                'tue': 'Tue',
                'wed': 'Wed',
                'thu': 'Thu',
                'fri': 'Fri',
                'sat': 'Sat',
                'sun': 'Sun',
                'am': 'AM',
                'pm': 'PM',
                'start_date': 'Start Date',
                'end_date': 'End Date',
                'registration_open': 'Registration Open',
                'registration_closed': 'Registration Closed',
                'registration_not_started': 'Registration Not Started',
                'spots_remaining': '{count} spots remaining',
                'full': 'Full',
                'free': 'Free',
                'paid': 'Paid',
                'fee': 'Fee',
                'currency': 'Currency',
                'usd': 'USD',
                'eur': 'EUR',
                'rub': 'RUB',
                'gbp': 'GBP',
                'jpy': 'JPY',
                'cny': 'CNY',
                'inr': 'INR',
                'bgn': 'BGN',
                'czk': 'CZK',
                'dkk': 'DKK',
                'hrk': 'HRK',
                'huf': 'HUF',
                'pln': 'PLN',
                'ron': 'RON',
                'sek': 'SEK',
                'chf': 'CHF',
                'isk': 'ISK',
                'nok': 'NOK',
                'try': 'TRY',
                'nzd': 'NZD',
                'aud': 'AUD',
                'cad': 'CAD',
                'mxn': 'MXN',
                'ars': 'ARS',
                'clp': 'CLP',
                'cop': 'COP',
                'vef': 'VEF',
                'brl': 'BRL',
                'zar': 'ZAR',
                'egp': 'EGP',
                'mad': 'MAD',
                'kwd': 'KWD',
                'sar': 'SAR',
                'aed': 'AED',
                'ils': 'ILS',
                'sgd': 'SGD',
                'thb': 'THB',
                'myr': 'MYR',
                'idr': 'IDR',
                'php': 'PHP',
                'krw': 'KRW',
                'jod': 'JOD',
                'lbp': 'LBP',
                'iqd': 'IQD',
                'omr': 'OMR',
                'qar': 'QAR',
                'bhd': 'BHD',
                'all': 'ALL',
                'afn': 'AFN',
                'amd': 'AMD',
                'azn': 'AZN',
                'byn': 'BYN',
                'bzd': 'BZD',
                'bob': 'BOB',
                'bam': 'BAM',
                'bwp': 'BWP',
                'bnd': 'BND',
                'bif': 'BIF',
                'khr': 'KHR',
                'cvd': 'CVD',
                'kyd': 'KYD',
                'clp': 'CLP',
                'cny': 'CNY',
                'cop': 'COP',
                'kmf': 'KMF',
                'crc': 'CRC',
                'cup': 'CUP',
                'ang': 'ANG',
                'djf': 'DJF',
                'std': 'STD',
                'dzd': 'DZD',
                'etb': 'ETB',
                'fkp': 'FKP',
                'fjd': 'FJD',
                'gmd': 'GMD',
                'gel': 'GEL',
                'ghs': 'GHS',
                'gip': 'GIP',
                'gtq': 'GTQ',
                'gnf': 'GNF',
                'gyd': 'GYD',
                'htg': 'HTG',
                'hnl': 'HNL',
                'hkd': 'HKD',
                'huf': 'HUF',
                'isk': 'ISK',
                'inr': 'INR',
                'idr': 'IDR',
                'irr': 'IRR',
                'iqd': 'IQD',
                'imp': 'IMP',
                'jmd': 'JMD',
                'jpy': 'JPY',
                'jep': 'JEP',
                'kes': 'KES',
                'kzt': 'KZT',
                'kpw': 'KPW',
                'krw': 'KRW',
                'kgs': 'KGS',
                'lak': 'LAK',
                'lbp': 'LBP',
                'lsl': 'LSL',
                'lyd': 'LYD',
                'lrd': 'LRD',
                'mga': 'MGA',
                'mkd': 'MKD',
                'mwk': 'MWK',
                'mdl': 'MDL',
                'mnt': 'MNT',
                'mad': 'MAD',
                'mzn': 'MZN',
                'mmk': 'MMK',
                'nad': 'NAD',
                'npr': 'NPR',
                'nio': 'NIO',
                'ngn': 'NGN',
                'nzd': 'NZD',
                'omr': 'OMR',
                'pkr': 'PKR',
                'pab': 'PAB',
                'pgk': 'PGK',
                'pyg': 'PYG',
                'pen': 'PEN',
                'php': 'PHP',
                'pln': 'PLN',
                'qar': 'QAR',
                'ron': 'RON',
                'rub': 'RUB',
                'rwf': 'RWF',
                'svc': 'SVC',
                'wst': 'WST',
                'std': 'STD',
                'sar': 'SAR',
                'rsd': 'RSD',
                'scr': 'SCR',
                'sll': 'SLL',
                'sgd': 'SGD',
                'sbd': 'SBD',
                'sos': 'SOS',
                'zar': 'ZAR',
                'lkr': 'LKR',
                'sdg': 'SDG',
                'srd': 'SRD',
                'szl': 'SZL',
                'sek': 'SEK',
                'chf': 'CHF',
                'tjs': 'TJS',
                'tzs': 'TZS',
                'thb': 'THB',
                'top': 'TOP',
                'ttd': 'TTD',
                'tnd': 'TND',
                'try': 'TRY',
                'tmt': 'TMT',
                'ugx': 'UGX',
                'uah': 'UAH',
                'aed': 'AED',
                'uyu': 'UYU',
                'uzs': 'UZS',
                'vuv': 'VUV',
                'vef': 'VEF',
                'vnd': 'VND',
                'yer': 'YER',
                'zmw': 'ZMW',
                'zwl': 'ZWL',
                'more_info': 'More Info',
                'less_info': 'Less Info',
                'expand': 'Expand',
                'collapse': 'Collapse',
                'print': 'Print',
                'download': 'Download',
                'upload': 'Upload',
                'select_file': 'Select File',
                'choose_file': 'Choose File',
                'no_file_selected': 'No file selected',
                'file_size_limit': 'File size limit: {size}',
                'file_type_error': 'Invalid file type',
                'upload_success': 'Upload successful',
                'upload_failed': 'Upload failed',
                'retry': 'Retry',
                'skip': 'Skip',
                'continue': 'Continue',
                'finish': 'Finish',
                'complete': 'Complete',
                'in_progress': 'In Progress',
                'pending': 'Pending',
                'failed': 'Failed',
                'skipped': 'Skipped',
                'timeout': 'Timeout',
                'network_error': 'Network Error',
                'server_error': 'Server Error',
                'client_error': 'Client Error',
                'forbidden': 'Forbidden',
                'not_found': 'Not Found',
                'internal_error': 'Internal Server Error',
                'bad_request': 'Bad Request',
                'unauthorized': 'Unauthorized',
                'payment_required': 'Payment Required',
                'too_many_requests': 'Too Many Requests',
                'service_unavailable': 'Service Unavailable',
                'gateway_timeout': 'Gateway Timeout',
                'proxy_auth_required': 'Proxy Authentication Required',
                'request_timeout': 'Request Timeout',
                'conflict': 'Conflict',
                'gone': 'Gone',
                'length_required': 'Length Required',
                'precondition_failed': 'Precondition Failed',
                'payload_too_large': 'Payload Too Large',
                'uri_too_long': 'URI Too Long',
                'unsupported_media_type': 'Unsupported Media Type',
                'range_not_satisfiable': 'Range Not Satisfiable',
                'expectation_failed': 'Expectation Failed',
                'misdirected_request': 'Misdirected Request',
                'unprocessable_entity': 'Unprocessable Entity',
                'locked': 'Locked',
                'failed_dependency': 'Failed Dependency',
                'upgrade_required': 'Upgrade Required',
                'precondition_required': 'Precondition Required',
                'too_many_requests': 'Too Many Requests',
                'request_header_fields_too_large': 'Request Header Fields Too Large',
                'unavailable_for_legal_reasons': 'Unavailable For Legal Reasons',
                'variant_also_negotiates': 'Variant Also Negotiates',
                'insufficient_storage': 'Insufficient Storage',
                'loop_detected': 'Loop Detected',
                'not_extended': 'Not Extended',
                'network_authentication_required': 'Network Authentication Required'
            },
            'ru': {
                'welcome': 'Добро пожаловать в Шахматный Календарь',
                'tournaments': 'Турниры',
                'calendar': 'Календарь',
                'favorites': 'Избранное',
                'search': 'Поиск',
                'settings': 'Настройки',
                'login': 'Вход',
                'logout': 'Выход',
                'register': 'Регистрация',
                'new_tournament': 'Новый турнир',
                'upcoming_tournaments': 'Предстоящие турниры',
                'recent_tournaments': 'Недавние турниры',
                'tournament_details': 'Детали турнира',
                'name': 'Название',
                'location': 'Место проведения',
                'dates': 'Даты',
                'category': 'Категория',
                'status': 'Статус',
                'description': 'Описание',
                'prize_fund': 'Призовой фонд',
                'organizer': 'Организатор',
                'website': 'Веб-сайт',
                'registration_deadline': 'Крайний срок регистрации',
                'participants': 'Участники',
                'rating': 'Рейтинг',
                'reviews': 'Отзывы',
                'add_to_favorites': 'Добавить в избранное',
                'remove_from_favorites': 'Удалить из избранного',
                'export_calendar': 'Экспорт в календарь',
                'notifications': 'Уведомления',
                'my_profile': 'Мой профиль',
                'about': 'О нас',
                'contact': 'Контакты',
                'help': 'Помощь',
                'privacy_policy': 'Политика конфиденциальности',
                'terms_of_service': 'Условия использования',
                'language': 'Язык',
                'theme': 'Тема',
                'dark_mode': 'Темный режим',
                'light_mode': 'Светлый режим',
                'auto_mode': 'Авто',
                'filters': 'Фильтры',
                'sort_by': 'Сортировать по',
                'date_added': 'Дата добавления',
                'popularity': 'Популярность',
                'apply_filters': 'Применить фильтры',
                'reset_filters': 'Сбросить фильтры',
                'no_results_found': 'Результаты не найдены',
                'try_different_search': 'Попробуйте другой поисковый запрос',
                'load_more': 'Загрузить еще',
                'loading': 'Загрузка...',
                'save_changes': 'Сохранить изменения',
                'cancel': 'Отмена',
                'delete': 'Удалить',
                'edit': 'Редактировать',
                'view': 'Просмотр',
                'share': 'Поделиться',
                'copy_link': 'Копировать ссылку',
                'share_facebook': 'Поделиться в Facebook',
                'share_twitter': 'Поделиться в Twitter',
                'share_linkedin': 'Поделиться в LinkedIn',
                'error_occurred': 'Произошла ошибка',
                'please_try_again': 'Пожалуйста, попробуйте снова',
                'success': 'Успешно',
                'saved_successfully': 'Успешно сохранено',
                'changes_saved': 'Изменения успешно сохранены',
                'search_placeholder': 'Поиск турниров...',
                'select_language': 'Выберите язык',
                'all_categories': 'Все категории',
                'all_locations': 'Все места',
                'all_statuses': 'Все статусы',
                'scheduled': 'Запланирован',
                'ongoing': 'В процессе',
                'completed': 'Завершен',
                'cancelled': 'Отменен',
                'fide_events': 'События ФИДЕ',
                'national_championships': 'Национальные чемпионаты',
                'online_tournaments': 'Онлайн-турниры',
                'rapid_blitz': 'Рапид и блиц',
                'women_events': 'Женские события',
                'youth_events': 'Молодежные события',
                'senior_events': 'События для ветеранов',
                'today': 'Сегодня',
                'this_week': 'На этой неделе',
                'this_month': 'В этом месяце',
                'next_month': 'В следующем месяце',
                'custom_range': 'Произвольный диапазон',
                'export_formats': 'Форматы экспорта',
                'ics_format': 'ICS (Календарь)',
                'csv_format': 'CSV (Таблица)',
                'pdf_format': 'PDF (Документ)',
                'subscribe': 'Подписаться',
                'unsubscribe': 'Отписаться',
                'email_notifications': 'E-mail уведомления',
                'push_notifications': 'Push-уведомления',
                'sms_notifications': 'SMS-уведомления',
                'unsubscribe_confirmation': 'Вы уверены, что хотите отписаться?',
                'yes': 'Да',
                'no': 'Нет',
                'confirm': 'Подтвердить',
                'close': 'Закрыть',
                'previous': 'Предыдущий',
                'next': 'Следующий',
                'page': 'Страница',
                'of': 'из',
                'results_per_page': 'Результатов на странице',
                'showing_results': 'Показаны с {start} по {end} из {total} результатов',
                'refresh': 'Обновить',
                'sync': 'Синхронизировать',
                'offline_mode': 'Автономный режим',
                'online': 'В сети',
                'offline': 'Не в сети',
                'connection_lost': 'Соединение потеряно',
                'reconnecting': 'Переподключение...',
                'connected': 'Подключено',
                'last_updated': 'Последнее обновление',
                'never': 'Никогда',
                'minutes_ago': '{minutes} минут назад',
                'hours_ago': '{hours} часов назад',
                'days_ago': '{days} дней назад',
                'weeks_ago': '{weeks} недель назад',
                'months_ago': '{months} месяцев назад',
                'years_ago': '{years} лет назад',
                'now': 'Только что',
                'yesterday': 'Вчера',
                'tomorrow': 'Завтра',
                'monday': 'Понедельник',
                'tuesday': 'Вторник',
                'wednesday': 'Среда',
                'thursday': 'Четверг',
                'friday': 'Пятница',
                'saturday': 'Суббота',
                'sunday': 'Воскресенье',
                'january': 'Январь',
                'february': 'Февраль',
                'march': 'Март',
                'april': 'Апрель',
                'may': 'Май',
                'june': 'Июнь',
                'july': 'Июль',
                'august': 'Август',
                'september': 'Сентябрь',
                'october': 'Октябрь',
                'november': 'Ноябрь',
                'december': 'Декабрь',
                'jan': 'Янв',
                'feb': 'Фев',
                'mar': 'Мар',
                'apr': 'Апр',
                'may_short': 'Май',
                'jun': 'Июн',
                'jul': 'Июл',
                'aug': 'Авг',
                'sep': 'Сен',
                'oct': 'Окт',
                'nov': 'Ноя',
                'dec': 'Дек',
                'mon': 'Пн',
                'tue': 'Вт',
                'wed': 'Ср',
                'thu': 'Чт',
                'fri': 'Пт',
                'sat': 'Сб',
                'sun': 'Вс',
                'am': 'ДП',
                'pm': 'ПП',
                'start_date': 'Дата начала',
                'end_date': 'Дата окончания',
                'registration_open': 'Регистрация открыта',
                'registration_closed': 'Регистрация закрыта',
                'registration_not_started': 'Регистрация не началась',
                'spots_remaining': 'Осталось мест: {count}',
                'full': 'Полный',
                'free': 'Бесплатный',
                'paid': 'Платный',
                'fee': 'Плата',
                'currency': 'Валюта',
                'usd': 'Доллар США',
                'eur': 'Евро',
                'rub': 'Рубль',
                'gbp': 'Фунт стерлингов',
                'jpy': 'Йена',
                'cny': 'Юань',
                'inr': 'Рупия',
                'bgn': 'Лев',
                'czk': 'Крона',
                'dkk': 'Крона',
                'hrk': 'Куна',
                'huf': 'Форинт',
                'pln': 'Злотый',
                'ron': 'Лей',
                'sek': 'Крона',
                'chf': 'Франк',
                'isk': 'Крона',
                'nok': 'Крона',
                'try': 'Лира',
                'nzd': 'Доллар',
                'aud': 'Доллар',
                'cad': 'Доллар',
                'mxn': 'Песо',
                'ars': 'Песо',
                'clp': 'Песо',
                'cop': 'Песо',
                'vef': 'Боливар',
                'brl': 'Реал',
                'zar': 'Рэнд',
                'egp': 'Фунт',
                'mad': 'Дирхам',
                'kwd': 'Динар',
                'sar': 'Риял',
                'aed': 'Дирхам',
                'ils': 'Шекель',
                'sgd': 'Доллар',
                'thb': 'Бат',
                'myr': 'Ринггит',
                'idr': 'Рупия',
                'php': 'Песо',
                'krw': 'Вона',
                'jod': 'Динар',
                'lbp': 'Фунт',
                'iqd': 'Динар',
                'omr': 'Риал',
                'qar': 'Риал',
                'bhd': 'Динар',
                'all': 'Лек',
                'afn': 'Афгани',
                'amd': 'Драм',
                'azn': 'Манат',
                'byn': 'Рубль',
                'bzd': 'Доллар',
                'bob': 'Боливиано',
                'bam': 'Конвертируемая марка',
                'bwp': 'Пула',
                'bnd': 'Доллар',
                'bif': 'Франк',
                'khr': 'Риель',
                'cvd': 'Эскудо',
                'kyd': 'Доллар',
                'clp': 'Песо',
                'cny': 'Юань',
                'cop': 'Песо',
                'kmf': 'Франк',
                'crc': 'Колон',
                'cup': 'Песо',
                'ang': 'Гульден',
                'djf': 'Франк',
                'std': 'Добра',
                'dzd': 'Динар',
                'etb': 'Бирр',
                'fkp': 'Фунт',
                'fjd': 'Доллар',
                'gmd': 'Даласи',
                'gel': 'Лари',
                'ghs': 'Седи',
                'gip': 'Фунт',
                'gtq': 'Кетсаль',
                'gnf': 'Франк',
                'gyd': 'Доллар',
                'htg': 'Гурд',
                'hnl': 'Лемпира',
                'hkd': 'Доллар',
                'huf': 'Форинт',
                'isk': 'Крона',
                'inr': 'Рупия',
                'idr': 'Рупия',
                'irr': 'Риал',
                'iqd': 'Динар',
                'imp': 'IMP',
                'jmd': 'Доллар',
                'jpy': 'Йена',
                'jep': 'Фунт',
                'kes': 'Шиллинг',
                'kzt': 'Тенге',
                'kpw': 'Вона',
                'krw': 'Вона',
                'kgs': 'Сом',
                'lak': 'Кип',
                'lbp': 'Фунт',
                'lsl': 'Лоти',
                'lyd': 'Динар',
                'lrd': 'Доллар',
                'mga': 'Ариари',
                'mkd': 'Денар',
                'mwk': 'Квача',
                'mdl': 'Лей',
                'mnt': 'Тугрик',
                'mad': 'Дирхам',
                'mzn': 'Метикал',
                'mmk': 'Кьят',
                'nad': 'Доллар',
                'npr': 'Рупия',
                'nio': 'Кордоба',
                'ngn': 'Найра',
                'nzd': 'Доллар',
                'omr': 'Риал',
                'pkr': 'Рупия',
                'pab': 'Бальбоа',
                'pgk': 'Кина',
                'pyg': 'Гуарани',
                'pen': 'Соль',
                'php': 'Песо',
                'pln': 'Злотый',
                'qar': 'Риал',
                'ron': 'Лей',
                'rub': 'Рубль',
                'rwf': 'Франк',
                'svc': 'Колон',
                'wst': 'Тала',
                'std': 'Добра',
                'sar': 'Риял',
                'rsd': 'Динар',
                'scr': 'Рупия',
                'sll': 'Леоне',
                'sgd': 'Доллар',
                'sbd': 'Доллар',
                'sos': 'Шиллинг',
                'zar': 'Рэнд',
                'lkr': 'Рупия',
                'sdg': 'Фунт',
                'srd': 'Доллар',
                'szl': 'Лилангени',
                'sek': 'Крона',
                'chf': 'Франк',
                'tjs': 'Сомони',
                'tzs': 'Шиллинг',
                'thb': 'Бат',
                'top': 'Паанга',
                'ttd': 'Доллар',
                'tnd': 'Динар',
                'try': 'Лира',
                'tmt': 'Манат',
                'ugx': 'Шиллинг',
                'uah': 'Гривна',
                'aed': 'Дирхам',
                'uyu': 'Песо',
                'uzs': 'Сум',
                'vuv': 'Вату',
                'vef': 'Боливар',
                'vnd': 'Донг',
                'yer': 'Риал',
                'zmw': 'Квача',
                'zwl': 'Доллар',
                'more_info': 'Подробнее',
                'less_info': 'Свернуть',
                'expand': 'Развернуть',
                'collapse': 'Свернуть',
                'print': 'Печать',
                'download': 'Скачать',
                'upload': 'Загрузить',
                'select_file': 'Выбрать файл',
                'choose_file': 'Выберите файл',
                'no_file_selected': 'Файл не выбран',
                'file_size_limit': 'Ограничение размера файла: {size}',
                'file_type_error': 'Недопустимый тип файла',
                'upload_success': 'Загрузка успешна',
                'upload_failed': 'Загрузка не удалась',
                'retry': 'Повторить',
                'skip': 'Пропустить',
                'continue': 'Продолжить',
                'finish': 'Завершить',
                'complete': 'Завершено',
                'in_progress': 'В процессе',
                'pending': 'В ожидании',
                'failed': 'Неудачно',
                'skipped': 'Пропущено',
                'timeout': 'Таймаут',
                'network_error': 'Ошибка сети',
                'server_error': 'Ошибка сервера',
                'client_error': 'Ошибка клиента',
                'forbidden': 'Доступ запрещен',
                'not_found': 'Не найдено',
                'internal_error': 'Внутренняя ошибка сервера',
                'bad_request': 'Неверный запрос',
                'unauthorized': 'Не авторизован',
                'payment_required': 'Требуется оплата',
                'too_many_requests': 'Слишком много запросов',
                'service_unavailable': 'Сервис недоступен',
                'gateway_timeout': 'Таймаут шлюза',
                'proxy_auth_required': 'Требуется аутентификация прокси',
                'request_timeout': 'Таймаут запроса',
                'conflict': 'Конфликт',
                'gone': 'Удалено',
                'length_required': 'Требуется длина',
                'precondition_failed': 'Условие ложно',
                'payload_too_large': 'Слишком большой объем данных',
                'uri_too_long': 'Слишком длинный URI',
                'unsupported_media_type': 'Неподдерживаемый тип данных',
                'range_not_satisfiable': 'Диапазон не достижим',
                'expectation_failed': 'Ожидание не оправдалось',
                'misdirected_request': 'Неправильно направленный запрос',
                'unprocessable_entity': 'Объект не обрабатывается',
                'locked': 'Заблокировано',
                'failed_dependency': 'Ошибка зависимости',
                'upgrade_required': 'Требуется обновление',
                'precondition_required': 'Требуется предусловие',
                'too_many_requests': 'Слишком много запросов',
                'request_header_fields_too_large': 'Слишком большие поля заголовка запроса',
                'unavailable_for_legal_reasons': 'Недоступно по юридическим причинам',
                'variant_also_negotiates': 'Вариант также ведет переговоры',
                'insufficient_storage': 'Недостаточно места',
                'loop_detected': 'Обнаружен цикл',
                'not_extended': 'Не расширено',
                'network_authentication_required': 'Требуется сетевая аутентификация'
            }
        };
        
        this.currentLanguage = this.detectLanguage();
        this.initializeLanguageSelector();
        this.translatePage();
    }
    
    /**
     * Detect user's preferred language from browser settings
     */
    detectLanguage() {
        const storedLang = localStorage.getItem('preferred_language');
        if (storedLang && this.translations[storedLang]) {
            return storedLang;
        }
        
        const browserLang = navigator.language.split('-')[0];
        if (this.translations[browserLang]) {
            return browserLang;
        }
        
        // Default to English
        return 'en';
    }
    
    /**
     * Get translation for a key
     */
    t(key, params = {}) {
        const langTranslations = this.translations[this.currentLanguage] || this.translations['en'];
        let translation = langTranslations[key] || key;
        
        // Replace placeholders with parameters
        Object.keys(params).forEach(param => {
            translation = translation.replace(new RegExp(`{${param}}`, 'g'), params[param]);
        });
        
        return translation;
    }
    
    /**
     * Change the current language
     */
    setLanguage(lang) {
        if (this.translations[lang]) {
            this.currentLanguage = lang;
            localStorage.setItem('preferred_language', lang);
            this.translatePage();
            
            // Emit event for other parts of the app to react
            window.dispatchEvent(new CustomEvent('languageChanged', { detail: { lang } }));
            
            return true;
        }
        return false;
    }
    
    /**
     * Translate the entire page
     */
    translatePage() {
        // Translate elements with data-i18n attribute
        const elements = document.querySelectorAll('[data-i18n]');
        elements.forEach(element => {
            const key = element.getAttribute('data-i18n');
            const params = this.getElementParams(element);
            const translation = this.t(key, params);
            
            if (element.tagName.toLowerCase() === 'input' || element.tagName.toLowerCase() === 'textarea') {
                element.placeholder = translation;
            } else {
                element.textContent = translation;
            }
        });
        
        // Update html lang attribute
        document.documentElement.lang = this.currentLanguage;
        
        // Update any language-specific classes
        document.body.classList.remove('lang-en', 'lang-ru');
        document.body.classList.add(`lang-${this.currentLanguage}`);
    }
    
    /**
     * Extract parameters from element attributes
     */
    getElementParams(element) {
        const params = {};
        const paramAttrs = element.getAttributeNames().filter(attr => attr.startsWith('data-i18n-'));
        
        paramAttrs.forEach(attr => {
            const paramName = attr.substring(10); // Remove 'data-i18n-' prefix
            params[paramName] = element.getAttribute(attr);
        });
        
        return params;
    }
    
    /**
     * Initialize language selector dropdown
     */
    initializeLanguageSelector() {
        const selector = document.querySelector('#language-selector');
        if (selector) {
            // Populate the selector with available languages
            Object.keys(this.translations).forEach(langCode => {
                const option = document.createElement('option');
                option.value = langCode;
                option.textContent = this.getLanguageDisplayName(langCode);
                option.selected = langCode === this.currentLanguage;
                selector.appendChild(option);
            });
            
            // Add event listener to change language
            selector.addEventListener('change', (e) => {
                this.setLanguage(e.target.value);
            });
        }
        
        // Also handle buttons or links with language switcher class
        const languageButtons = document.querySelectorAll('.language-switcher');
        languageButtons.forEach(btn => {
            btn.addEventListener('click', (e) => {
                e.preventDefault();
                const lang = btn.getAttribute('data-lang');
                if (lang) {
                    this.setLanguage(lang);
                }
            });
        });
    }
    
    /**
     * Get display name for a language code
     */
    getLanguageDisplayName(code) {
        const names = {
            'en': 'English',
            'ru': 'Русский',
            'es': 'Español',
            'de': 'Deutsch',
            'fr': 'Français',
            'zh': '中文'
        };
        
        return names[code] || code.toUpperCase();
    }
    
    /**
     * Get current language
     */
    getCurrentLanguage() {
        return this.currentLanguage;
    }
    
    /**
     * Get available languages
     */
    getAvailableLanguages() {
        return Object.keys(this.translations);
    }
}

// Initialize the i18n manager when DOM is ready
document.addEventListener('DOMContentLoaded', function() {
    window.i18n = new I18nManager();
});

// Export for use in other modules if using modules
if (typeof module !== 'undefined' && module.exports) {
    module.exports = I18nManager;
}